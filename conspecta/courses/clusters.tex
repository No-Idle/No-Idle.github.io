\documentclass[a4paper]{article}

\usepackage{../mathstemplate}

\date{Весенний семестр 2026 г.}
\title{Кластерные алгебры и кластерные категории.\\ Неофициальный конспект}
\author{Лектор: Михаил Александрович Антипов\\ Конспектировал Леонид Данилевич}

\begin{document}
    \shorthandoff{"}
    \maketitle
    \tableofcontents
    \newpage
    \setcounter{lection}{0}
    \newlection{11 февраля 2026 г.}
    \section{Примеры}
    \setcounter{subsection}{-1}
    \subsection{Пентагональная рекуррента}
    Рассмотрим рекурренту $(x_n)_{n \in \N}$ с начальными данными $x_1 = x$, $x_2 = y$, заданную соотношениями $x_{i-1}x_{i+1} = x_i + 1$ (где сами $x_i \in K(x, y)$ для некоторого поля $K$).

    Посчитаем первые несколько членов:
    \begin{align*}x_1 &= x \\ x_2 &= y \\ x_3 &= \frac{y + 1}{x} \\ x_4 &= \frac{x + y + 1}{xy} \\ x_5 &= \frac{x + 1}{y} \\ x_6 &= x \\ x_7 &= y \\ \vdots\end{align*}
    Рекуррента зациклилась за $5$ шагов.

    Можно пытаться рассматривать вариации этого рекуррентного соотношения.
    Например, пусть $x_{i-1}x_{i+1} = \all{x_i^a + 1,&i \text{ чётно} \\ x_i + 1,& i\text{ нечётно}}$, где $a \in \N$.
    Оказывается, такая рекуррента будет периодической только в случаях $a = 1, 2, 3$, и это соответствует тому, что в ранге $2$ есть три системы корней --- $\mathsf{A}_2$, $\mathsf{B}_2 = \mathsf{C}_2$ и $\mathsf{G}_2$.

    Это простейший пример кластерной алгебры: в данном случае имеется кластер из двух переменных, которые по очереди мутируют:
    \[(x_1, x_2) \leftrightsquigarrow (x_3, x_2) \leftrightsquigarrow (x_3, x_4) \leftrightsquigarrow (x_5, x_4) \leftrightarrow \dots\]
    При этом две мутации одной и той же переменной подряд ничего не меняют.

    Эта интерпретация показывает, почему рекуррентное соотношение разное в зависимости от чётности $i$: имеет значение, которая из двух переменных кластера меняется.

    В общем случае вместо такого пути будет регулярное дерево степени $n$, полное определение мы дадим позже~(\cref{cluster-algebra}).
    \setcounter{subsection}{1}
    \subsection{Фризы Кокстера --- Конвея}
    Фризы Кокстера --- Конвея --- частный случай $\SL_2$-tilings ($\SL_2$-замощения?).
    \definition[$\SL_2$-замощение]{Отображение $f: \Z^2 \to \Q$ с условием $f(i+1,j+1)f(i,j) - f(i,j+1)f(i+1,j) = 1$. }
    \definition[Фриз Кокстера --- Конвея ранга $n$]{
    $\SL_2$-замощение $f$ такое, что \[f(i, j) = \all{0,&i + j < 0 \\ 1,&i + j = 0 \\ 1,&i+j = n+1 \\ 0,&i + j > n+1}\]
    }
    Графически его изображают повёрнутым на $45^o$, вот так:
    \[\cdots\begin{array}{ccccccc}
          \hline
          1 && 1 && 1 && 1\\
          & a^1_1 && a^1_2 && a^1_3 &\\
          a^2_0 && a^2_1 && a^2_2 && a^2_3 \\
          & a^3_0 && a^3_1 && a^3_2 &\\
%          \hline
          &&&\ddots &&& \\
%          \hline
          1 && 1 && 1 && 1 \\
          \hline
    \end{array}\cdots \qquad \begin{array}{c}\begin{array}{ccc}
                                             &b& \\
                                             a&&d\\
                                             & c &
    \end{array}\\\text{должно быть выполнено } ad - bc = 1\end{array}\]
    \example[Фриз ранга $3$]{
    \[
\begin{tikzpicture}
    \node (table){ $\begin{array}{|ccccccccccccccc|}
                        \hline
                        1 && 1 && 1 && 1 && 1 && 1 && 1 && 1\\
                        & \frac53 && 2 && 1 && 5 && \frac23 && 3 && \frac53 &\\
                        4 && \frac73 && 1 && 4 && \frac73 && 1 && 4 && \frac73 \\
                        & 5 && \frac23 && 3 && \frac53 && 2 && 1 && 5 &\\
                        1 && 1 && 1 && 1 && 1 && 1 && 1 && 1\\
                        \hline
    \end{array}$};
    \draw[green] (-4, 0.65) -- (-2.5, -0.65) -- (-0.8, -0.65) -- (0.7, 0.65) -- (2.7, 0.65) -- (4, -0.65);
\end{tikzpicture}
    \]
    Как видно из картинки, фриз имеет ось скользящей симметрии со сдвигом на $\frac{n + 3}{2}$ и переворотом (основания трапеции равны $n + 1$ и $2$).
    Позже это будет видно из классификации в~\ref{freeze-classification}. \comment{Ну, надо что-то ещё потребовать, например, положительности всех элементов фриза хватит.
        А то, кажется, можно при желании составить башню из нескольких фризов произвольного размера, поставленных друг на друга.}
    }
    \exercise[Эффект лорановости]{
    Построим фриз сверху вниз, заполнив верхнюю строчку $a^1_*$ произвольно, и выражая элементы снизу через элементы сверху.
    Тогда если все $a^1_* \in \Z$, то и все элементы снизу тоже (это верно даже в большей общности, тут неважно, что это фриз, то есть что на каком-то уровне снизу будет строка единиц, а потом начнутся нули).
    }
    \theorem[Фриз, построенный по триангуляции]{
    Пусть $T$ --- триангуляция правильного $n$-угольника:
        \[\begin{tikzpicture}
              \pgfmathsetmacro{\R}{1.3};
              \coordinate (A) at ({\R * cos(0)}, {\R * sin(0)});
              \coordinate (B) at ({\R * cos(40)}, {\R * sin(40)});
              \coordinate (C) at ({\R * cos(80)}, {\R * sin(80)});
              \coordinate (D) at ({\R * cos(120)}, {\R * sin(120)});
              \coordinate (E) at ({\R * cos(160)}, {\R * sin(160)});
              \coordinate (F) at ({\R * cos(200)}, {\R * sin(200)});
              \coordinate (G) at ({\R * cos(240)}, {\R * sin(240)});
              \coordinate (H) at ({\R * cos(280)}, {\R * sin(280)});
              \coordinate (I) at ({\R * cos(320)}, {\R * sin(320)});
              \draw plot [smooth cycle, tension=0] coordinates { (A) (B) (C) (D) (E) (F) (G) (H) (I) };
              \draw plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
              \fill[black] (A) circle (1pt) node[above right]{$1$};
              \fill[black] (B) circle (1pt) node[above right]{$2$};
              \fill[black] (C) circle (1pt) node[above right]{$3$};
              \fill[black] (D) circle (1pt) node[above left]{$\dots$};
              \fill[black] (I) circle (1pt) node[right]{$n$};
              \draw[-] (A) -- (E);
              \draw[-] (A) -- (C);
              \draw[-] (G) -- (I);
        \end{tikzpicture}\]
        Строчка $a^1_i \in \Z$ соответствует фризу (то есть через какая-то строчка снизу будет полностью состоять из единиц) тогда и только тогда, когда $a^1_i$ --- количество треугольников, касающихся вершины $i$ (индексы берутся по модулю $n$).
    Например, триангуляции на рисунке соответствует фриз
    \[\begin{array}{|cccccccccccccccccc|}
    \hline
    1 && 1 && 1 && 1 && 1 && 1 && 1 && 1 && 1 &\\
    & 5 && 1 && 2 && 2 && 3 && 1 && 4 && 1 && 2\\
    9 && 4 && 1 && 3 && 5 && 2 && 3 && 3 && 1 &  \\
    & 7 && 3 && 1 && 7 && 3 && 5 && 2 && 2 && 4\\
    3 && 5 && 2 && 2 && 4 && 7 && 3 && 1 && 7 & \\
    & 2 && 3 && 3 && 1 && 9 && 4 && 1 && 3 && 5 \\
    3 && 1 && 4 && 1 && 2 && 5 && 1 && 2 && 2 & \\
    & 1 && 1 && 1 && 1 && 1 && 1 && 1 && 1 && 1\\
    \hline
\end{array}\]
    \prove[Доказательство в более простую сторону]{
    Рассмотрим двудольный граф $\Gamma$. В левой доле $n$ вершин, соответствующих вершинам многоугольника, а в правой --- $n+1$ вершина, соответствующая треугольнику.
        Проведём ребро, если вершина является вершиной треугольника.

        Пусть $m_{ij}$ --- количество совершенных паросочетаний (из $n + 1$ ребра), где в левой доле взяты все вершины, кроме $i$ и $j$.

    Ясно, что $m_{i,i+1} = 1$: это ребро какого-то треугольника, значит, этот треугольник берётся в паросочетание вместе с оставшейся третьей вершиной; после этого многоугольник разваливается на два, и дальше опять же все по индукции предопределено однозначно:
    \[\begin{tikzpicture}
    \draw plot [smooth cycle, tension=0] coordinates { (A) (B) (C) (D) (E) (F) (G) (H) (I) };
    \draw plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
    \fill[lightgray] plot [smooth cycle, tension=0] coordinates { (A) (D) (E) };
    \fill[black] (A) circle (1pt);
    \fill[black] (D) circle (1pt) node[above left]{$i$};
    \fill[black] (E) circle (1pt) node[left]{$i+1$};
    \draw[-] (A) -- (E);
    \draw[-] (A) -- (C);
    \draw[-] (G) -- (I);
\end{tikzpicture}\]
    Аналогично проверяется, что $m_{i-1,i+1} = a_i^1$ ($i$-я вершина стоит в паре с любым из инцидентных ей треугольников, после чего остальное предопределено однозначно).

    Осталось применить лемму о конденсации, доказательством которой мы утруждать себя не будем:
    \lemma[О конденсации]{
    Пусть $\Gamma$ --- плоский двудольный граф с левой долей $V_1$ и правой $V_2$, причём $|V_1| = |V_2| + 2$.
    Пусть $i, j \in V_1$. Обозначим через $m_{ij}$ количество совершенных паросочетаний между $V_1 \setminus \{i, j\}$ и $V_2$.
    Если $a, b, c, d \in V_1$ лежат на грани данного графа в этом циклическом порядке (и, разумеется, между ними при обходе грани есть ещё какие-то вершины графа), то выполнено соотношение
        \[m_{ab}m_{cd} + m_{bc}m_{ad} = m_{ac}m_{bd}\qedhere\]
    }
    }
    }
    Соотношение из леммы о конденсации напоминает теорему Птолемея из школьной планиметрии:
    \intfact[Теорема Птолемея]{
        У вписанного четырёхугольника произведение длин диагоналей равно сумме произведений противоположных сторон.
    }
    Также такой вид имеют соотношения в грассманиане.

    \subsection{Координаты на грассманиане и триангуляции}
    Пусть $K$ --- поле.
    Вспомним грассманиан $\Gr(k, n)$ --- многообразие, параметризующее $k$-мерные подпространства в $n$-мерии (например, в пространстве строк $\ind{^n}{K}{}$).

    Грассманиан удобно представлять себе, как множество матриц $M_{k \times n}(K)$ с точностью до действия $\GL_k(K)$ умножениями слева.

    Однородными координатами на грассманиане служат значения миноров $k \times k$, на которые накладываются соотношения Плюккера.
    В случае $k = 2$ эти соотношения выглядят следующим образом:
    \[p_{ik}p_{j\ell} = p_{ij}p_{k\ell} + p_{jk}p_{i \ell}\label{plucker}\tag{$\star$}\]
    где $i < j < k < \ell$, а $p_{ij} = p_{ji}$ равен значению квадратного минора из $i$-го и $j$-го столбца.
    Иными словами, для матрицы $x$: $p_{ij} = x_{1,\min(i, j)}x_{2,\max(i, j)} - x_{1,\max(i, j)}x_{2,\min(i, j)}$.
    Изображая это правило на картинке, получаем правило Птолемея:
    \[\begin{tikzpicture}
          \fill[lightgray] plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
          \draw plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
          \draw[-] (A) -- (E);
          \draw[-] (D) -- (G);
          \fill[black] (A) circle (1pt) node[above right]{$i$};
          \fill[black] (D) circle (1pt) node[above right]{$j$};
          \fill[black] (E) circle (1pt) node[left]{$k$};
          \fill[black] (G) circle (1pt) node[below]{$\ell$};
    \end{tikzpicture}\]
    Из картинки ясно, что на самом деле имеет значение только циклический порядок индексов $i, j, k, \ell \in \Z/n\Z$.

    \newlection{18 февраля 2026 г.}
    Размерность многообразия $\Gr(2, n)$ равна $2n - 4$, а размерность Крулля однородного координатного кольца $K[\Gr(2, n)] = K[p_{ij}]/\eqref{plucker}$ на единичку больше, значит, $2n - 3$.
    \definition[Матрица $A \in M_{m\times n}(\R)$ вполне положительна]{Все миноры $A$ положительны.}
    Заинтересуемся схожим вопросом: когда все миноры $2 \times 2$ в матрице $2 \times n$ положительны?
    Более точно, сколько миноров надо проверить на положительность, чтобы положительность остальных последовала?

    Из описания координатного кольца грассманиана ясно, что миноры матрицы --- любые $p_{ij} \in K$, удовлетворяющие соотношениям~\eqref{plucker}.
    Так как $\dim\R[\Gr(2, n)] = 2n - 3$, то такова и степень трансцендентности его поля частных, откуда ответ хотя бы $2n - 3$. \comment{Это видимо не совсем строгое утверждение, так как $\R$ не алгебраически замкнуто.}
    С другой стороны, эта оценка достигается:
    \proposal{\label{plucker-recovery}
    Пусть $T$ --- триангуляция правильного $n$-угольника (множество неупорядоченных пар вершин, соединённых ребром, в том числе пары соседних вершин).
        Пусть $P \coloneqq \defset{p_{ij}}{(i,j)\in T}$
        Тогда любой $p_{rs}$ выражается в виде некоторой рациональной функции от элементов $P$ с положительными коэффициентами.
    В частности, положительность элементов $P$ повлечёт положительность всех миноров $2 \times 2$.
    \prove{Рассмотрим граф, вершины которого --- триангуляции $n$-угольника, а рёбра соответствуют \emph{флипам} следующего вида:
        \[\begin{tikzpicture}[baseline=(current bounding box.center)]
              \fill[lightgray] plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
              \draw plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
              \draw plot [smooth cycle, tension=0] coordinates { (A) (B) (C) (D) (E) (F) (G) (H) (I) };
              \fill[black] (A) circle (1pt) node[above right]{$1$};
              \fill[black] (B) circle (1pt) node[above right]{$2$};
              \fill[black] (C) circle (1pt) node[above right]{$3$};
              \fill[black] (D) circle (1pt) node[above left]{$\dots$};
              \fill[black] (I) circle (1pt) node[right]{$n$};
              \draw[-] (A) -- (C);
              \draw[-] (G) -- (I);
              \draw[-] (D) -- (G);
        \end{tikzpicture}\qquad\rightsquigarrow\qquad\begin{tikzpicture}[baseline=(current bounding box.center)]
              \fill[lightgray] plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
              \draw plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
              \draw plot [smooth cycle, tension=0] coordinates { (A) (B) (C) (D) (E) (F) (G) (H) (I) };
              \fill[black] (A) circle (1pt) node[above right]{$1$};
              \fill[black] (B) circle (1pt) node[above right]{$2$};
              \fill[black] (C) circle (1pt) node[above right]{$3$};
              \fill[black] (D) circle (1pt) node[above left]{$\dots$};
              \fill[black] (I) circle (1pt) node[right]{$n$};
              \draw[-] (A) -- (C);
              \draw[-] (G) -- (I);
              \draw[-] (A) -- (E);
        \end{tikzpicture}\]
    А именно, любая хорда триангуляции является ребром двух смежных треугольников, в объединении дающих четырёхугольник.
        Назовём \emph{флипом} замену данной хорды триангуляции на другую диагональ четырёхугольника.
        Кстати, этот граф является остовом $(n-3)$-мерного ассоциэдра.

    Ясно, что любая хорда $n$-угольника лежит в какой-то триангуляции.
        Без доказатеельства утверждается, что граф триангуляций связен. Начнём с триангуляции $T$, и, применяя флипы, дойдём до триангуляции, содержащей хорду $r-s$.
        Легко видеть, что $p_{ik}$, где $i-k$ --- хорда, появляющаяся после флипа, выражается через остальные $p_{j\ell}$, отвечающие хордам, присутствовавшим до флипа:
    \[p_{ik} = \frac{p_{ij}p_{k\ell} + p_{jk}p_{i \ell}}{p_{j\ell}}\qquad
    \begin{tikzpicture}[baseline=(current bounding box.center)]
         \fill[lightgray] plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
         \draw plot [smooth cycle, tension=0] coordinates { (A) (D) (E) (G) };
         \draw[-] (A) -- (E);
         \draw[-] (D) -- (G);
         \fill[black] (A) circle (1pt) node[above right]{$i$};
         \fill[black] (D) circle (1pt) node[above right]{$j$};
         \fill[black] (E) circle (1pt) node[left]{$k$};
         \fill[black] (G) circle (1pt) node[below]{$\ell$};
    \end{tikzpicture}\qedhere\]
    }
    }

    Эту теорему можно пытаться обобщать на разные интересные случаи --- рассматривать не только триангуляции, или скажем работать не на плоскости (или её компактификации --- сфере), а на поверхности с большим числом ручек.
    Впрочем, начиная с некоторого места она уже перестаёт быть верной.

    Ещё пару слов про флипы и триангуляции: можно считать, что диагонали пронумерованы от $1$ до $n - 3$, и при флипе новая диагональ нумеруется тем числом, что было написано на стираемой.
    Тогда получается, что на множестве триангуляций действует свободное произведение $\underbrace{C_2 * \ldots * C_2}_{n}$.

    Действие, разумеется, не свободное.
    Например, флипы диагоналей, далеко друг от друга отстоящих, коммутируют.
    Сами пометки на диагоналях тоже могут перемещаться:
    \exercise{
    Получите последовательностью пяти флипов из одной триангуляции шестиугольника другую:
        \[\begin{tikzpicture}[baseline=(current bounding box.center)]
            \pgfmathsetmacro{\R}{1.3};
            \coordinate (BC) at ({\R * cos(60)}, {\R * sin(60)});
            \coordinate (EF) at ({\R * cos(180)}, {\R * sin(180)});
            \coordinate (HI) at ({\R * cos(300)}, {\R * sin(300)});
            \fill[lightgray] plot [smooth cycle, tension=0] coordinates { (A) (BC) (D) (EF) (G) (HI) };
            \draw plot [smooth cycle, tension=0] coordinates { (A) (BC) (D) (EF) (G) (HI) };
            \draw[-] (A) -- (D) node [midway, above] {$1$};
            \draw[-] (D) -- (G) node [midway, left] {$2$};
            \draw[-] (G) -- (A) node [midway, below] {$3$};
        \end{tikzpicture}\qquad\rightsquigarrow\qquad\begin{tikzpicture}[baseline=(current bounding box.center)]
           \fill[lightgray] plot [smooth cycle, tension=0] coordinates {(A) (BC) (D) (EF) (G) (HI)};
           \draw plot [smooth cycle, tension=0] coordinates {(A) (BC) (D) (EF) (G) (HI) };
           \draw[-] (A) -- (D) node [midway, above] {$1$};
           \draw[-] (D) -- (G) node [midway, left] {$3$};
           \draw[-] (G) -- (A) node [midway, below] {$2$};
        \end{tikzpicture}\]
    }
    \subsection{Классификация фризов}
    \label{freeze-classification}
    Пусть $p \in \Gr(2, n)$ --- точка с однородными координатами $p_{ij}$; предположим, что для всех $i \in \Z/n\Z$: $p_{i,i+1} = 1$.
    Можно составить фриз из координат этой точки следующим образом:
    \[\cdots\begin{array}{ccccccc}
          \hline
          1 && 1 && 1 && 1\\
          & p_{1,3} && p_{2,4} && p_{3,5} &\\
          p_{n,3} && p_{1,4} && p_{2,5} && p_{3,6} \\
          & p_{n,4} && p_{1,5} && p_{2,6} &\\
          &&&\ddots &&& \\
          & p_{?,?-2} && p_{?+1,?-1} && p_{?+2,?} & \\
          1 && 1 && 1 && 1 \\
          \hline
    \end{array}\cdots\]
    $\SL_2$-соотношения выполнены, так как в них превращается соотношение~\eqref{plucker}:
    \[\begin{array}{ccc}
          &p_{i+1,j}& \\
          p_{i,j}&&p_{i+1,j+1}\\
          & p_{i,j+1} &
    \end{array}
    \qquad\begin{tikzpicture}[baseline=(current bounding box.center)]
          \draw[dashed] (-2,-1.5) -- (-2,1.5);
          \draw plot [smooth cycle, tension=0] coordinates { (BC) (D) (EF) (G) };
          \fill (BC) circle (1pt) node[above right]{$i$};
          \fill (D) circle (1pt) node[above right]{$i+1$};
          \fill (D) circle (1pt) node[above right]{$i+1$};
          \fill (EF) circle (1pt) node[left]{$j$};
          \fill (G) circle (1pt) node[left]{$j+1$};
          \draw[dashed] (1.4,-1.5) -- (1.4,1.5);
    \end{tikzpicture}\qquad
    p_{i,j}p_{i+1,j+1} - p_{i+1,j}p_{i,j+1} = p_{i,i+1}p_{j,j+1} = 1
    \]
    Обратно, если есть некоторый фриз, то можно построить числа $p_{ij}$, удовлетворяющие соотношениям Плюккера: пройдём зигзагом вниз по фризу, и положим значения координат, соответствующим зигзаг-триангуляции, равными $q_i$, а остальные восстановим как в~(\cref{plucker-recovery}).
    \[\cdots\begin{array}{ccccccc}
                \hline
                1 && 1 && 1 && 1\\
                & q_1 && \square && \square &\\
                q_2 && \square && \square && \square \\
                & q_3 && \square && \square &\\
                \hline
                &&&\ddots &&& \\
                \hline
                & q_{n-3} && \square && \square & \\
                1 && 1 && 1 && 1 \\
                \hline
    \end{array}\cdots\qquad\begin{tikzpicture}[baseline=(current bounding box.center)]
           \draw plot [smooth cycle, tension=0] coordinates { (A) (B) (C) (D) (E) (F) (G) (H) (I) };
           \draw[-] (D) -- (B) -- (E) -- (A) -- (F) -- (I) -- (G);
    \end{tikzpicture}\]
    Далее остальные значения во фризе восстанавливаются однозначно из $\SL_2$-соотношений, и в силу выше построенного примера, они все будут иметь вид $p_{ij}$.
    Единственность на самом деле имеет место чуть более слабая --- например, она есть если все $q_i > 0$ --- тогда~\cref{plucker-recovery} говорит, что все полученные координаты будут положительными.
    Значит, на самом деле фриз однозначно восстанавливается по $q_i$ и на некотором открытом по Зарисскому множестве.
    \note{
    Отсюда получается, что при условии $p_{i,i+1} = 1$ для всех $i \in \Z/n\Z$ точка лежит на грассманиане, если выполнены уравнения
    \[p_{i,j}p_{i+1,j+1} - p_{i+1,j}p_{i,j+1} = 1.\]
        \comment{По-видимому, если ещё подумать, отсюда следует, что вместо всех соотношений грассманиана достаточно проверять соотношения
        \[p_{i,j}p_{i+1,j+1} - p_{i+1,j}p_{i,j+1} = p_{i,i+1}p_{j,j+1},\]
        но я не уверен}.
    }
    \section{Определения}
    \subsection{Колчаны и кластерные матрицы}
    \definition[Колчан]{Произвольный ориентированный граф $Q = (V, E)$, в котором всё разрешено: петли, кратные рёбра, может быть даже бесконечное число вершин или рёбер\ldots}
    \definition[Кластерный колчан]{Конечный колчан без петель и рёбер туда-обратно (пары рёбер вида $i \to j$ и $j \to i$).}

    Кластерные колчаны $Q$ взаимно однозначно соответствуют кососимметрическим матрицам: колчану $Q$ отвечает матрица $B_Q \in M_{n}(\Z)$ (где $n = |V|$):
    \[(B_Q)_{i,j} = \all{\#\{i \to j\},& \text{ есть стрелки $i \to j$} \\ \#\{j \to i\},& \text{ есть стрелки $j \to i$}\\0,&\text{иначе}}\]
    \definition[Кластерный колчан с замороженными вершинами]{
        Кластерный колчан на $N$ вершинах, где первые $n \le N$ вершин называются \emph{незамороженными}, а последние $N - n$ вершин называются \emph{замороженными}, и между ними нет рёбер.
    }
    На матричном языке кластерный колчан с замороженными вершинами изображают в виде матрицы $\tilde{B} \in M_{N\times n}(\Z)$, где $\tilde{B} = \vect{B\\\hline C}$, и $B \in M_{n}(\Z)$ кососимметрическая, а $C \in M_{(N-n) \times n}(\Z)$ --- любая.
    Теоретически можно было бы считать, что кластерному колчану с замороженными вершинами отвечает кососимметрическая матрица из $M_{N}(\Z)$, где правый нижний квадрат $(N - n) \times (N - n)$ нулевой, но так уже не поступить с обобщением данного понятия --- \emph{кластерными матрицами}, которые мы определим чуть позже.


    Пусть $Q$ --- конечный кластерный колчан, $1 \le i \le n$ --- незамороженная вершина.
    \definition[Мутация $Q$ в вершине i]{
        На колчанном языке это новый колчан $M_i(Q)$, в котором множество вершин то же самое, а множество рёбер претерпевает следующие изменения:
    \numbers{
        \item Для каждой пары вершин $k, \ell$, таких, что есть рёбра $k \to i \to \ell$, добавляем ребро $k \to \ell$ (если рёбер $k \to i$ всего $n_k$ штук, а рёбер $i \to \ell$ всего $n_\ell$ штук, то мы добавим $n_k \cdot n_\ell$ рёбер.
        \item Разворачиваем стрелки, инцидентные $i$.
        \item Стираем всевозможные противонаправленные пары (если было $m$ рёбер в одну сторону, и $\ell$ в другую, то останется $\abs{m - \ell}$ понятно в какую сторону).
    }
    }
    На матричном языке мутация выглядит так: из $B_Q = (b_{ij})$ получается $B_{M_i(Q)} \eqqcolon M_i(B_Q) = (b'_{ij})$:
    \[b'_{pq} = \all{-b_{pq}, & i = p \text{ или } i = q \\ b_{pq} + b_{pi}b_{iq},& b_{pi}, b_{iq} > 0 \\ b_{pq} - b_{pi}b_{iq} ,& b_{pi}, b_{iq} < 0 \\ b_{pq} ,&\text{иначе}}\tag{$\triangle$}\label{mutation}\]

    \note{Это инволюция: две мутации подряд в одной и той же вершине не меняют колчан.}
    \example{Пусть $v$ --- сток или исток. Мутация в вершине $v$ --- разворот рёбер, инцидентных $v$.}
%    // времени много прошло сегодня... Ладно, может хотя бы определение кластерной алгебры дадим сегодня. (18:14)
    \exercise{Если $Q$ --- дерево на $n$ вершинах, то мутациями в истоках и стоках можно получить любую ориентацию всех $n - 1$ рёбер.}
    Этот факт известен даже среди алгебраистов, и отвечает следующему утверждению: категории модулей над некоторыми конечномерными алгебрами почти эквивалентны в некотором смысле, \comment{вроде так}.

    Однако если делать мутации не в источниках и стоках, то даже какой-нибудь путь может претерпевать очень значительные изменения.
    Тем не менее, верен следующий факт:
    \intfact{Пусть $Q_1$ и $Q_2$ --- два кластерных колчана без ориентированных циклов на одном множестве вершин.
    Предположим, что они эквивалентны: существует последовательность мутаций, превращающих один в другой.
    Тогда $Q_2$ получается из $Q_1$ только при помощи мутаций в источниках и стоках. В частности, они изоморфны как неориентированные графы.}
    Что любопытно, комбинаторное доказательство этой теоремы неизвестно, а вот с помощью кластерных категорий доказательство существует уже давно.

    \definition[Матрица $B' \in M_{n}(\mathbb{Z})$ кососимметризуема]{Существуют $D = \mathrm{diag}(d_1, \ldots, d_n)$ при $d_i > 0$ и кососимметричная $B \in M_n(\mathbb{Z})$: $B' D = D B$. }
%    Говоря русским языком, кососимметричная матрица с точностю до перемасштабирования строк \comment{Что? Вроде же с точностью до сопряжения\ldots}
    \definition[Кластерная матрица]{$\tilde{B} \in M_{N,n}(\mathbb{Z})$, такая что верхний квадрат $n \times n$ --- кососимметризуемая матрица, а нижний прямоугольник --- любая.}
    Мутацию в незамороженной вершине $1 \le i \le n$ кластерной матрицы определим по формуле\eqref{mutation}.
    \statement{Мутация по-прежнему инволюция; кососимметризуемость верхнего квадрата сохраняется после мутации; $M_i$ коммутирует с транспониованием $B \mapsto B^t$ и разворотом всех рёбер $B \mapsto -B$.
    Если $b_{ij} = b_{ji}=0$, то мутации $M_i$ и $M_j$ коммутируют при действии на даyную кластерную матрицу.
    \prove{
        Не совсем очевидно, но проверяется в лоб.
    }
    }
    \subsection{Кластерная алгебра}
    \label{cluster-algebra}
    Обозначим через $T_n$ регулярное дерево степени $n$ с неориентированными рёбрами, покрашенными числами $1, \ldots, n$.
    Иными словами, граф Кэли для $\underbrace{C_2 * \ldots * C_2}_{n}$.
    Отметим некоторую вершину $t_0$.

    Теперь пусть $K$ --- поле, $\tilde{B} \in M_{N\times n}(\mathbb{Z})$ --- кластерная матрица.
    Для определения кластерной алгебры нам потребуется следующий набор данных:
    \bullets{
    \item Отображение $\tilde{B}$, сопоставляющее каждой вершине $T_n$ по кластерной матрице $N\times n$, такое что для любых вершин $t_1$ и $t_2$, соединённых ребром цвета $i$, выполнено соотношение $\tilde{B}(t_2) = M_i(\tilde{B}(t_1))$.
        Ясно, что задать такое отображение --- всё равно, что задать \emph{начальную кластерную матрицу} для $t_0$, остальные определяются однозначно.
    \item Отображение $x: V(T_n) \to K(x_1, \ldots, x_{N})^N$. Вектор $x(t) = \vect{x_1^t, \ldots, x_N^t}$ называется \emph{расширенным кластером} в вершине $t$, а совокупность всех элементов всех векторов зовётся \emph{кластерными переменными}.
        Первые $n$ переменных расширенного кластера формируют обычный \emph{кластер}.
        При этом $x(t_0) = (x_1, \ldots, x_N)$ --- \emph{начальный кластер}, и опять же имеется связь между значениями в соседних вершинах: если вершины $t$ и $t'$ соединены ребром цвета $i$, $x(t) = y, x(t') = y'$, и в вершине $i$ стоит матрица $B(t) = (b_{ij})$ то при $j \ne i$: $y_j = y_j'$, а при $j = i$ выполнено соотношение: \[y_i y_i' = \prod_{b_{ki}>0}y_k^{b_{ki}} + \prod_{b_{ki}<0}y_k^{-b_{ki}}.\tag{$\leftrightarrow$}\label{cluster-relation}\]
    Так как при мутации в вершине $i$ элементы соответствующих строки и столбца кластерной матрицы меняют знаки, это соотношение не зависит от того, какой из концов ребра мы назначаем в качестве $t$, а какой --- в качестве $t'$.
    }
    Пару $(x(t_0), \tilde{B}(t_0))$ называют \emph{кластерным зерном} (cluster seed).
    \definition[Кластерная алгебра $A(B)$]{Подалгебра в $K(x_1, \ldots, x_N)$, порождённая кластерным переменными.}
    И это ещё не самое общее определение, здесь мы определили так называемую \emph{кластерную алгебру геометрического типа}.
    Но других у нас, вероятно, не будет.

    Этот тип называется геометрическим, так как однородное кольцо грассманиана и некоторых других интересных многообразий --- такие кластерные алгебры.
    \newlection{25 февраля 2026 г.}
    На самом деле, условие кососимметризуемости не особо существенно, мы будем использовать только кососимметричность по знаку: $\sgn(b_{ij}) = -\sgn(b_{ij})$.
    На кососимметризуемые матрицы можно смотреть, как на класс кососимметричных по знаку матриц, замкнутых относительно мутаций.
    \subsection{Эффект лорановости для кластерной алгебры}
%    Заметим, кстати, что
%    \note{
%        Если $\tilde{B} = (b_{ij})$, где $b_{pq} = b_{qp} = 0$, то $M_p$ не меняет $q$-е строку и столбец, а значит $M_q M_p (\tilde{B}) = M_p M_q (\tilde{B})$.
%    }
    \note{
        Cоотношение~\eqref{cluster-relation} ещё можно переписать в виде
        \[y_i y_i' = \prod_{b_{ki}>0}y_k^{b_{ki}}\left(1 + \prod_{k}y_k^{-b_{ki}}\right).\]
    }
    \note{
        В кластерную алгебру $A$, задаваемую зерном $(X, \tilde{B})$, можно добавлять или убирать (подставляя $x_i \coloneqq 1$) замороженные переменные.
        При этом для согласованности надо также добавлять или убирать строки в $\tilde{B}$.
    }
    \note{
    Также можно замораживать ранее незамороженные переменные, стирая при этом соответствующий столбец матрицы $\tilde{B}$.
    }
    \theorem[Эффект лорановости]{
    Пусть $M = \left\{\prod\limits_{a_i \ge 0}x_i^{a_i}\right\}$ --- мультипликативная система всех мономов кольца многочленов.
    Утверждается, что $A \subset L \coloneqq M^{-1}K[x_1, \ldots, x_N]$.
        Иными словами, любая кластерная переменная --- ряд Лорана относительно переменных начального (отсюда ясно, что на самом деле любого) кластера.
    \prove{Доказательство не особо идейное, надо просто проверить, что все детали определения хорошо придуманы.

    Пусть $X = (x_1, \ldots, x_N)$ --- начальный кластер.
    Любой другой кластер имеет вид $M_{i_s} \proddots M_{i_1}(X)$.
    Доказывать будем индукцией по $s$.

    \underline{База:} $s = 1$ ясно, и на самом деле ясно даже $s = 2$: $M_j(M_i(X))$ при $j \ne i$ --- рациональная функция от переменных начального кластера с делением только на мономы от них самих.

    \underline{Переход:} Рассмотрим несколько случаев.
    \bullets{
    \item Пусть $s = 3$, $i_1 = i_3 = j$, $i_2 = k$:
    \[\begin{tikzpicture}
          \draw[-] (0, 0) -- (2, 0) node[midway, above] {$j$};
          \draw[-] (4, 0) -- (2, 0) node[midway, above] {$k$};
          \draw[-] (4, 0) -- (6, 0) node[midway, above] {$j$};
          \fill[black] (0, 0) circle (2pt) node[above] {$t_0$};
          \fill[black] (2, 0) circle (2pt) node[above]{$\tilde{B}$} node[below] {$x_j'$};
          \fill[black] (4, 0) circle (2pt) node[above]{$\tilde{B}'$} node[below] {$x_j', x_k'$};
          \fill[black] (6, 0) circle (2pt) node[below] {$x_j'', x_k'$};
    \end{tikzpicture}\]
    Для некоторых мономов $M_i$
    \[x_j' = \frac{M_1 + M_2}{x_j},\qquad x_k' = \frac{M_3 + M_4}{x_k}, \qquad x_j'' = \frac{M_5 + M_6}{x_j'} = \frac{M_5 + M_6}{M_1 + M_2}x_j.\]
    Значит, достаточно проверить, что в $L$: $M_5 + M_6$ делится на $M_1 + M_2$.

    Без потери общности $b_{jk} > 0$ (если одновременно поменять все знаки элементов $\tilde{B}$, то кластерные переменные останутся прежними; если же $b_{jk} = 0$, то $M_j$ и $M_k$ коммутируют, и доказывать нечего).

       В $L$ имеет место ассоциированность $x_j' \sim M_1 + M_2 \sim \prod\limits_{i}x_i^{b_{ij}} + 1 \eqqcolon P$.
    Далее работаем по модулю $P$, так как нас интересует делимость на $P$.

    \[x_k' = \frac{1}{x_k}\left((x_j')^{b_{jk}}\prod\limits_{b_{ik} > 0}x_i^{b_{ik}} + \prod\limits_{b_{ik} < 0}x_i^{-b_{ik}}\right)\equiv \frac{1}{x_k}\prod\limits_{b_{ik} < 0}x_i^{-b_{ik}}\pmod{P}\]
    Далее \multline{M_5 + M_6 \sim (x_k')^{b_{kj}'}\left(\prod\limits_{i \ne k}x_i^{b_{ij}'} + 1\right) \equiv \\\text{подставляем определение $x_k'$ и $b'_{*,j}$}\\ \equiv \left(\frac{1}{x_k}\prod\limits_{b_{ik} < 0}x_i^{-b_{ik}}\right)^{b_{kj}'}\left(\prod\limits_{i \ne k}x_i^{b_{ij}'} + 1\right). }
    В правой части получилось в точности $\frac{x_k'}{x_k} \equiv 0 \pmod{P}$, так как из-за условия $b_{kj} < 0$ по определению мутации $b_{ij}' = \all{b_{ij} - b_{ik}b_{kj},&b_{ik}<0 \\ b_{ij},&b_{ik}\ge 0}$ при $i \ne k$ (ну, и $b_{kj}' = -b_{kj}$).
    \item Теперь общий случай.
    Индукционное предположение говорит, что меньше чем за $s$ шагов эффект лорановости сохраняется для \textbf{любой} кластерной алгебры.

    Пусть по-прежнему $i_1 = j$, $i_2 = k$.
    \bullets{
    \item Если $b_{jk} = b_{kj} = 0$, то первые две мутации коммутируют:
        \[\begin{tikzpicture}
              \draw[-] (0, 0) -- (2, 1) node[above, midway] {$j$};
              \draw[-] (0, 0) -- (2, -1) node[above, midway] {$k$};
              \draw[-] (4, 0) -- (2, 1) node[above, midway] {$k$};
              \draw[-] (4, 0) -- (2, -1) node[midway, above]{$j$};
              \draw[dashed] (4, 0) -- (7, 0);
              \fill[black] (0, 0) circle (2pt) node[below]{$\tilde{B}$} node[above] {$t_0$};
              \fill[black] (2, 1) circle (2pt) node[below]{$\tilde{B}'$} node[above] {$X^j$};
              \fill[black] (2, -1) circle (2pt) node[below]{$\tilde{B}''$} node[above] {$X^k$};
              \fill[black] (4, 0) circle (2pt);
              \fill[black] (7, 0) circle (2pt) node[above] {$t_s$};
        \end{tikzpicture}\]
    Применяя индукционное предположение для двух путей, стартующих в соседях $t_0$ с рисунка, получаем два представления для любой переменной $x$ в кластере $t_s$ вида \[x = \ell_j(x_1, \ldots, x_j', \ldots, x_N) = \ell_k(x_1, \ldots, x_k', \ldots, x_N),\] где $\ell_j, \ell_k$ --- некоторые лорановские многочлены.
        Пусть $x_j' = M_1 + M_2$ и $x_k' = M_3 + M_4$.
        Получается, \[x = \frac{\ell_j'(x_1, \ldots, x_j, \ldots, x_N)}{(M_1 + M_2)^{n_j}} = \frac{\ell_k'(x_1, \ldots, x_k, \ldots, x_N)}{(M_3 + M_4)^{n_k}}.\]
        Кольцо многочленов факториально, значит достаточно проверить взаимную простоту $M_1 + M_2$ и $M_3 + M_4$.
    Однако в общем случае это ничуть неверно: например, вполне может статься $M_1 = M_3$ и $M_2 = M_4$.

    Придётся немного изменить аргумент: введём новую замороженную переменную $x_{N+1}$, добавляя в $\tilde{B}$ строчку $e^j = (0, \ldots, \underset{j}{1}, \ldots, 0)$ (на $j$-м месте единичка, остальные нули).

        Теперь $M_1 + M_2 = x_{N+1}\tilde{M}_1 + M_2$, и $M_3 + M_4$ прежний.
        Значит, $M_1 + M_2$ линеен по $x_{N+1}$, следовательно это произведение какого-то неприводимого многочлена и монома.
        Однако $M_3 + M_4$ не содержит $x_{N+1}$, откуда получается $\gcd(M_1 + M_2, M_3 + M_4)$ --- какой-то моном (или просто $1$, если смотреть с точностью до ассоциированности в кольце лорановских многочленов)

    Осталось специализировать $x_{N+1} \coloneqq 1$.
    \item Теперь считаем, что $b_{jk} \ne 0$ (без потери общности $b_{jk} < 0$).
        Изобразим помимо основного пути ещё ответвление цвета $j$ от $t_2$:
        \[\begin{tikzpicture}
              \draw[-] (0, 0) -- (2, 0) node[above, midway] {$j$};
              \draw[-] (4, 0) -- (2, 0) node[above, midway] {$k$};
              \draw[-] (4, 0) -- (6, -1.5) node[midway, right]{$j$};
              \draw[dashed] (4, 0) -- (7, 0);
              \fill[black] (0, 0) circle (2pt) node[below]{$X$} node[above] {$t_0$};
              \fill[black] (2, 0) circle (2pt) node[below]{$X^j$} node[above] {$x_j$};
              \fill[black] (6, -1.5) circle (2pt) node[right]{$x_k', x_j''$} node[left] {$X^{j'}$};
              \fill[black] (4, 0) circle (2pt) node[below] {$X^k$} node[above] {$x_j', x_k'$};
              \fill[black] (7, 0) circle (2pt);
        \end{tikzpicture}\]
    Может статься, что $i_3 = j$, это ничему не помешает.

    Применим дважды индукционное предположение, для путей меньшей длины, исходящих из вершин с начальными кластерами $X^j$ и $X^{j'}$, получим $x = \frac{\ell_j(x_1, \ldots, x_N)}{(x_j')^{n_j}} = \frac{\ell_k(x_1, \ldots, x_N)}{(x_k')^{n_k}\cdot (x_j'')^{n_j'}}$.
    Аналогично предыдущему пункту, введём новые переменные $x_q$ и $x_r$, и добавим соответствующие им строки: $q$-ю равной $e^j$ и $r$-ю равной $e^k$.
    Докажем, что после добавления новых переменных $\gcd(x_j', x_k') =  \gcd(x_j', x_j'') = 1$.

    \[\arr{c}{\arr{cccc}{&{\scriptstyle j} & {\scriptstyle k}} \\ \arr{c}{{\scriptstyle j} \\ {\scriptstyle k} \\ {\scriptstyle q} \\ {\scriptstyle r}}\vect{0 & -b \\ c & 0 \\ 1 & 0 \\ 0 & 1}} \overset{M_j}\rightsquigarrow \arr{c}{\arr{cc}{{\scriptstyle j} & {\scriptstyle k}}\\\vect{0 & b \\ -c & 0 \\ -1 & 0 \\ 0 & 1}} \overset{M_k}\rightsquigarrow \arr{c}{\arr{cc}{{\scriptstyle j} & {\scriptstyle k}}\\\vect{0 & -b \\ c & 0 \\ -1 & 0 \\ 0 & -1}}\]
    \[x_j' = \frac{(x_k)^c x_q M_1 + M_2}{x_j} \qquad x_k' = \frac{(x_j')^b x_r M_3 + M_4}{x_k} \qquad x_j'' = \frac{x_q M_5 + x_k^{c}M_6}{x_j'}\]
    $x_k'$ линеен по $x_r$, значит неприводим в кольце лорановских многочленов.
        $x_j'$ не содержит переменной $x_r$, значит, $x_j'x_j' \notdivisibleby x_k'$, откуда $\gcd(x_j', x_k') = 1$.
        Ранее доказали, что $x_j''$ --- лорановский многочлен.
        Если предположить, что он не взаимно прост с (неприводимым с точностью до монома) $x_j'$, то получится, что числитель $x_q M_5 + x_k^c M_6$ делится как минимум на квадрат $x_j'$. Но они оба линейны по $x_q$, противоречие.\qedhere
    }
    }
    }
    }
    \exercise{
    На самом деле, $A \subset \tilde{M}^{-1}K[x_1, \ldots, x_N]$, где $\tilde{M}$ --- мономы от незамороженных переменных.

    Указание: хватит простой индукции: надо проверить, что степень вхождения замороженных переменных в кластерные нулевая.
    }

    Можно задать вопрос, какого вида будут соответствующие лорановские многочлены.
    Некоторое время стояла гипотеза, что все коэффициенты положительны (в определении кластерной алгебры вычитаний никаких нет, но есть сокращение дробей; скажем, $\frac{x^3 + y^3}{x + y} = x^2 - xy + y^2$).
    Ради этого ввели кластерные категории, но в данном случае мощь алгебры оказалась неоправданной: теперь есть и комбинаторное доказательство.
\end{document}
