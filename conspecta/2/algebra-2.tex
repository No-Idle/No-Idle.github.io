\documentclass[a4paper]{report}

\usepackage{../mathstemplate}

\date{II семестр, весна 2023 г.}
\title{Алгебра. Неофициальный конспект}
\author{Лектор: Николай Александрович Вавилов \and \\ Конспектировал Леонид Данилевич}

\begin{document}
    \shorthandoff{"}
    \maketitle
    \tableofcontents
    \newpage
    \setcounter{lection}{0}


    \chapter{Вычислительная линейная алгебра}
    \newlection{14 февраля 2023 г.}


    \section{Элементарные преобразования}
    Пусть $R$ --- ассоциативное кольцо с единицей.
    Займёмся изучением некоторых особенных видов (пока квадратных) матриц $M(n, R)$.

    \subsection{Элементарные трансвекции}

    \definition[Элементарная трансвекция]{
        $t_{i,j}(\xi) = e+ \xi \cdot e_{i,j}$ для $i \ne j, \xi \in R$.
        Иными словами, матрица вида \[\ivect{\vspace{1em}\\i\\\vspace{2em}}{\hspace{2.6em} j }{1 & & & 0 \\ & \ddots & \xi & \\ & &\ddots  & \\ 0 & & & 1}\]
    }
    \definition[Элементарные преобразования первого типа, или трансвекции]{
        Группа по умножению, порождённая элементарными трансвекциями.
    }
    В частности, $t_{1,2}(\xi) = \vect{1 & \xi \\ 0 & 1}, \quad t_{2,1}(\xi) = \vect{1 & 0 \\ \xi & 1}$.
    \lemma[Аддитивность трансвекций по $\xi$]{
        $t_{i,j}(\xi) \cdot t_{i,j}(\zeta) = t_{i,j}(\xi + \zeta)$.
        Иными словами, $t_{i,j}: R \map GL(n, R)$ --- гомоморфизм для любых $1 \le i \ne j \le n$.
        \provehere{
            Посчитаем $t_{i,j}(\xi)\cdot t_{i,j}(\zeta)$. Это можно сделать так:
            \[(e + \xi e_{i,j})(e + \zeta e_{i,j}) = e + \xi e_{i,j} + \zeta e_{i,j} + \xi \zeta e_{i,j} e_{i,j}\text{, последнее слагаемое 0, так как $i \ne j$.}\]
            а можно так:
            \[\vect{1 & \xi \\ 0 & 1} \cdot \vect{1 & \zeta \\ 0 & 1} = \vect{1 & \xi + \zeta \\ 0 & 1}\]
            Последняя выкладка работает и для матриц произвольного размера, так как в вычислении на самом деле используются лишь 2 различных индекса --- $i$ и $j$.
            При замене из на $1$ и $2$ ничего не поменяется, так как определение умножения не опирается на порядок строк или столбцов.

            Такой трюк позволяет компактно записывать вычисления с большими матрицами, мало отличающимися от нейтральной $e$.
        }
    }
    \corollary{
        $t_{i,j}(\xi)^{-1} = t_{i,j}(-\xi)$, откуда $t_{i,j}(\xi) \in GL(n, R) \bydef M(n, R)^*$.
    }
    \lemma[Коммутационная формула Шевалле]{
        Мультипликативный коммутатор двух трансвекций --- часто трансвекция:
        \[[t_{i,j}(\xi), t_{h,k}(\zeta)] = \all{t_{i,k}(\xi\zeta),&i \ne k\land j = h \\ t_{h,j}(-\zeta\xi),&i = k\land  j \ne h \\ e, & i \ne k \land j \ne h \\ \text{что-то},& i = k \land j = h}\]
        (Мультипликативный коммутатор $[x, y] \bydef xyx^{-1}y^{-1}$)
        \provehere{
            Можно тупо записать огромные формулы:
            \gather{
                [t_{i,j}(\xi), t_{h,k}(\zeta)] = t_{i,j}(\xi)\cdot t_{h,k}(\zeta) \cdot t_{i,j}(-\xi) \cdot t_{k,h}(-\zeta) = (e + \xi e_{i,j})(e + \zeta e_{h,k})(e - \xi e_{i,j})(e -  \zeta e_{h,k}) = \\
                = \dots = e + \xi\zeta \delta_{j,h}e_{i,k} - \zeta\xi \delta_{k,i}e_{h,j} + \zeta\xi\zeta\delta_{k,i}\delta_{j,h}e_{h,k} - \xi\zeta\xi \delta_{j,h}\delta_{k,i}e_{i,j}  + \xi\zeta\xi\zeta\delta_{j,h}\delta_{k,i}\delta_{j,h}e_{i,k}
            }
            \sout{Какая боль это писать\ldots И ведь никто не прочитает и не проверит\ldots} Прошу прощения, был неправ.

            Члены с коэффициентами вида $\xi^2$ или $\xi^2 \zeta$, то есть те, где есть квадрат чего-то, точно обнуляются, так как по определению трансвекции $i \ne j, k\ne h$.
            Имея записанное, проверить, что лемма говорит правду --- легко.

            (Ещё можно поумножать матрицы $3 \times 3$ или $4 \times 4$ --- тут ещё разбор случаев, когда какие индексы совпадают. Кайф)
        }
    }

    \subsection{Элементарные псевдоотражения}
    \definition[Элементарное псевдоотражение]{
        Матрица вида $d_i(\eps) = e + (\eps - 1)e_{i,i}$, где $i \ne j, \eps \in R^*$.
        Иными словами, матрица вида \[\ivect{\vspace{0.8em}\\i\\\vspace{2em}}{\hspace{0.6em} i \hspace{1.2em}}{1 & & & 0 \\ & \eps &  & \\ & &\ddots  & \\ 0 & & & 1}\]
    }

    \definition[Элементарные преобразования второго типа, или псевдоотражения]{
        Группа по умножению, порождённая элементарными псевдоотражениями.
    }
    \lemma[Мультипликативность псевдоотражений по $\eps$]{\label{multiplicity}
    $d_i(\eps)d_i(\theta) = d_i(\eps \theta)$.
    Иными словами, $d_i: R^* \map GL(n, R)$ --- гомоморфизм для любого $1 \le i \le n$.
    \provehere{
        Здесь есть всего один индекс, умножим матрицы $1 \times 1$: $\vect{\eps} \cdot \vect{\theta} = \vect{\eps\theta}$.
    }
    }
    \corollary{
        $d_i(\eps)^{-1} = d_i(\eps^{-1})$, откуда $d_i(\eps) \in GL(n, R)$.
    }
    \note{
        Псевдоотражения --- подгруппа обратимых элементов в диагональных матрицах \[\text{diag}(a_1, \dots, a_n) \bydef \vect{a_1 && 0 \\ &\ddots&\\0&&a_n}\]
        Так как умножаются диагональные матрицы покомпонентно, то справедливость~(\cref{multiplicity}) очевидна ещё и с другой стороны.
    }
    \lemma{
        $[d_i(\eps), d_j(\theta)] = \all{d_i([\eps, \theta]), & i = j \\ e,&i \ne j}$ --- в частности, псевдоотражения с разными индексами коммутируют, а с одинаковыми --- коммутируют, если коммутируют параметры.
    }
    \lemma{\label{some_useful_staff}
        $d_i(\eps)t_{j,k}(\xi)d_i(\eps)^{-1} = \all{t_{j,k}(\eps\xi),&i = j \\ t_{j,k}(\xi\eps^{-1}),&i = k \\ t_{j,k}(\xi),&\text{иначе}}$.
        \provehere{
            \down Если $i = j = 1 \land k = 2$, то \[\vect{\eps & 0 \\ 0 & 1} \cdot \vect{1 & \xi \\ 0 & 1} \cdot \vect{\eps^{-1} & 0 \\ 0 & 1} = \vect{\eps & 0 \\ 0 & 1} \cdot \vect{\eps^{-1} & \xi \\ 0 & 1} = \vect{1 & \eps \xi \\ 0 & 1}\]
            Если $i = k = 1 \land j = 2$, то \[\vect{\eps & 0 \\ 0 & 1} \cdot \vect{1 & 0 \\ \xi & 1} \cdot \vect{\eps^{-1} & 0 \\ 0 & 1} = \vect{\eps & 0 \\ 0 & 1} \cdot \vect{\eps^{-1} & 0 \\ \xi \eps^{-1} & 1} = \vect{1 & 0 \\ \xi \eps^{-1} & 1}\]
            Наконец, если $i \ne j, k$, то домножение на псевдоотражение справа домножит $i$-й столбец на $\eps^{-1}$, слева --- $i$-ю строчку на $\eps$, так как единственный ненулевой элемент в них --- 1 на пересечении, то $t_{j,k}(\xi)$ останется прежней.
        }
    }

    \subsection{Действия элементарных преобразований на матрицах}
    \lemma{
        Элементарная трансвекция действует на матрицу $x$ слева следующим образом: \[t_{h,k}(\xi) \cdot \vect{x_{1,*} \\ \vdots \\ x_{h,*} \\ \vdots \\ x_{n,*}} = \vect{x_{1,*} \\ \vdots \\ x_{h,*} + \xi x_{k,*} \\ \vdots \\ x_{n,*}}\]
    }
    \lemma{
        Элементарное псевдоотражение действует на матрицу $x$ слева следующим образом: \[d_{h}(\eps) \cdot \vect{x_{1,*} \\ \vdots \\ x_{h,*} \\ \vdots \\ x_{n,*}} = \vect{x_{1,*} \\ \vdots \\ \eps x_{h,*} \\ \vdots \\ x_{n,*}}\]
    }
    \lemma{
        Элементарная трансвекция действует на матрицу $x$ справа следующим образом: \[\vect{x_{*,1} & \dots & x_{*,h} & \dots & x_{*,n}} \cdot t_{h,k}(\xi) = \vect{x_{*,1} & \dots & x_{*,h} + x_{*,k} \xi & \dots & x_{*,n}}\]
    }
    \lemma{
        Элементарное псевдоотражение действует на матрицу $x$ справа следующим образом: \[\vect{x_{*,1} & \dots & x_{*,h} & \dots & x_{*,n}} \cdot d_{h}(\eps) = \vect{x_{*,1} & \dots & x_{*,h}\eps & \dots & x_{*,n}}\]
    }

    \definition[Элементарная подгруппа]{
        $E(n, R) \bydef \angles{t_{i,j}(\xi)|\xi \in R, 1 \le i \ne j \le n}\le GL(n, R)$ --- подгруппа в группе обратимых матриц, состоящая из трансвекций.
    }
    Используя $D(n, R)$ как подгруппу в $GL(n, R)$, состоящую из обратимых диагональных матриц, можно ввести определение:
    \definition[Полная элементарная подгруппа]{
        $GE(n, R) \bydef \angles{E(n, R), D(n, R)}\le GL(n, R)$ --- подгруппа в группе обратимых матриц, порождённая трансвекциями и псевдоотражениями.
    }
    \fact{
        $GE(n, R) = E(n, R) \cdot D(n, R)$.
        \provehere{
            Всякий элемент $g \in GE(n, R)$ по определению представим в виде $e_1 d_1 \dots e_m d_m$, где $e_i \in E(n, R), d_i \in D(n, R)$.
            Согласно~(\cref{some_useful_staff}) $d_i e_{i + 1}d_{i}^{-1} \in E(n, R)$, то есть можно постепенно перекидывать элементы из $E(n, R)$ в начало произведения.
        }
    }

    \newlection{15 февраля 2023 г.}
    Положим за $d_{i,j}(\eps) \bydef d_i(\eps)d_j(\eps^{-1})$, где $i \ne j, \eps \in R^*$.
    \theorem{
        $d_{i,j}(\eps)$ является произведением 4 элементарных трансвекций.
        \provehere{
            Будем двигаться назад: чтобы получить $\vect{1 & 0 \\ 0 & 1}$ из $\vect{\eps & 0 \\ 0 & \eps^{-1}}$, добавим
            \bullets{
                \item первую строчку ко второй с коэффициентом $\eps^{-1}$,
                \item вторую строчку к первой с коэффициентом $1 - \eps$,
                \item первую строчку ко второй с коэффициентом $-1$,
                \item вторую строчку к первой с коэффициентом $1 - \eps^{-1}$:
            }
            \[\vect{\eps & 0 \\ 0 & \eps^{-1}} \rightsquigarrow \vect{\eps & 0 \\ 1 & \eps^{-1}} \rightsquigarrow \vect{1 & \eps^{-1} - 1 \\ 1 & \eps^{-1}} \rightsquigarrow \vect{1 & \eps^{-1} - 1 \\ 0 & 1} \rightsquigarrow \vect{1 & 0 \\ 0 & 1}\]
            Таким образом, $\vect{\eps & 0 \\ 0 & \eps^{-1}} = \vect{1 & 0 \\ -\eps^{-1} & 1}\vect{1 & -1 + \eps \\ 0 & 1}\vect{1 & 0 \\ +1 & 1}\vect{1 & -1 + \eps^{-1} \\ 0 & 1}$.
            (Как было правильно замечено, в формуле порядок матриц пришлось развернуть, и прибавления строчек заменить на вычитания. Поэтому знаки в матрицах противоположны заявленным)
            В общем случае $d_{i,j}(\eps) = t_{i,j}(-\eps^{-1})t_{j,i}(-1 + \eps)t_{i,j}(1)t_{j,i}(-1 + \eps^{-1})$.
            Операции можно было совершать не над строками, а над столбцами: например, можно то же произведение транспозиций применить к $e$ не слева, а справа.
        }
    }


    \section{Матрицы перестановки}
    \definition[Мономиальная матрица $x$]{
        В каждой строке $x$ и каждом столбце $x$ единственный элемент, не равный 0 (причём он обратим).

        Множество мономиальных матриц обозначают $N(n, R)$, и это подгруппа в $GL(n, R)$.

    }
    \definition[Матрица перестановки]{
        Такая мономиальная матрица, что все её ненулевые элементы равны $1$.

        Множество всех матриц перестановки обозначают $W_n$, это тоже подгруппа $GL(n, R)$.
    }
    \definition[Означенная (signed) матрица перестановки]{
        Такая мономиальная матрица, что все её ненулевые элементы равны $\pm1$.
    }

    Матрица перестановки переставляет элементы базиса, изоморфны $S_n$, означенные матрицы перестановки переставляют означенный базис, изоморфны октаэдральной группе.
    \definition[Октаэдральная группа]{Положим $X \coloneqq \{-n, \dots, -1, 1, \dots, n\}$ ($|X| = 2n$). \[\Oct_n \bydef \defset{\pi \in S_{X}}{\pi(-i) = -\pi(i)} \le  S_X\]}

    Имеет место изоморфизм $S_n \cong W_n$, $\pi \mapsto (\pi), (\pi)_{i,j} = \delta_{i,\pi(j)}$.
    Можно проверить, что $(\pi)(\rho) = (\pi \cdot \rho)$.

    Так как перестановки порождаются транспозициями, то матрицы перестановки порождаются матрицами транспозиций $w_{i,j} = e - e_{i,i} -e_{j,j} + e_{i,j} + e_{j,i}$.

    Так определённые $w_{i,j}$ --- \emph{элементарные преобразования третьего вида}.

    \corollary{$W_n = \langle \defset{w_{i,j}}{i + 1 = j} \rangle$. Это абсолютный аналог утверждения, что симметрическая группа $S_n$ порождена фундаментальными транспозициями.}
    \lemma{Умножение на $w$ слева переставляет строки, справа --- переставляет столбцы.
    В частности, $w_{1,2}\cdot\vect{x_{1,*}\\x_{2,*}} = \vect{x_{2,*}\\x_{1,*}}$ и $\vect{x_{*,1}&x_{*,2}}\cdot w_{1,2}=\vect{x_{2,*} & x_{1,*}}$}
    Преобразования третьего типа выражаются через преобразования первого и второго типа:

    \definition{
        \[w_{i,j}(\eps) = t_{i,j}(\eps)t_{j,i}(-\eps^{-1})t_{i,j}(\eps) \in E(n, R)\]
        Проще говоря, матрица где все строчки и столбцы как у единичной матрицы $e$ кроме тех, что с номерами $i,j$: \[w_{i,j}(\eps)\bydef \underset{j}{\overset{i}{\phantom{{}^\cdot}}}\overset{\quad i \qquad j}{\vect{0 & \eps \\ -\eps^{-1} & 0}}\]
    }
    \lemma{
        $w_{i,j} = w_{i,j}(1) \cdot d_i(-1) = d_j(-1)w_{i,j}(1) \in GE(n, R)$
    }


    \section{Классификация линейных отображений над полем. Канонический вид линейного отображения}

    Модуль над полем (то есть векторное пространство) с точностью до изоморфизма определяется своей размерностью.
    А чем определяется (с точностью до изоморфизма, естественно) линейное отображение?

    \definition[Изоморфность линейных отображений $\phi: U \map V$ и $\psi: W \map Z$] {
        Существуют два изоморфизма $U \cong W$ и $V \cong Z$, такие, что диаграмма коммутативна.
        % https://q.uiver.app/#q=WzAsNCxbMCwwLCJVIl0sWzEsMCwiViJdLFswLDEsIlciXSxbMSwxLCJaIl0sWzAsMSwiXFxwaGkiXSxbMiwzLCJcXHBzaSJdLFsxLDMsIlxcY29uZyJdLFswLDIsIlxcY29uZyIsMl1d
        \[\begin{tikzcd}[ampersand replacement=\&]
              U \& V \\
              W \& Z
              \arrow["\phi", from=1-1, to=1-2]
              \arrow["\psi", from=2-1, to=2-2]
              \arrow["\cong", from=1-2, to=2-2]
              \arrow["\cong"', from=1-1, to=2-1]
        \end{tikzcd}\]
    }
    \definition[Ранг линейного отображения $\phi$]{
        Размерность образа: $\rk(\phi) \bydef \dim(\Image(\phi))$.
    }
    \theorem{\label{canonical}
        $(U, V, \phi) \cong (W, Z, \psi) \iff \all{\dim(U) = \dim(W) \\ \dim(V) = \dim(Z) \\ \rk(\phi) = \rk(\psi)}$.
        \provetwhen{
            Очевидно.
        }{
            Так как $\phi, \psi: U \map V$ --- линейные отображения, то можно считать, что они заданы, как домножения на матрицу.
            Получаем аналогичный вопрос: когда можно одну матрицу привести к другой при замене базиса в $U$ и замене базиса в $V$, то есть при домножении на \textbf{обратимые} матрицы слева и справа?

            \indent{\theorem{Для любого линейного отображения $\phi: U \map V$ можно так выбрать базисы в $U$ и в $V$, чтобы матрица отображения имела вид $\left(\arr{c|c}{e&0\\\hline 0 & 0}\right)$ --- \emph{окаймлённая} единичная матрица (здесь $e$ --- квадратная единичная матрица, 0 --- матрицы из нулей произвольного размера).}
            \provehere{
                Обозначим $n = \dim(U), m = \dim(V)$.
                \bullets{
                    \item Выберем базис $\Ker(\phi)$; $\dim(\Ker(\phi)) = n - r$. Обозначим этот базис $u_{r + 1}, \dots, u_n$.
                    \item Дополним до базиса $U: u_1, \dots, u_r$ --- относительный базис $U/\Ker(\phi)$.
                    \item Рассмотрим $\phi(u_1), \dots, \phi(u_r)$ --- базис $\Image(\phi)$.
                    \item Дополним этот базис до базиса $V$.

                    В данных базисах матрица линейного отображения --- действительно окаймлённая матрица.
                }
            }}
            Таким образом, всякое линейное отображение имеет лишь 3 инварианта --- параметры окаймлённой матрицы, а это и есть $\rk(\phi), \dim(U), \dim(V)$.
        }}


    \section{Комбинаторная эквивалентность матриц}
    Пусть $x \in M(m, n, K)$, где $K$ --- поле (рассуждения также можно обобщить до случая тела).

    К какому виду можно привести $x$ элементарными преобразованиями над строками?

    \theorem{
        Для любого $x \in M(m, n, K): \exists h \in GE(m, K): hx$ имеет специальный (\emph{строково-эшелонированный}) вид:
        \numbers{
            \item В каждой строке ведущий элемент (pivot) --- первый ненулевой элемент --- равен 1.
            \item В каждой следующей строке ведущий элемент правее, чем в предыдущей.
            \item Элементы над ведущими равны 0.
            \item Последние строки состоят из нулей.
        }
        \[\left(\arr{c c c c c c}{1 & * & 0&*&0&* \\  & & 1 & * &0&* \\ &&&\ddots&& \vdots\\ &&&&1&*\\\hline0 &&&\dots&&0\\&&&\vdots&&\\0 &&&\dots&&0}\right)\]
        \provehere{
            Рассмотрим наименьший номер ненулевого столбца $j: a_{*,j} \ne 0$.
            Перестановкой строк можно добиться того, что $a_{1,j} \ne 0$.
            Поделим строку $a_{1,*}$ на $a_{1,j}$, теперь первая строчка соответствует строково-эшелонированному виду.

            Вычитая эту строку из следующих с правильными коэффициентами получаем, что $a_{*,j} = \vect{1 \\ 0 \\ \vdots \\ 0}$.
            Кроме того, надо занулить коэффициенты выше, буде такие найдутся (они будут в последующих шагах индукции).
            Таким образом, дальше (к следующим строкам матрицы) можно применить индукцию --- она оборвётся либо когда закончатся строки, либо останутся только строки из нулей.
        }
    }
    \corollary[Комбинаторная эквивалентность]{\label{combinatorial_equivalence}
    Всякую матрицу преобразованиями над строками и перестановкой столбцов можно привести к следующему виду (\emph{ступенчатый вид}): \[\forall x \in M(m, n, K), \exists h \in GE(m, K), w \in W_n: hxw = \left(\arr{c|c}{e & * \\\hline 0 & 0}\right)\] где $e$ ---квадратная матрица некоего размера $r \times r$, а остальные блоки --- произвольного размера.
    }
    Таким образом, две матрицы \emph{комбинаторно эквивалентны}, если одна может быть получена из другой элементарными преобразованиями над строками и перестановкой столбцов, или, что аналогично, они обе могут быть приведены к одному ступенчатому виду.
    \newlection{21 февраля 2023 г.}

    \subsection{Элементарная эквивалентность матриц}
    В этом параграфе $K$ опять-таки поле.
    \theorem{
        $x \in M(m, n, K) \then \exists g \in GE(m, K), h \in GE(n, K): gxh = \left(\arr{c|c}{e & 0 \\\hline 0 & 0}\right)$ --- окаймлённая единичная матрица размера $r \times r$.
        \provehere{
            В предыдущем вопросе мы доказали, что можно подобрать такие $g, w: gxw$ --- окаймлённая единичная матрица, у которой справа сверху мусор.
            Этот мусор можно вынести, поочерёдно вычитая столбцы слева (в которых все элементы равны 0, кроме одного --- 1), домноженные на правильный коэффициент.
        }
    }
    Две матрицы \emph{элементарно эквивалентны}, если ни могут быть приведены к одному окаймлённому виду.

    Две матрицы $x, y\in M(m, n, K)$ \emph{строго элементарно эквивалентны}, если $\exists g \in E(m, K), h \in E(n, K): y = gxh$, то есть разрешены только элементарные трансвекции первого рода.
    \theorem{
        $x \in M(m, n, K) \then \exists g \in E(m, K), h \in E(n, K): gxh$ --- либо окаймлённая единичная матрица $r \times r$, либо $d_m(\eps)$ (в случае $m = n = r$):
        \[gxh = \left[\arr{c}{ \left(\arr{c|c}{e&0\\\hline0&0}\right) \vspace{5pt} \\  d_m(\eps)}\right.\]

        \note{Такой $\eps$ равен определителю (определителю Дьёдоне) матрицы $x$, $\det(x)$ (либо если матрица не строго эквивалентна псевдоотражению, то $\det(x) = 0$).
        К сожалению, такой способ определить определитель не обобщается даже на кольца (даже коммутативные).}
    }
    \provehere{
        Вспомним доказательство предыдущей теоремы о комбинаторной эквивалентности матриц, и применим к нему лемму о $d_i(\eps)d_j(\eps^{-1}) \in E(n, K)$.
        Таким образом можно всякий раз кроме последней строки применять эту лемму, и обойтись преобразованиями первого типа, чтобы выставить все, кроме быть может одной, единицы в главной диагонали.
    }
    \note{
        Всё вышеописанное применимо к телу. Для тела определитель Дьёдоне лежит в $\{0\} \cup T^*/[T^*, T^*]$.
    }

    \subsection{Ранг матрицы над полем. Различные определения ранга над кольцом}

    \subsubsection{Тензорный и скелетный ранги}
    Рассмотрим матрицу над полем $x \in M(m, n, K)$.

    Для коммутативного кольца $R$ определим
    \definition[Внешнее произведение, outer tensor]{
        Матрица $uv$, где $u \in \ind{}{R}{^m}, v \in \ind{^n}{R}{}$.
    }
    Внешнее произведение --- это матрица ранга 1.
    \definition[Ранг матрицы $x \in M(m, n, K)$]{
        Наименьшее $r$, такое что существуют $r$ матриц ранга 1, таких, что $x$ равен их сумме.
        Обозначают $rk(x)$, иногда для определённости называют \emph{тензорным} рангом.
    }
    \theorem{
        Ранг матрицы $x \in M(n, m, R)$ равен наименьшему числу $r$, такому, что $\exists y \in M(n, r, R)$ и $z \in M(r, m, R)$, такие, что \[x = yz\]
        Иногда такое $r$ называют \emph{скелетным} рангом, но скелетный ранг всегда равен тензорному рангу.
        \provetwhen{
            Если $x = u_1 v_1 + \dots + u_r v_r$, то \[x = \vect{u_1 & \dots & u_r}\cdot \vect{v_1 \\ \vdots \\ v_r}\]
        }{
            $x = yz = y e^2 z = (y(e_{1,1} + \dots + e_{r,r})) \cdot ((e_{1,1} + \dots + e_{r,r})z) = y_{*,1}z_{1,*} + \dots + y_{*,r}z_{r,*}$.
        }
    }

    \subsubsection{Строчный и столбцовый ранги}
    \definition[Строчный ранг матрицы, $\rrk(x)$] {
        Ранг модуля, порождённого строками $x$, если этот модуль \textbf{свободен.}
    }
    \definition[Столбцовый ранг матрицы, $\crk(x)$] {
        Ранг модуля, порождённого столбцами $x$, если этот модуль \textbf{свободен.}
    }
    \note{
        Строчный ранг и столбцовый не обязаны существовать.
        Для коммутативного кольца если оба существуют, то они равны.
        В таком случае их общее значение называют \emph{внешним} рангом, $\ork(x)$.
    }
    \intfact{
        Внешний ранг всегда не меньше тензорного ранга.
    }
    \theorem{
        Если $K$ --- поле, то тензорный ранг матрицы совпадает с её строчными и столбцовыми рангами, а ещё равен $r$ из теоремы о комбинаторной эквивалентности матриц~(\cref{combinatorial_equivalence}).
        \provehere{
            Переходя $x \rightsquigarrow gx$, где $g \in GE(m, K)$ --- элементарная матрица, мы переходим к пространству строк, содержащемуся в пространстве строк $x$.

            Так как $g$ обратимо, то пространства строк совпадают. Аналогично для столбцов, $\crk(x) = \crk(xh)$, и пространства столбцов совпадают.

            Заметим, что преобразований над строками достаточно, чтобы получить эшелонированную матрицу с единичным блоком $r \times r$, то есть $r$ линейно независимых строк.
            Применив далее преобразования над столбцами, приведём матрицу к каноническому виду --- окаймлённой единичной, причём ранг её будет тот же $r$.

            Если же аналогичные действия проделать сначала над столбцами, то получится столбцово-эшелонированная матрица с единичным блоком $\tilde{r} \times \tilde{r}$.
            Так как канонический вид матрицы единственен~(\cref{canonical}), то $r = \tilde{r}$.

            Отсюда получается, что $r = \crk(x) = \rrk(x) = \rk(x)$, где последнее --- ранг линейного отображения.
            Кроме того, отсюда вытекают факты, что строчный ранг не меняется при столбцовых преобразованиях, а столбцовый --- при строчных.
        }
    }
    \note{
        Без использования понятия о ранге линейного отображения можно так доказать то, что элементарные преобразования над строчками не меняют и столбцовый ранг тоже:
        если какое-то подмножество столбцов было линейно зависимо: $\lambda_1 u_1 + \dots + \lambda_s u_s = 0$, то и после применения элементарного преобразования эта комбинация осталась нулевой:
        \[\lambda_1 (u_1 g) + \dots + \lambda_s (u_s g) = 0\]
    }
    \definition[Ранг по минору, $\mrk(x)$]{
        Наибольший размер минора, имеющего ненулевой определитель.
    }
    \intfact{$\mrk(x) \le \rk(x)$.}
    \intfact[Теорема о базисном миноре]{
        Над полем $\mrk(x) = \rk(x)$.
    }

    \subsection{Системы линейных уравнений}
    Пусть мы всё ещё работаем над полем.

    Рассмотрим линейное отображение $\phi: K^n \map K^m$.
    Пусть $u \in K^m$.
    \definition[Система линейных уравнений]{
        Уравнение $\phi(x) = u$, где неизвестный $x \in K^n$.
    }
    Уравнение называется системой уравнений, потому что традиционно, выбрав базисы, можно записать $\phi(x) = ax$, где $a \in M(m, n, K)$, $u = \vect{u_1 \\ \vdots \\ u_m}$, и система уравнений приобретает вид $ax = u$.

    \emph{Но людям раньше нравилось много писать, поэтому они записывали}
    \[\all{a_{1,1}x_1 + \dots + a_{1,n}x_n = u_1 \\ a_{2,1}x_1 + \dots + a_{2,n}x_n = u_2 \\ \dots \\ a_{m,1}x_1 + \dots + a_{m,n}x_n = u_m}\]
    \newlection{22 февраля 2023 г.}
    \theorem{
        Если $x_0$ --- какое-то (\emph{частное}) решение уравнения $\phi(x) = u$, то множество всех решений --- это $x_0 + \Ker(\phi)$.
        \provehere{
            Любое (\emph{общее}) решение $x$ удовлетворяет $\phi(x) = u$, откуда $\phi(x - x_0) = 0$, и $x \in x_0 + \Ker(\phi)$.
        }
    }
    Система $\phi(x) = 0$ называется \emph{однородной}.

    Ядро, разумеется, является подпространством;\ при работе над полем оно свободно, то есть \[\Ker(\phi) = \langle v_1, \dots, v_d \rangle\]
    \fact{$d = n - r$.}
    Этот базис $v_1, \dots, v_d$ называется \emph{фундаментальной системой решений}.
    \corollary{Любое решение $x$ имеет вид $x_0 + v_1 \lambda_1 + \dots + v_d \lambda_d$.}

    \subsection{Векторная запись системы линейных уравнений. Теорема Кронекера --- Капелли}
    На самом деле теорема Кронекера --- Капелли --- очевидный факт, который Капелли, записывая, назвал \emph{теорема Кронекера}, что потом при ссылках преобразовалось в текущее название.

    \[a = \vect{a_{*,1} & \dots & a_{*,n}} \qquad x = \vect{x_1 \\ \vdots \\ x_n}\]

    \emph{Векторная запись системы линейных уравнений} $a_{*,1}x_1 + \dots + a_{*,n}x_n = u$.

    Является ли вектор $u$ линейной комбинацией векторов $a_{*,1}, \dots, a_{*,n}$?

    \theorem[Кронекер --- Капелли]{
        Ответ на этот вопрос известен: когда $u \in \langle a_{*,1}, \dots, a_{*,n}\rangle \iff \langle a_{*,1}, \dots, a_{*,n} \rangle = \langle a_{*,1}, \dots, a_{*,n}, u \rangle$.

        Иначе говоря, система $ax = u$ совместна $\iff$ $\rk(a) = \rk(a | u)$.
    }
    \fact[Дополнение к теореме Кронекера --- Капелли]{
        Система $ax = u$ имеет единственное решение $\iff$ $\rk(a) = \rk(a | u) = n$.
        \provehere{В этом случае $\dim \Ker(a) = \dim K^n - \dim \Image a = 0$ и ядро нулевое.}
    }

    \subsection{Решение систем линейных уравнений методом Гаусса}
    Гаусс, может, этим методом и не решал системы, ну да ладно.
    \[ax = u \qquad a \in M(m, n, K) \qquad x \in K^n \qquad u \in K^m\]
    Для любого $g \in GL(m, K) = GE(m, K)$ умножение на матрицу слева приводит к эквивалентной системе $gax = gu$.
    Также можно перенумеровать неизвестные:
    \[(gaw)(w^{-1}x) = gu, \qquad w \in W_n\]
    Раньше было доказано~(\cref{combinatorial_equivalence}), что можно подобрать такие $g \in GE(m, K), w \in W_n$, что $gaw$ имеет ступенчатый вид: $\vect{gaw|gu} = \left(\arr{c c | c}{e & * & *\\ 0 & 0  & \delta}\right), \delta \in \{0, 1\}^{m-r}$.
    Система совместна $\iff \delta = 0$.
    Таким образом, неизвестные разбились на 2 группы: \emph{главные} $x_1, \dots, x_r$ и \emph{свободные} $x_{r + 1}, \dots, x_n$.

    Систему можно переписать в виде
    \[\all{x_1 + \qquad c_{1,r + 1}x_{r + 1} + \dots + c_{1,n}x_{n} = d_1 \\ \dots \\ x_r + \qquad c_{r,r + 1}x_{r + 1} + \dots + c_{r,n}x_{n} = d_r}\]
        \[\vect{x_1 \\ \vdots \\ x_r} = \vect{d_1 \\ \vdots \\ d_r} - \vect{c_{1,r + 1} \\ \vdots \\ c_{r,r + 1}}x_{r + 1} - \dots - \vect{c_{1,n} \\ \vdots \\ c_{r,n}}x_{r + 1}\]
    В качестве частного решения можно взять решение при занулённых свободных переменных, а в качестве базиса ядра --- решения, принимая каждую свободную переменную по очереди единицей:
    \[\vect{d_1 - c_{1, r + 1}x_r - \dots - c_{1,n}x_n \\ \vdots \\ d_r - c_{r, r + 1}x_r - \dots - c_{r,n}x_n \\ \hline x_{r + 1} \\ \vdots \\ x_n} = \vect{d_1 \\ \vdots \\d_r \\ \hline 0 \\ \vdots \\ 0} + \vect{-c_{1,r+1} \\ \vdots \\-c_{r,r + 1} \\ \hline 1 \\ \vdots \\ 0}x_{r + 1} + \dots + \vect{-c_{1,n} \\ \vdots \\-c_{r,n} \\ \hline 0 \\ \vdots \\ 1}x_n\]

    \subsection{Определитель по Вейерштрассу}
    Пусть $x \in M(n, R)$ --- матрица над коммутативным кольцом.

    В определении по Вейерштрассу матрица фигурирует, как строка столбцов $x = (x_{*,1}, \dots, x_{*,n})$.
    \definition[Определитель по Вейерштрассу]{
        $\Det: \underbrace{R^n \times \dots \times R^n}_{n} \map R$ со следующими свойствами.
        \numbers{
            \item Полилинейность: $\Det$ линейно по каждому аргументу при фиксированных остальных.
            \item Антисимметричность: если два столбца совпали, то определитель --- нуль.
            \item Нормированность: $\Det(e_1, \dots, e_n) = \Det(e) = 1$.
        }
    }
    Существует ли такой определитель? (Да, например, определитель Лейбница~(\cref{leibnitz_determinant}))

    Единственен ли он? (Да:~(\cref{uniqueness_of_determinant}))

    \lemma{
        Определитель не меняется при элементарных преобразованиях над столбцами.
        \provehere{
            \begin{gather*}
                \Det(x \cdot t_{r,s}(\xi)) = \Det(x_{*,1}, \dots, x_{*,r}, \dots, x_{*,s} + x_{*,r}\xi, \dots, x_{*,n}) = \\
                \Det(x_{*,1}, \dots, x_{*,r}, \dots, x_{*,s}, \dots, x_{*,n}) + \underbrace{\Det(x_{*,1}, \dots, x_{*,r}, \dots, x_{*,r}, \dots, x_{*,n})}_{0}\xi
            \qedhere\end{gather*}
        }
    }
    \lemma[Кососимметричность определителя]{
        При перестановке двух столбцов местами определитель меняет знак.

        \provehere{
            Обозначим $F(u_r, u_s) \coloneqq \Det(u_1, \dots, \underset{r}{u_r}, \dots, \underset{s}{u_s}, \dots, u_n)$.

            В силу линейности определителя, $0 = F(u_r + u_s, u_r + u_s) = \underbrace{F(u_r, u_r)}_{0} + F(u_r, u_s) + F(u_s, u_r) + \underbrace{F(u_s, u_s)}_{0}$.
        }
        \note{
            Кососимметричность следует из антисимметричности, а обратное верно только если 2 --- не делитель 0 (и $2 \ne 0$).
        }
    }
    \lemma{
        Если один из столбцов является линейной комбинацией остальных, то определитель равен 0.
    }

    \subsection{Знак перестановки. Определение через декремент}
    \definition[Декремент]{
        Любая перестановка представима в виде произведения независимых циклов (включая тривиальные).
        \[\forall \pi \in S_n: \qquad \pi = \rho_1 \proddots \rho_m\]
    }
    \definition[Орбита перестановки]{
        Множество $\{k, \pi(k), \pi(\pi(k)), \dots\} = \defset{\pi^l(k)}{l \in \Z}$ Так как перестановка обратима (является биекцией), то любые две различные орбиты не пересекаются.
    }
    \note{
        Количество независимых циклов $\pi$ --- количество орбит $\pi$.
    }
    \definition[Декремент $\pi$]{
        $\decr(\pi) \bydef n - m$, где $\pi \in S_n$, а $m$ --- количество независимых циклов (или орбит) $\pi$.
    }
    Если $\{1, \dots, n\} = X_1 \sqcup \dots \sqcup X_m$, где $X_1, \dots, X_m$ --- орбиты перестановки, то декремент --- это сумма $\sum\limits_{i = 1}^{m}(|X_i| - 1)$.

    \definition[Знак перестановки]{$\sgn(\pi) = (-1)^{\decr(\pi)}$}
    \theorem{
        $\decr(\pi)$ --- наименьшее количество транспозиций, произведение которых в некотором порядке равно $\pi$.
        \provehere{
            Давайте следить за длиной конкретного разложения перестановки по системе образующих транспозиций.

            \underline{База:} $\decr(\id) = n - n = 0$.

            \underline{Переход:} Всякое применение транспозиции меняет декремент на 1 (если она меняет местами элементы одного цикла $\pi$, то декремент увеличивается, а если из разных --- то уменьшается).

            В самом деле, если элементы из одного цикла меняются местами, то цикл разлагается на 2: для $p < q: (i_p i_q)(i_1 i_2 \dots i_r) = (i_1\dots i_{p - 1} i_q \dots i_r) \cdot (i_p i_{p + 1} \dots i_{q - 1})$.

            Если же местами меняются элементы разных циклов, то это вычисление получается домножением равенства выше на $(i_p i_q)$ слева: $(i_1 i_2 \dots i_r) = (i_p i_q)(i_1\dots i_{p - 1} i_q \dots i_r) \cdot (i_p i_{p + 1} \dots i_{q - 1})$.
        % https://q.uiver.app/#q=WzAsMTUsWzAsMSwiXFxidWxsZXQiXSxbMCwwLCJcXGJ1bGxldCJdLFsxLDAsIlxcYnVsbGV0Il0sWzEsMSwiXFxidWxsZXQiXSxbMywwLCJcXGJ1bGxldCJdLFszLDEsIlxcYnVsbGV0Il0sWzAsMiwiXFxidWxsZXQiXSxbMSwyLCJcXGJ1bGxldCJdLFszLDIsIlxcYnVsbGV0Il0sWzMsMywiXFxidWxsZXQiXSxbMSwzLCJcXGJ1bGxldCJdLFswLDMsIlxcYnVsbGV0Il0sWzIsMCwiXFxidWxsZXQiXSxbMiwyLCJcXGJ1bGxldCJdLFsyLDFdLFswLDFdLFsxLDJdLFsyLDNdLFszLDBdLFs0LDVdLFs2LDddLFs4LDldLFs5LDEwXSxbMTAsMTFdLFsxMSw2XSxbMTIsNF0sWzUsMTJdLFszLDEyLCIiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFs3LDEzXSxbMTMsOF0sWzEwLDEzLCIiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFszLDcsIiIsMSx7InNob3J0ZW4iOnsic291cmNlIjoyMCwidGFyZ2V0IjoyMH0sImxldmVsIjoyLCJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJhcnJvd2hlYWQifX19XSxbMTQsMTMsIiIsMSx7InNob3J0ZW4iOnsic291cmNlIjoyMCwidGFyZ2V0IjoyMH0sImxldmVsIjoyLCJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJhcnJvd2hlYWQifX19XV0=
            \[\begin{tikzcd}[ampersand replacement=\&]
                  \bullet \& \bullet \& \bullet \& \bullet \\
                  \bullet \& \bullet \& {} \& \bullet \\
                  \bullet \& \bullet \& \bullet \& \bullet \\
                  \bullet \& \bullet \&\& \bullet
                  \arrow[from=2-1, to=1-1]
                  \arrow[from=1-1, to=1-2]
                  \arrow[from=1-2, to=2-2]
                  \arrow[from=2-2, to=2-1]
                  \arrow[from=1-4, to=2-4]
                  \arrow[from=3-1, to=3-2]
                  \arrow[from=3-4, to=4-4]
                  \arrow[from=4-4, to=4-2]
                  \arrow[from=4-2, to=4-1]
                  \arrow[from=4-1, to=3-1]
                  \arrow[from=1-3, to=1-4]
                  \arrow[from=2-4, to=1-3]
                  \arrow[dashed, no head, from=2-2, to=1-3]
                  \arrow[from=3-2, to=3-3]
                  \arrow[from=3-3, to=3-4]
                  \arrow[dashed, no head, from=4-2, to=3-3]
                  \arrow[shorten <=2pt, shorten >=2pt, Rightarrow, 2tail reversed, from=2-2, to=3-2]
                  \arrow[shorten <=2pt, shorten >=2pt, Rightarrow, 2tail reversed, from=2-3, to=3-3]
            \end{tikzcd}\]
        }
    }

    \subsection{Знак перестановки. Определение через инверсии}
    Воспользуемся тем, что $S_n = \langle (i j), i+1 = j\rangle$.
    \definition[$i < j$ образуют инверсию в перестановке $\pi \in S_n$] {
        $\pi_i > \pi_j$.
    }
    Обозначим за $\text{inv}(\pi)$ количество инверсий в перестановке $\pi$.
    \theorem{
        $\sgn(\pi) = (-1)^{\text{inv}(\pi)} = \prod\limits_{1 \le i < j \le n}\frac{\pi(i) - \pi(j)}{i - j}$.

        Ещё можно сказать, что количество инверсий равняется минимальному количеству фундаментальных транспозиций, произведение которых в некотором порядке даёт $\pi$.

        \provehere{Несложно проверить, что всякая фундаментальная транспозиция, после домножения на перестановку (неважно, слева или справа), меняет количество инверсий в ней на $\pm 1$.

        А именно, при домножении $\pi$ на транспозицию $(ij)$ слева происходит смена $\pi(i)$ и $\pi(j)$, пара индексов $i$ и $j$ либо перестаёт, либо начинает образовывать инверсию. Кроме того, все инверсии $i, k$ меняются на инверсии $j, k$ и наоборот, так как относительное положение индекса $k$ относительно $i$ или $j$ не поменялось (транспозиция фундаментальная, поэтому $|i - j| = 1$).

        При домножении $\pi$ на транспозицию $(xy)$ справа происходит смена $\pi(i)$ и $\pi(j)$ где $\pi(i) = x, \pi(j) = y$, пара индексов $i$ и $j$ либо перестаёт, либо начинает образовывать инверсию. Остальные инверсии остаются прежними, так как $|x - y| = 1$.
        }
    }
    Без доказательства существования знак ещё можно определить следующим образом:
    \theorem{
        Для $n \ge 2$ существуют ровно два гомоморфизма $\phi: S_n \map \{\pm 1\}$. Это тождественный 1 и $\sgn$.
        \provehere{
            $\{\pm 1\}$ --- абелева группа. Пусть $\pi \sim \sigma \in S_n \iff \phi(\pi) = \phi(\sigma)$.

            При сопряжении аргумента $\phi(\pi)$ не меняется: $\phi\left(\sigma\pi\sigma^{-1}\right) = \phi(\sigma)\phi(\pi)\phi(\sigma)^{-1} = \phi(\pi)$.

            Так как все транспозиции сопряжены, то $\phi(\tau) = \text{const}$ для всех транспозиций $\tau$.

            Если $\phi(\tau) = 1$, то гомоморфизм --- тождественная единица, иначе $\phi(\tau) = -1$, и $\phi \equiv \sgn$.
        }
    }

    \subsection{Знакопеременное определение определителя}
    Пусть $x \in M(n, R)$, где $R$ --- коммутативное кольцо.
    \definition[Определитель по Лейбницу]{\label{leibnitz_determinant}
        $\det(x) = \sum\limits_{\pi \in S_n}\sgn(\pi)\prod\limits_{j = 1}^{n}x_{j, \pi(j)}$.
    }
    \lemma[Общее правило знаков]{
        Слагаемое $x_{\pi(1),\rho(1)} \proddots x_{\pi(n),\rho(n)}$ входит в сумму со знаком $\sgn(\pi) \cdot \sgn(\rho)$.
        \provehere{
            В коммутативном кольце $x_{\pi(1),\rho(1)} \proddots x_{\pi(n),\rho(n)} = x_{1,\rho(\pi^{-1}(1))} \proddots x_{n,\rho(\pi^{-1}(n))}$.
        }
    }
    Свойства транспонирования:
    \numbers{
        \item $x^{tt} = x$
        \item $(x + y)^t = x^t + y^t$
        \item $(xy)^t = y^t \cdot x^t$.
    }
    Данному набору свойств удовлетворяет $(x^t)_{j,i} \bydef x_{i,j}$.
    Транспонирование ${}^t: M(n, R) \map M(n, R^o)$.
    \theorem{
        $\det(x^t) = \det(x)$.
        \provehere{
            Согласно правилу знаков $\det(x^t) = \sum\limits_{\pi \in S_n}\sgn(\pi)\prod\limits_{j = 1}^{n}x_{\pi(j), j} = \det(x)$.
        }
    }
    Для некоммутативного кольца $R$ это неверно:
    \example{
        Определим алгебру Вейля $W_1(K) = K\langle x, d\rangle/([d, x] = 1)$ --- алгебра над полем $K$, где $d, x$ не коммутируют, и взят фактор по отношению $[d, x] = 1$.
        Алгебра дифференциальных операторов некоммутативна.

        Говорят, в квантовой механике активно используется $W_n(K)$.

        Если посчитать $\text{row det}\vect{d & d \\ x & x} = dx - xd = 1$.

        В другую сторону: $\text{col det}\vect{d & d \\ x & x} = dx - dx = 0$.

        В самом деле, столбцы линейно зависимы, а строки --- нет.
    }
    \newlection{1 марта 2023 г.}

    \subsection{Существование определителя (удовлетворяющего условиям Вейерштрасса)}
    \theorem{
        Определитель по Лейбницу удовлетворяет условиям Вейерштрасса
        \provebullets{
            \item Линейность по столбцам.
            Пусть $x_{*,r} = u + v$.
            Тогда \[\det(x) = \sum\limits_{\pi \in S_n}\sgn(\pi)x_{\pi(1), 1} \proddots \underset{\overset{\veq}{(u + v)_{\pi(r)}}}{x_{\pi(r), r}} \proddots x_{\pi(n), n}\]
            В силу дистрибутивности кольца можно раскрыть скобки ($a(b + c)d = (ab + ac)d = abd + acd$): \[\det(x) = \sum\limits_{\pi \in S_n}\sgn(\pi)x_{\pi(1), 1} \proddots u_{\pi(r)} \proddots x_{\pi(n), n} + \sum\limits_{\pi \in S_n}\sgn(\pi)x_{\pi(1), 1} \proddots v_{\pi(r)} \proddots x_{\pi(n), n}\]
            Аналогично можно выносить константу, домноженную на произвольный столбец.
            \item Если два столбца, пусть $x_{*,r}$ и $x_{*,s}$, совпадают, то определитель равен 0:
            \[\det(x) = \sum\limits_{\pi \in A_n}x_{\pi(1), 1} \proddots x_{\pi(r), r} \proddots x_{\pi(s), s} \proddots x_{\pi(n), n} - \underset{\overset{\veq}{\quad S_n \sm A_n}}{\sum\limits_{\pi \in (r s) \cdot A_n}}x_{\pi(1), 1} \proddots x_{\pi(r), r} \proddots x_{\pi(s), s} \proddots x_{\pi(n), n}\]
            В силу равенства столбцов $x_{*,r}$ и $x_{*,s}$ в левой сумме все слагаемые совпадают со слагаемыми в правой сумме.
            \item Нормированность определителя: $\det(e) = 1$. Несложно видеть даже большее: определитель треугольной матрицы равен произведению диагональных элементов
            \[\det\vect{a_1 &  &* \\ & \ddots &  \\ 0 &  & a_n} = a_1 \proddots a_n\]
        }
    }

    \subsection{Единственность определителя (удовлетворяющего условиям Вейерштрасса)}
    \theorem{\label{uniqueness_of_determinant}
    Никакое другое отображение, кроме определителя Лейбница, не удовлетворяет условиям определителя Вейерштрасса.
    \provehere{
        Всякий столбец раскладывается по столбцовому базису $\{e_i\}_{i = 1..n}$: \[u_j = e_1 x_{1, j} + \dots + e_n x_{n, j}\]
        Рассмотрим произвольный определитель Вейерштрасса $\Det$, и разложим его аргументы по столбцовому базису:
        \begin{gather*}
            \Det(u_1, \dots, u_n) = \Det((e_1 x_{1,1} + \dots + e_n x_{1,n}), \dots, (e_1 x_{1, n} + \dots + e_n x_{n,n})) =\\
            = \sum\limits_{i_1, \dots, i_n = 1}^{n}\Det(e_{i_1}, \dots, e_{i_n})\cdot x_{i_1,1} \proddots x_{i_n, n} = \\
            = \sum\limits_{\pi \in S_n}\Det(e_{\pi(1)}, \dots, e_{\pi(n)})\cdot x_{\pi(1),1} \proddots x_{\pi(n), n}
        \end{gather*}
        Таким образом, мы видим, что получили определение определителя по Лейбницу.
        В самом деле, $\Det(e_{\pi(1)}, \dots, e_{\pi(n)})$ равен знаку перестановки, так как из антисимметричности следует кососимметричность, и $\Det(e_{\pi(1)}, \dots, e_{\pi(n)})$ равен с точностью до знака $\det(e)$, а знак определителя --- чётность декремента $\pi$.
    }
    }


    \section{Мультипликативность определителя}
    \[\det(xy) = \det(x)\det(y)\]

    \subsection{Блочные матрицы}
    Рассмотрим матрицу из $M(m, n, R)$.

    Пусть $\mu = (m_1, \dots, m_r)$ --- разбиение числа $m$, то есть $m_1 + \dots + m_r = m$, и $\nu = (n_1, \dots, n_s)$ --- разбиение $n$.

    Разобьём элементы матрицы в соответствии с разбиением:
    \[\begin{array}{c}
          \overset{m_1}{} \\ \\ \vdots \\\underset{m_r}{}
    \end{array}\overset{\quad n_1 \quad \dots\qquad n_s}{\left(
    \begin{array}{c c|cc c| c}
        & & & & & \\
        & & & & & \\
        \hline
        & & & & & \\
        & & & & & \\
        \hline
        & & & & & \\
    \end{array}
    \right)}\]
    Подматрицу $x^{i,j} \in M(m_i, n_j, R)$ называют \emph{блок матрицы} $x$ в позиции $(i, j)$ для $i \in [1, r], j \in [1, s]$.

    \subsubsection{Операции над блочными матрицами}
    \numbers{
        \item Сложение.

        Рассмотрим две матрицы $x, y$ с одинаковым разбиением на блоки.

        Тогда сумма определяется поблочно $(x + y)^{i,j} = x^{i,j} + y^{i,j}$.
        \item Умножение.
        Пусть $x \in M(l, m, R), y \in M(m, n, r), \lambda = (l_1, \dots, l_q)$ --- разбиение $l$.

        Рассмотрим $(\lambda, \mu)$ разбиение $x$ и $(\mu, \nu)$ разбиение $y$.

        Тогда произведение определяется поблочно: \[(x \cdot y)^{i,k} = \sum\limits_{j = 1}^{r}x^{i,j}\cdot y^{j,k}\]
    }
    Важнейший частный случай --- разбиения на равные слагаемые.
    Так, квадратную матрицу из $M(m \cdot n, R)$ можно разбить на $m \times m$ блоков размера $n \times n$: $M(m \cdot n, R) = M(m, M(n, R))$.

    \subsection{Определитель блочно треугольной матрицы}
    \theorem{
        Рассмотрим матрицу $x = \vect{\begin{array}{c | c}
                                          y & * \\\hline 0 & z
        \end{array}} \in M(n, R)$. Для определённости можно положить $y \in M(m, R), z \in M(n - m, R)$.

        Утверждается, что $\det(x) = \det(y) \det(z)$.
        \provehere{
            Определим подгруппы Юнга в $S_n$.
            Пусть $\mu = (m_1, \dots, m_r)$ --- разбиение $m$.
            Тогда $\pi$ лежит в подгруппе Юнга, соответствующей разбиению $\mu$, если $\forall k = 1..r: \pi(i) \in m_k \iff i \in m_k$.
            Здесь запись $i \in m_k$ означает, что $\sum\limits_{j = 1}^{k - 1}m_j < i \le \sum\limits_{j = 1}^{k}m_j$.

            Иными словами, подгруппы Юнга не перемешивают элементы вне разбиения.

            Такая подгруппа Юнга изоморфна $S_{m_1} \times \dots \times S_{m_k}$.

            Для удобства будем рассматривать подгруппы Юнга размера 2: для разбиения $n = (m, n - m)$.
            Здесь определение упрощается до $i \le m \iff \pi(i) \le m$.
            \ok
            Итак, посчитаем определитель $x$. Заметим, что в формуле
            \[\sum\limits_{\pi \in S_n}\sgn(\pi)x_{1, \pi(1)} \proddots x_{n, \pi(n)}\]
            суммирование можно проводить только по перестановкам из подгруппы Юнга для $(m, n - m)$.

            В самом деле, по принципу Дирихле, если какая-то из первых $m$ строчек попала не в первый из $m$ столбцов, то тогда какой-то из них остался свободен, и в него попадёт что-то из следующих строчек, то есть конкретное произведение даст 0.
        В соответствии с этим, будем суммировать по не $\pi \in S_n$, а по $(\rho, \sigma) \in S_m \times S_{n - m}$.
            \[\sum\limits_{(\rho, \sigma) \in S_m \times S_{n - m}}\sgn(\rho)x_{1, \rho(1)} \proddots x_{m, \rho(m)} \cdot \sgn(\sigma)x_{m + 1, m + \sigma(1)} \proddots x_{m + (n - m), m + \sigma(n - m)} = \det(y)\det(z)\qedhere\]
        }
    }
    \corollary{
        Для любого квадратного разбиения матрицы на блоки ($r = s$), такого, что элементы ниже главной диагонали --- нуль-матрицы, определитель равен произведению блочных подматриц на главной диагонали.
    }

    \subsection{Мультипликативность определителя}
    Пусть $x, y \in M(n, R)$.
    \theorem{
        $\det(xy) = \det(x) \det(y)$
        \provehere{
            Рассмотрим блочную матрицу $\vect{y & e \\ 0 & x}$, и домножим её слева на $\vect{e & 0 \\ -x & e}$ (это трансвекция, прибавляющая ко второй строчке первую, домноженную на $-x$):
            \[\vect{e & 0 \\ -x & e} \cdot \vect{y & e \\ 0 & x} = \vect{y & e \\ -xy & 0}\]
            Так как это элементарное преобразование, то определитель не поменялся.
            Сделаем ещё пару пассов руками:
            \[\vect{y & e \\ -xy & 0}\cdot\vect{0 & -e \\ e & 0} = \vect{e & -y \\ 0 & xy}\]
            Это тоже произведение парочки элементарных преобразований первого типа, значит, $\det(y)\det(x) = \det(xy)$, и из коммутативности кольца $R$, в котором мы считаем определитель, доказательство завершено.
        }
    }
    \newlection{7 марта 2023 г.}

    \subsection{Миноры, разложение по строке, определитель по Лапласу}
    $R$ --- коммутативное кольцо, $x \in M(m, n, R)$.
    Выберем $I \subset \underline{m} = \{1, \dots, m\}; \quad J \subset \underline{n} = \{1, \dots, n\}$ так, что $|I| = |J| = d$.
    Рассмотрим сужение матрицы $x$ на $I \times J$, как матрицу из $M(d, R)$.
    \definition[Минор $M_{I,J}(x)$]{
        Определитель матрицы $(x_{i,j})_{i \in I, j \in J}$.
    }
    Если же $m - |I| = n - |J|$, то $\det (x_{i,j})_{i \notin I, j \notin J}$ --- \emph{дополнительный минор}, обозначается $\overline{M}_{I,J}$.

    Особенно важен случай $m = n$.
    Здесь определён дополнительный минор \[\overline{M}_{i,j} = \det\vect{\text{вычеркнули из $x$ строку $i$ и столбец $j$}}\]

    \definition[Алгебраическое дополнение к элементу $x_{i,j}$] {
        $A_{i,j}(x) \bydef (-1)^{i + j}\overline{M}_{i,j}(x)$.
        Можно также сказать, что это определитель матрицы, где $x_{*,j}$ и $x_{i,*}$ заменили на нули, но $x_{i,j}$ --- на единицу.
    }

    \theorem[Разложение по строке]{ Для матрицы $x \in M(n, R)$:
        \[\forall i_1, i_2 \in [1, n]: \quad \sum\limits_{j = 1}^{n}x_{i_1, j}A_{i_2, j} = \all{\det(x), &i_1 = i_2 \\ 0,& i_1 \ne i_2}\]
        \provehere{
            Рассмотрим $i_1$-ю строку матрицы $x$. Разложим её по строчному базису $x_{i_1,*} = x_{i_1,1}f_1 + \dots + x_{i_1,n}f_n$.

            Разложим определитель в сумму $n$ слагаемых, где $i_1$-я строка разложена по строчному базису.

            Дальше мы можем переставлять строчки по одной, получив форму разложения по строке для $i_1 = i_2$.

            Если же $i_1 \ne i_2$, то мы посчитали определитель матрицы, у которой на место строки $i_2$ поставили строку $i_1$, то есть определитель матрицы с равными строками --- 0.
        }
    }
    \definition[Определитель по Лапласу (индуктивно)]{
        $\det (x) = x_{1,1}A_{1,1}(x) + \dots + x_{1,n}A_{1,n}(x)$.
    }
    \note{
        Вместо строк можно раскладывать по столбцам.
    }
    \intfact[Лаплас]{
        Можно раскладывать не по одной строке, а по нескольким (по $k$ строкам).
        Минор определяется выбором $k$ столбцов.
        \[\det(x) = \sum\limits_{1 \le j_1 < \dots j_k \le n}(-1)^{i_1 + \dots + i_k + j_1 + \dots + j_k}M_{\{i_1, \dots, i_k\}\times \{j_1, \dots, j_k\}} \cdot \overline{M}_{\{i_1, \dots, i_k\}\times \{j_1, \dots, j_k\}}\]
    }

    \subsection{Формула Крамера, теорема Крамера}
    Формула Крамера получает по матрице ей обратную.

    Пусть $x \in M(n, R)$.
    Когда $x$ обратима?

    \definition[Присоединённая матрица]{
        $\adj(x) \bydef \left(A_{i,j}(x)\right)_{1 \le i, j \le n}^t = \left(A_{j,i}(x)\right)_{1 \le i, j \le n}$
    }
    \lemma{
        $x \cdot \adj(x) = \adj(x) \cdot x = \det(x) \cdot e$.
        \provehere{
            Раскрыть произведение матриц в сумму и применить теорему Лапласа.
        }
    }
    \theorem[формула Крамера]{
        Матрица $g$ обратима, если и только если $\det(g) \in R^*$.
        Если $\det(g) \in R^*$, то $g^{-1} = \frac{1}{\det(g)}\adj(g)$.
        \provehere{
            Если $g$ обратима, то $\exists g^{-1} \in M(n, R)$, откуда $1 = \det(e) = \det(g g^{-1}) = \det(g) \cdot \det\left(g^{-1}\right)$, получается, $\det(g)$ обратим.

            Если $\det(g) \in R^*$, то $\exists g^{-1} = \frac{1}{\det(g)}\adj(g)$.
        }
    }
    \theorem[Крамер]{
        В поле $K$ система $ax = u$ ($a \in M(n, K), u \in K^n$) имеет единственное решение $\iff \det(a) \ne 0$.
        Если $\det(a) \ne 0$, то это решение задаётся формулой $x = a^{-1}u$.
        \provehere{
            Если $\det(a) \ne 0$, то условия эквивалентны: $ax = u \iff x = a^{-1}u$.

            Если в поле $\det(a) = 0$, то $\rk(a) < n$.
            Тогда либо $\rk(a | u) = \rk(a)$, откуда по теореме Кронекера --- Капелли $ax = u$ совместна, но не определена, либо $\rk(a | u) > \rk(a)$, откуда система несовместна.
        }
    }


    \section{Определители некоторых матриц}
    Даны $n$ функций $f_1, \dots, f_n: R \map R$ и $n$ аргументов $x_1, \dots, x_n$.

    Чаще всего полезны определители вида $\det\vect{f_1(x_1) & \dots & f_n(x_1) \\ \vdots & \ddots & \vdots \\ f_1(x_n) & \dots & f_n(x_n))}$ --- \emph{альтернанты}.

    Иногда также случаются определители вида $\det\vect{f(x_1, x_1) & \dots & f(x_1, x_n) \\ \vdots & \ddots & \vdots \\ f(x_n, x_1) & \dots & f(x_n, x_n))}$

    \subsection{Определитель Вандермонда}
    \definition[Матрица Вандермонда]{
        Альтернант для $f_i: x \mapsto x^{i - 1}$\[V(x_1, \dots, x_n) = \vect{1 & x_1 & \dots & x_1^{n - 1} \\ \vdots & \vdots & \ddots & \vdots \\ 1 & x_n & \dots & x_n^{n - 1}}\]
    }
    \theorem{
        $\det(V(x_1, \dots, x_n)) = \prod\limits_{i > j}(x_i - x_j)$.
        \provebullets{
            \item $\det(V(x_1, \dots, x_n))$ --- многочлен от переменных $x_1, \dots, x_n$.
            \item Его степень $0 + 1 + \dots + (n - 1) = \frac{n(n - 1)}{2}$.
            \item Профакторизуем по отношению $(x_i - x_j)$, отображая кольцо многочленов от $n$ переменных в кольцо многочленов от $n - 1$ переменных.
            Строчки $x_{i,*}$ и $x_{j,*}$ стали равны, значит, $(x_i - x_j) \divs \det(V(x_1, \dots, x_n))$.
            \item Все многочлены вида $x_i - x_j$ для $i > j$ взаимно просты, значит, $\prod\limits_{i > j}(x_i - x_j) \divs \det(V(x_1, \dots, x_n))$.
            Степень произведения тоже равна $\frac{n(n - 1)}{2}$.
            \item Проверим, что константа ассоциированности между ними равна 1.
            Рассмотрим диагональное произведение $1 \cdot x_2 \cdot x_3^2 \cdots x_n^{n - 1}$. Входит в оба выражения со знаком +1.
        }
    }

    \subsection{Пфаффианы}
    Пусть $x \in M(n, K)$.
    \definition[Кососимметричная матрица]{
        Матрица $x$, такая, что $x^t = -x$.
    }
    \definition[Антисимметричная матрица]{
        Кососимметричная матрица $x$, такая, что $\forall i \in [1, n]: x_{i,i} = 0$.
    }
    \example{
        \[\vect{0 & x \\ -x & 0}\]
    }
    \intfact{
        Пусть $x \in M(n, R)$ --- антисимметричная матрица.
        Если $n \equiv 1 \pmod{2}$, то $\det(x) = 0$.
        Иначе $n \equiv 0 \pmod{2}$, тогда $\det(x) \in R^2$.
    }
    \note{
        Пфаффиан можно определить с точностью до знака, как корень из определителя.
    }
    \definition[Пфаффиан]{
        $\pf(x)$ определён для антисимметричных матриц и удовлетворяет следующим свойствам:
        \numbers{
            \item $\pf(y\cdot x\cdot y^t) = \pf(x) \cdot \det(y)$
            \item $\pf(x \oplus y) = \pf(x) \cdot \pf(y)$, где $x \oplus y = \vect{x & 0 \\ 0 & y}$.
            \item $\pf\vect{0 & 1 \\ -1 & 0} = +1$.
        }
    }
    \intfact{
        $\det(x) = \pf\vect{0 & x \\ -x^t & 0}$.
    }
    \intfact{
        Если $x$ --- порядка $2n$, то \[\pf(x) = \sum\limits_{\pi \in S_{2n}}\sgn(\pi) x_{\pi(1),\pi(2)}\proddots x_{\pi(2n - 1), \pi(2n)}\]
        где сумма берётся по всем таким $\pi$, что $\pi(2i - 1) < \pi(2i)$.
    }


    \chapter{Многочлены}
    \newlection{14 марта 2023 г.}
    В доказательстве вычисления определителя Вандермонда были два пробела, надо бы их восполнить~(\cref{Bezout_theorem}).


    \section{Гомоморфизм эвалюации}
    Говоря простыми словами, подстановка элемента алгебры в многочлен.

    Пусть $R$ --- \textbf{коммутативное} кольцо.
    \definition[$A$ --- алгебра над $R$]{
        Кольцо $A$ (часто ассоциативное, с $1_A$), необязательно коммутативное, являющееся $R$-модулем, а ещё $\forall x, y \in A, \lambda \in R$:
        выполняется аксиома алгебры \[\lambda (xy) = (\lambda x) y = x (\lambda y)\]
    }
    Несложно заметить вложение $R \hookrightarrow A; \quad \lambda \mapsto \lambda \cdot 1_A$.
    Оно вкладывает $R$ в центр $A$: ${R \cdot 1_A \le \Cent(A)}$.
    \note{
        Некоммутативность алгебры позднее будет крайне существенной, так как мы будем рассматривать $A = M(m, R) = \End_R(V)$.
    }
    \example{
        Рассмотрим цепочку вложений $\R \le \C \le \H$.
        $\C$ и $\H$ --- алгебры над $\R$, но $\H$ --- \textbf{не} $\C$-алгебра, $i \cdot j \ne j \cdot i$.
    }
    Пусть $f \in R[x]$, обозначим $f = a_n x^n + \dots +a_1 x + a_0$.
    \definition[Значение $f$ в точке $c \in A$]{
        Обозначим $f(c) = a_n c^n + \dots + a_1 c + a_0 \cdot 1_A$.
    }
    \note{
        Интересно заметить, что мы пользовались более слабым условием, чем ассоциативность $A$: мы пользовались тем, что $A$ --- алгебра с ассоциативными степенями:
        \[c^{i + j} = c^i \cdot c^j,\quad \text{что не зависит от разложения $i + j$ в сумму}\]
    }
    Зафиксируем $f \in R[x]$.
    \definition[Полиномиальное отображение]{
        \[\tilde{f}: A \map A \quad c \mapsto f(c)\]
    }
    Зафиксируем $c \in A$.
    \definition[Гомоморфизм эвалюации]{
        \[\ev_c: R[x] \map A \quad f \mapsto f(c)\]
    }
    \proposal{
        Гомоморфизм эвалюации --- гомоморфизм, то есть $(f + g)(c) = f(c) + g(c)$ и $(f \cdot g)(c) = f(c) \cdot g(c)$.
    }
    \note{
        Коммутативность $R$ действительно важна:
        \begin{gather*}
            c^2 - ac - bc + ab = \ev_c(x^2 - (a + b)x + ab) = \\ =\ev_c((x - a)(x - b)) = \\= \ev_c(x - a)\cdot \ev_c(x - b) = (c - a)(c - b) = c^2 - ac - cb + ab
        \end{gather*}
        Видим, что равенство выполняется, если и только если $c$ коммутирует с $b$, где $c \in A, b \in R$ --- любые элементы.
    }
    \definition[Гомоморфизм $R$-алгебр]{
        Отображение $\phi: A \map B$, такое, что $\forall x, y \in A, \lambda \in R$:
        \numbers{
        \item $\phi(x \cdot y) = \phi(x) \cdot \phi(y)$.
        \item $\phi(x + y) = \phi(x) + \phi(y)$.
            $\smash{\left.\rule{0pt}{.5\dimexpr3\baselineskip+2\itemsep+2\parskip}\right\}
            \text{Унитальный гомоморфизм колец}}$
        \item $\phi(1_A) = 1_B$.
        \item $\phi(\lambda x) = \lambda \phi(x)$.
        }
    }
    Пусть $\{*\}$ --- произвольное одноэлементное множество, \emph{синглетон}.
    % https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXHsqXFx9Il0sWzIsMCwiUlt4XSJdLFsxLDEsIkEiXSxbMSwyLCJcXGV2X2MiXSxbMCwyLCIqIFxcbWFwc3RvIGMiLDJdLFswLDEsIiogXFxtYXBzdG8geCJdXQ==
    \[\begin{tikzcd}[ampersand replacement=\&]
    {\{*\}} \&\& {R[x]} \\
    \& A
    \arrow["{\ev_c}", from=1-3, to=2-2]
    \arrow["{* \mapsto c}"', from=1-1, to=2-2]
    \arrow["{* \mapsto x}", from=1-1, to=1-3]
    \end{tikzcd}\]

    \theorem{
        Кольцо многочленов $R[x]$ обладает \textbf{универсальным свойством}: существует и единственен гомоморфизм $R$-алгебр $R[x] \map A$, делающий диаграмму выше коммутативной.

        Это гомоморфизм эвалюации $\ev_c$.
        \provehere{Существование уже доказано, единственность следует из определения гомоморфизма алгебр.}
    }
    Эту теорему можно принять за определение кольца многочленов от одной переменной: кольцо многочленов --- такая $R$-алгебра, что, вложив $R$ в произвольную $R$-алгебру $A$, останется ровно один способ ввести гомоморфизм из кольца многочленов в алгебру.

    Тем не менее, это не совсем правда --- само кольцо $R$, разумеется, является $R$-алгеброй с данным свойством. Точной формулировки я не нашёл.

    \section{Число корней многочлена над областью целостности}
    Пусть $f \in R[x]$, где $R$ --- область целостности.
    \definition[Корень / нуль $f$]{
        Такой элемент $c \in R$, что $f(c) = 0$.
    }
    \definition[Кратность корня $c$ многочлена $f$] {
        Число $m \in \N_0$, такое, что $(x - c)^m \| f$.
    }
    \theorem[Безу]{\label{Bezout_theorem}
        $f(c)$ --- остаток от деления $f$ на $x - c$. \[f = (x - c)g + f(c) \qquad \then \qquad f(c) = 0 \iff x - c \divs f\]
    }
    \corollary{
        $c$ --- корень $f$ кратности $m$ $\iff f = (x - c)^m g$, где $g(c) \ne 0$.
    }
    \corollary[Обобщённая теорема Безу]{
        Для $R$, являющейся областью целостности:

        Пусть $c_1, \dots, c_s$ --- различные корни $f$ кратностей $m_1, \dots, m_s$ соответственно.
        Тогда $f = (x - c_1)^{m_1} \proddots (x - c_s)^{m_s} \cdot g$, где $g(c_1), \dots, g(c_s) \ne 0$.
        \provehere{
            Индукция по количеству различных корней, использующая при переходе теорему Безу.
        }
    }
    \corollary{
        У любого многочлена $f \in R[x]$, где $R$ --- область целостности --- количество корней с учётом кратности не превосходит $n$.
    }
    \counterexamples[Существенность области целостности]{
        \item $x^2 - 5x \in (\Z / 6\Z)[x]$ имеет корни $\overline{0}, \overline{2}, \overline{3}, \overline{5}$.
        \item В булевом кольце $R = (2^X, \triangle, \cap)$ все элементы --- идемпотенты, все --- корни $x^2 - x$.
        \item $R = M(2, R)$. У многочлена $x^2$ есть корень 0 кратности $2$, есть корень $\vect{0 & 1 \\ 0 & 0}$.
        \item $R = \H$ --- над телом кватернионов у многочлена $x^2 + 1$ даже не 6 корней ($\pm i, \pm j, \pm k$), а целая сфера, континуум корней.
        Здесь проблема не в делителях нуля, а в отсутствии коммутативности.
    }


    \section{Формальное и функциональное равенство многочленов}
    Пусть $f, g \in R[x]$.
    \emph{Формальное равенство} многочленов $f = g$ --- равенство всех коэффициентов --- равенство элементов кольца многочленов.

    Всякий многочлен определяет полиномиальную функцию вычисления значения.

    \definition[Функциональное равенство многочленов]{
        $\tilde{f} = \tilde{f} \overset{def}\iff \forall c \in R: f(c) = g(c)$.
    }
    \theorem{
        Для бесконечной области целостности $R$: \[f = g \iff \tilde{f} = \tilde{g}\]
        \provetwhen{
            Очевидно.
        } {
            Если $\max(\deg f, \deg g) \le n$, и $c_0, \dots, c_n \in R$ --- попарно различные точки, то равенство $\forall i: f(c_i) = g(c_i)$ влечёт равенство $f = g$.

            В самом деле, разность $f - g$ имеет степень не больше $\max(\deg f, \deg g)$, и обнуляется в $n + 1$ точке.
        }
    }


    \section{Задача интерполяции с простыми узлами}
    Пусть $K$ --- поле, $c_0, \dots, c_n \in K$ --- попарно различные элементы, $b_0, \dots, b_n \in K$ --- произвольные элементы.
    \theorem[Задача Лагранжа]{
        Существует и единственен многочлен степени не выше $n + 1$, решающий интерполяционную задачу с простыми узлами.
        \[\begin{array}{c | c c c c}
              x & c_0 & c_1 & \dots & c_n \\\hline f(x) & b_0 & b_1 & \dots & b_n
        \end{array}\]
        \provehere[Доказательство Ньютона --- Грегори]{
            Индукция по $n$.
        }
        \provehere[Доказательство Вандермонда]{
            Запишем систему уравнений относительно $a_0, \dots, a_n$.
            \begin{gather*}f(c_0) = a_n c_0^n + \dots + a_1 c_0 + a_0 = b_0 \\ \dots \\ f(c_n) = a_n c^n + \dots + a_1 c_n + a_0 = b_n\end{gather*}
            Заметим, что так как все $c_i$ различны, то определитель матрицы данной системы --- определитель Вандермонда $V(c_0, \dots, c_n)$.

            $\prod\limits_{i > j}(c_i - c_j) \ne 0 \then$ система имеет единственное решение.
        }
        \provehere{
            Решим задачу попроще:
            \[\begin{array}{c | c c c c c}
                  x & c_0 & \dots & c_i & \dots & c_n \\\hline f(x) & 0 & \dots & 1 & \dots & 0
            \end{array}\]
            Её решением будет многочлен \[f_i = \frac{(x - c_0) \proddots \hat{(x - c_i)} \proddots (x - c_n)}{(c_i - c_0) \proddots \hat{(c_i - c_i)} \proddots (c_i - c_n)}\]

            Теперь можно просто взять линейную комбинацию: $f = \sum\limits_{i = 0}^{n}b_i \cdot f_i$.
        }
    }
    \newlection{15 марта 2023 г.}


    \section{Локализация или кольца частных}
    Пусть $K$ --- поле.

    Хотим вложить кольцо многочленов $K[x]$ в какое-то поле $K(x)$.

    Возьмём любое кольцо $R$, построим по нему поле частных $Q(R)$.
    Если $R$ --- область целостности, то всё тривиально, а если есть делители нуля, то чуть сложнее.

    \subsection{Мультипликативные системы}
    Пусть $R$ --- произвольное коммутативное кольцо с единицей.
    Строить кольцо частных некоммутативного кольца можно, но намного сложнее.

    Рассмотрим произвольное подмножество $S \subset R$.
    \definition[$S$ --- мультипликативная система]{\down
    \bullets{
        \item Аксиома полугруппы: $S$ замкнуто относительно умножения, $\forall u, v \in S: uv \in S$.
        \item Аксиома моноида: $1 \in S$.
        \item Аксиома нетривиальности: $0 \notin S$.
    }
    }
    Мы собираемся сопоставить паре $(R, S)$ кольцо, в котором элементы $S$ обратимы --- кольцо $S^{-1}R$.
    \examples[Мультипликтивные системы]{
        \item $S \le R^*$ --- тривиальная мультипликативная система.
        \item $S = \Reg(R)$ --- множество элементов, на которые можно сокращать.
        В частности, если $R$ --- область целостности, то $\Reg(R) = R \sm \{0\}$.
        \item Пусть $\mathfrak{p} \in \Spec(R)$ --- простой идеал: $\forall xy \in \mathfrak{p}: (x \in \mathfrak{p} \lor y \in \mathfrak{p})$.
        Тогда $R \sm \mathfrak{p}$ является мультипликативной системой.

        В кольце $(R \sm \mathfrak{p})^{-1}R$ остался всего один максимальный идеал --- $\mathfrak{p}$.

        \item Главная мультипликативная система. Рассмотрим $s \in R \sm \Nil(R)$. Где $\Nil(R) = \bigcap\limits_{\p \in \Spec(R)}\p$ ($\Nil(R) = \defset{x \in R}{\exists m \in \N: x^m = 0}$)

        В качестве множества $S$ рассмотрим $\langle 1, s, s^2, \dots \rangle$.
        Это аналогично построению кольца десятичных дробей $\Z\left[\frac{1}{10}\right] = \Z\left[\frac{1}{2}, \frac{1}{5}\right]$.
        Вообще, обращение двух (конечного числа) элементов $s, t \in R$ равносильно обращению их произведения $st$.
    }

    \subsection{Построение кольца частных}
    Обратимся к истокам: как строить дроби из множества $\Q$?
    Это такие $\frac{m}{n}$, что $n \ne 0$. $\frac{m_1}{n_1} = \frac{m_2}{n_2} \iff m_1 n_2 = m_2 n_1$.

    Рассмотрим произведение $R \times S = \defset{(u, v)}{u \in R,v\in S}$, где $S$ --- мультипликативная система.

    Введём отношение эквивалентности $(x, u) \sim (y, v)$, если $\exists w \in S: (xv - yu)w = 0$.
    Напрашивающееся решение $xv - yu = 0$ не соблюдает корректность: если $(xv - yu)$ в новом кольце --- не 0, то $w$ нельзя обратить.

    \lemma{
        $\sim$ --- отношение эквивалентности.
        \provehere{
            <<Всё очевидно, кроме транзитивности. Но транзитивность тоже очевидна>>

            Пусть $(x, u) \sim (y, v) \sim (z, w)$.
            Тогда $\exists s, t \in S$:
            \gather{
                \left.\begin{aligned}
                (xv - yu)
                          s = 0 \qquad |\cdot wt\\
                          (yw - zv)t = 0 \qquad |\cdot us
                \end{aligned}\right\}+ \\
                (xw - zu)vst = 0
            }
        }
    }
    \definition[Кольцо частных $R$ относительно мультипликативной системы $S$]{\label{quotient_ring_construction}
    Так построенное $S^{-1}R \bydef R \times S /\!\!\sim$ с операциями, определёнными ниже.
    Запись $S^{-1}R$ здесь следует понимать, как неделимый символ.
    }
    Пара $(x, u)$ содержится в классе эквивалентности, обозначаемом $\frac{x}{u}$.

    Операции определены следующим образом:
    \bullets{
        \item $\frac{x}{u} + \frac{y}{v} = \frac{xv + yu}{uv}$.
        \item $\frac{x}{u} \cdot \frac{y}{v} = \frac{xy}{uv}$.
        \item $1_{S^{-1}R} = \frac{1}{1}$.
    }
    \lemma{
        Операции определены корректно.
        \provehere{
            Пусть $\frac{x}{u} = \frac{x'}{u'}$. Тогда $\frac{x}{u} + \frac{y}{v} = \frac{x'}{u'} + \frac{y}{v}$, так как
            \gather{
                \frac{xv + yu}{uv} = \frac{x'v + yu'}{u'v} \\
                (xv + yu)\cdot(u'v) = (x'v + yu')\cdot(uv) \\
                \exists w = (xu' - x'u)w = 0 \text{, так как $\frac{x}{u} = \frac{x'}{u'}$}\\
                ((xv + yu)u'v - (x'v + yu')uv)w = 0 \\
                (xu' - x'u)v^2w = 0\text{ --- сошлось}\\
            }
        }
    }
    \theorem{
        Эти операции превращают $S^{-1}R$ в коммутативное кольцо с единицей, и отображение $\phi_S: R \map S^{-1}R; \qquad x \mapsto \frac{x}{1}$ является гомоморфизмом колец.
        При этом $\phi_S(S) \subset (S^{-1}R)^*$.

        Гомоморфизм $\phi_S$ называется \emph{гомоморфизм локализации}.
        \provehere{
            Проверка всех свойств --- утомительное занятие, которое приведено не будет.

            Если $x \in S$, то элемент $\frac{x}{1}$ действительно обратим, так как ${\frac{x}{1} \cdot \frac{1}{x} = 1_{R^{-1}S}}$.
        }
    }

    \subsection{Универсальное свойство кольца частных}
    Пусть $S \subset R$ --- мультипликативная система.
    Определим $S^{-1}R$.

    Например, найдём гомоморфизм $\psi: R \map A$, где $A$ --- другое коммутативное кольцо с единицей.
    Если $\psi(S) \le A^*$, то подходящее кольцо частных нашлось.

    \definition[Кольцо $S^{-1}R$]{
        Коммутативное кольцо с единицей и гомоморфизмом $\phi_S: R \map S^{-1}R$, таким, что $\phi_S(S) \subset (S^{-1}R)^*$, обладающее универсальным свойством:
        $\forall A$ --- коммутативное кольцо с единицей, $\forall \psi: R \map A$ --- гомоморфизм, такой, что $\psi(S) \subset A^*, \exists ! \text{ гомоморфизм }\eta: S^{-1}R \map A$, делающий диаграмму коммутативной.
        % https://q.uiver.app/#q=WzAsMyxbMCwwLCJSIl0sWzIsMCwiU157LTF9UiJdLFsxLDEsIkEiXSxbMCwyLCJcXHBzaSIsMl0sWzAsMSwiXFxwaGlfUyIsMl0sWzEsMiwiXFxldGEiXV0=
        \[\begin{tikzcd}[ampersand replacement=\&]
              R \&\& {S^{-1}R} \\
              \& A
              \arrow["\psi"', from=1-1, to=2-2]
              \arrow["{\phi_S}"', from=1-1, to=1-3]
              \arrow["\eta", from=1-3, to=2-2]
        \end{tikzcd}\]

        Таким образом, всякий гомоморфизм $\psi: R \map A$ пропускается через кольцо частных.
    }
    \theorem{
        Построенное в предыдущем параграфе кольцо дробей действительно обладает универсальным свойством.
        \provehere{
            $S^{-1}R = \defset{\frac{x}{u}}{x \in R, u \in S}$. Определим гомоморфизм $\eta: S^{-1}R \map A$ как $\eta\left(\frac{x}{u}\right) = \psi(x)\psi(u)^{-1}$.

            Проверим, что он определён корректно: \[\frac{x}{u} = \frac{y}{v} \iff \exists w \in S: (xv - yu)w = 0 \then (\psi(x)\psi(v) - \psi(y)\psi(u))\psi(w) = 0\]
            На $\psi(w)$ можно сократить, получаем что надо:
            \[\psi(x)\psi(y)^{-1} = \psi(u)\psi(v)^{-1}\]

            Проверим, что $\eta$ --- гомоморфизм.
            \gather{
                \eta\left(\frac{x}{u} + \frac{y}{v}\right) = \eta\left(\frac{xv + yu}{uv}\right) =\\
                = (\psi(x)\psi(v) + \psi(y)\psi(u))\psi(u)^{-1}\psi(v)^{-1} = \psi(x)\psi(u)^{-1} + \psi(y)\psi(v)^{-1} = \eta\left(\frac{x}{u}\right) + \eta\left(\frac{y}{v}\right)}

            Осталось проверить единственность: возьмём любой гомоморфизм $\eta'$, делающий диаграмму коммутативной.
            Почему он равен $\eta$?

            Так как диаграмма коммутативна, то $\eta'(\psi_S(x)) = \psi(x)$, то есть $\eta'\left(\frac{x}{1}\right) = \psi(x)$.

            Проверим совпадение $\eta = \eta'$ для дроби $\frac{x}{u}$.
            Так как $\psi(u) \in A^*$, то $\psi(x) = \eta'\left(\frac{x}{1}\right) = \eta'\left(\frac{x}{u}\right) \cdot \eta'\left(\frac{u}{1}\right) = \eta'\left(\frac{x}{u}\right)\psi(u)$. Сократив на $\psi(u)$ (оно обратимо в $A$), действительно получаем $\eta'\left(\frac{x}{u}\right) = \psi(x)\psi(u)^{-1}$. Значит, $\eta'$ действительно совпадает с $\eta$.
        }}
    \note{
        Воспользовавшись универсальным свойством, нетривиально (но можно, переходя к пределам в теории категорий) доказать, что кольцо частных существует.
        Но мы уже его построили в предыдущем параграфе, поэтому оно несомненно существует.
    }

    \subsection{Кольцо частных в терминах элементов}
    \definition[Кольцо $S^{-1}R$]{
        $S^{-1}R$  --- кольцо вместе с гомоморфизмом $\phi_S: R \map S^{-1}R$, таким, что
        \numbers{
            \item $\phi_S(S) \subset (S^{-1}R)^*$.
            \item $\forall y \in S^{-1}R$ представим в виде $y = \phi_S(x)\phi_S(u)^{-1}$, где $x \in R, u \in S$.
            \item Если $\phi_S(x) = 0$, то $\exists u \in S: xu = 0$.
        }
    }
    \theorem{
        Построенное кольцо $S^{-1}R$~(\cref{quotient_ring_construction}) обладает этими свойствами.
        Любое кольцо $A$ с гомоморфизмом $\psi: R \map A$, обладающее этими свойствами, изоморфно $S^{-1}R$:
        \numbers{
            \item $\psi(S) \le A^*$
            \item $\forall y \in A, y = \psi(x)\psi(u)^{-1}$
            \item $\psi(x) = 0 \iff \exists u \in S: xu = 0$.
        }
    }

    \subsection{Примеры колец частных}
    \examples{
        \item $S \le R^*$ --- тривиальная мультипликативная система. $S^{-1}R = R$.
        \item $S = \Reg(R)$. В таком случае $S^{-1}R = Q(R)$ --- полное кольцо частных.
        Здесь выполнено вложение $R \hookrightarrow Q(R)$.
        Если $R$ --- область целостности, то $\Reg(R) = R \sm \{0\}$, тогда $Q(R)$ --- поле, \emph{поле частных}.

        Примеры полей частных: ${Q(\Z) = \Q, \quad Q(\Z[i]) = \Q[i],\quad  Q(K[x]) = K(x),\quad Q(K[[x]]) = K((x))}$.
    }
    \newlection{18 марта 2023 г.}
    Любое конечное число главных локализаций представимо в виде одной локализации --- по их произведению:
    Если
    Любая локализация --- предел главных локализаций.
    Здесь должно быть побольше информации на эту тему.


    \section{Поле частных факториального кольца}
    $R$ --- UFD, $K = Q(R) = \defset{\frac{x}{y}}{x, y \in R, y \ne 0}$.

    \theorem{
        Всякий элемент $Q(R)$ допускает представление в виде \[u p_1^{m_1} \proddots p_s^{m_s}, \quad m_i \in \Z\]  в единственном виде, где $p_i$ --- попарно неассоциированные неприводимые элементы.
        \provehere{
            $v_p\left(\frac{x}{y}\right) = v_p(x) - v_p(y)$.
        }
    }
    $p$-адические показатели обладают обычными свойствами:
    \numbers{
        \item $v_p\left(\frac{x}{y} \cdot \frac{z}{w}\right) = v_p\left(\frac{x}{y}\right) + v_p\left(\frac{z}{w}\right)$.
        \item $v_p\left(\frac{x}{y} + \frac{z}{w}\right) \ge \min\left(v_p\left(\frac{x}{y}\right) + v_p\left(\frac{z}{w}\right)\right)$.
    }
    Любопытно заметить, что $R = \defset{x \in Q(R)}{\forall p \in \Irr(R): v_p(x) \ge 0}$.
    \ok
    Пусть $R \hookrightarrow A$.
    \definition[$x \in A$ --- целое над $R$] {
        $x$ --- корень многочлена $f \in \R[t]$, такого, что старший коэффициент $\lc(f) = 1$.
        Наименьшая степень $f$, имеющего своим корнем $x$, называется \emph{степенью} $x$.
    }
    \intfact{
        Множество целых над $R$ образует кольцо.

        Есть доказательство через тензорное произведение (сумму), есть --- через симметрические многочлены и кронекеровское произведение (сумму).
    }
    В частности, $\A$ --- целые алгебраические числа над $\Z$ (а просто алгебраические числа можно обозначить $\overline{\Q}$).
    \definition[Целозамкнутое кольцо $R$]{
        Любой элемент $x \in Q(R)$, являющийся целым над $R$, принадлежит $R$.
    }
    \lemma[Лемма Гаусса]{
        $R$ --- UFD $\then$ $R$ --- целозамкнуто.
        В частности, кольцо $\Z$ целозамкнуто, то есть $\Q \cap \A = \Z$.
        \provehere{
            Пусть $\frac{x}{y}$ --- корень $f \in R[t]$.
            Можно считать, что $x$ и $y$ взаимно просты --- иначе на общий множитель можно сократить.
            \[\left(\frac{x}{y}\right)^n + a_{n - 1}\left(\frac{x}{y}\right)^{n - 1} + \dots + a_1 \left(\frac{x}{y}\right) + a_0 = 0\]
            Умножив на $y^n$, получим равенство в $R$:
            \[x^n + a_{n - 1}x^{n - 1}y + \dots + a_1 xy^{n - 1} + a_0 y^n = 0\]
            Рассмотрим любой неприводимый $p \divs y$.
            Он делит все слагаемые, кроме первого, значит, делит первое слагаемое тоже (типичное рассуждение).

            Значит, $y \in R^*$, значит, $\frac{x}{y} \in R$.
        }
    }


    \section{Рациональные дроби}
    Рассмотрим кольцо многочленов над полем $K$.

    Оно является областью целостности ($\deg (f \cdot g)= \deg f + \deg g$), значит, определено $Q(K[t]) = K(t)$ --- \emph{поле рациональных дробей} над $K$.
    Часто его также называют полем рациональных функций.
    Тем не менее, элементы, $K(t)$ вообще говоря, функциями не являются, например, потому что многие нетривиальные функции не определены на $K$.

    А именно, $f \in K[t] \rightsquigarrow (\tilde{f}: K \map K)$.
    Это единственный гомоморфизм из $K[t]$ в $K$, и согласованно определить аналогичный гомоморфизм на $K(t)$ не представляется возможным.
    При сложении двух функций $\frac{f}{g} \in K(t) \rightsquigarrow \left(\tilde{\frac{f}{g}}: c \mapsto \frac{f(c)}{g(c)}\right)$ их области определения пересекаются.
    Решением матанализа является рассматривать рациональные функции, как частичные --- определённые не везде.

    Ещё проблемой является вопрос --- равны ли рациональные <<функции>> $\frac{1}{t}$ и $\frac{t - 1}{t(t - 1)}$?
    Можно говорить о равенстве в любой окрестности, которая может быть открыта как в стандартном смысле, так и в топологии Зарисского.
    В таком случае разные рациональные функции (например, $\frac{1}{t}$ и $\frac{t - 1}{t(t - 1)}$) объединяются в классы эквивалентности --- \emph{ростки функций}.

    Ещё можно определить функции на одноточечной компактификации $K$, в народе называющейся сферой Римана --- проективной прямой $\P'(K) = K \cup \{\infty\}$.
    В таком случае $\frac{f}{g}(\infty) = \all{0,&\deg(f) < \deg(g) \\ \infty, & \deg(f) > \deg(g) \\\frac{\lc(f)}{\lc(g)},& \deg(f) = \deg(g)}$.
    В точках же $c \in K$, таких, что $(x - c)^{m_1} \| f, (x - c)^{m_2} \| g$ и $m_2 > m_1$, $\frac{f}{g}(c) = \infty$ по определению.

    \definition[Степень рациональной функции]{
        $\deg\left(\frac{f}{g}\right) = \deg f - \deg g$.
    }
    \definition[Полуправильная дробь $\frac{f}{g} \in K(t)$]{
        $\deg\left(\frac{f}{g}\right) \le 0$.
    }
    \definition[Правильная дробь $\frac{f}{g} \in K(t)$]{
        $\deg\left(\frac{f}{g}\right) < 0$.
    }
    \lemma{
        Степень удовлетворяет обычным условиям: $\forall \alpha, \beta \in K(t)$:
        \bullets{
            \item $\deg(\alpha \cdot \beta) = \deg(\alpha) + \deg(\beta)$.
            \item $\deg(\alpha + \beta) \le \max(\deg(\alpha), \deg(\beta))$.
        }
    }
    \corollary{Правильные и полуправильные дроби образуют подкольцо (правильные --- кольцо без единицы).}
    \theorem{
        Пусть $\alpha \in K(t)$.
        Для любого представления $\alpha = \frac{f}{g}$ допускается единственное представление в виде $\frac{f}{g} = q + \frac{r}{g}$, где $q \in K[t], \frac{r}{g}$ --- правильная рациональная дробь.

        Более того, для любого такого представления многочлен $r$ один и тот же.
        \provehere{
            Запись эквивалентна $f = qg + r$ ($q, r \in K[t], \deg r < \deg g$), а такое представление единственно, так как деление с остатком в $K[t]$ даёт единственный результат.

            Единственность $r$ следует от противного: $\frac{f_1}{g_1} + r_1 = \frac{f_2}{g_2} \then \underbrace{\frac{f_1}{g_1} - \frac{f_2}{g_2}}_{\text{правильная дробь}} = \underbrace{r_2 - r_1}_{\text{многочлен}}$.
            Равенство наступает только если $r_1 - r_2 = 0$
        }
    }
    \definition[Запись $\frac{f}{g}$ несократима]{
        $f \perp g$.
    }


    \section{Разложение на простейшие дроби}
    Предположим, что мы в XVIII веке ищем интеграл $\int\frac{f(x)}{g(x)}\d x$.
    \definition[Примарная дробь $\frac{f}{g} \in K(t)$]{
        $g = p^m$ для $p \in \Irr(K[t])$ и $\deg f < \deg g$.
    }
    \definition[Простейшая дробь $\frac{f}{g} \in K(t)$]{
        Примарная дробь, такая, что $\deg f < \deg p$.
    }
    В частности, простейшими дробями являются $\frac{x^i}{p^m}$ для $0 \le i < \deg p$.
    \theorem{
        Любая рациональная дробь допускает единственное представление в виде суммы многочлена и простейших дробей с различными знаменателями.
        \provebullets{
            \item Выделим целую (полиномиальную) часть.
            Отныне считаем, что $\frac{f}{g}$ --- правильная.
            \item Если $g \perp h$ и $\deg gh > \deg f$ то $\frac{f}{g h}$ представима, как сумма правильных дробей $\frac{f_1}{g} + \frac{f_2}{h}$:

            Так как $K[t]$ --- PID, то $g$ и $h$ --- комаксимальны: $gK[t] + hK[t] = K[t]$, то есть $\exists u, v \in K[t]: gu + hv = 1$.
            Получаем \[\frac{f}{gh} = \frac{fgu}{g h} + \frac{f h v}{g h} = \frac{fu}{h} + \frac{f v}{g}\]
            Поделим $fv$ на $g$ с остатком: $fv = q g + r$.
            Равенство переписывается в виде $\frac{f}{g h} = \left(\frac{fu}{h} + q\right) + \frac{r}{g}$.
            В скобках стоит правильная дробь, как разность двух правильных дробей.

            Получили разложение на правильные дроби.

            Применив для $g = p_1^{m_1} \proddots p_s^{m_s}$, получаем разложение на примарные дроби.
            \item Покажем, что примарная дробь есть сумма простейших:

            Рассмотрим примарную дробь $\frac{f}{p^m}$.
            Поделим $f$ на $p$ с остатком: $f = q p + r$.
            \[\frac{f}{p^m} = \frac{qp + r}{p^m} = \frac{q}{p^{m - 1}} + \frac{r}{p^m}\]
            Первая дробь по индукции разложима на простейшие, вторая --- уже простейшая.
            \item Единственность разложения: если представление не единственно, то существует нетривиальная линейная зависимость:
            \[\sum\limits_{i,j}\frac{f_{i,j}}{p_i^j} = 0\]
            где $\deg(f_{i,j}) < \deg(p_i)$, $p_i$ --- неприводимые многочлены.

            Сконцентрируемся на $p_n$.
            Пусть суммирование для $i = n$ идёт по $j = 1..m$.
            Разобьём сумму:
            \[-\sum\limits_{i \ne n,j}\frac{f_{i,j}}{p_i^j} - \sum\limits_{j < m}\frac{f_{n,j}}{p_n^j} = \frac{f_{n,m}}{p_n^m}\]
            Посчитаем $p_n$-адический показатель обеих частей, получим противоречие: ${\ge m_1 + 1 \Big/ = m_1}$.
        }
    }
    \corollary{
        Базис кольца многочленов счётен --- $1, t, t^2, \dots$.

        Базис кольца рациональных дробей $K(t)$ счётен только если $K$ не более, чем счётно.
        А именно, это $\defset{t^i}{i \in \N_0} \cup \defset{\frac{t^i}{p^m}}{0 \le i < \deg p, p \text{ --- нормированный}}$.

        С аксиомой выбора это эквивалентно тому, что базис $K(t)$ равномощен $K$ для бесконечного $K$.
    }
    \example{
        Над $\C$ любой неприводимый нормированный многочлен --- это $x - c$ для $c \in \C$.
        Базис правильных дробей получается $\defset{\frac{1}{(x - c)^m}}{m \in \N}$.
    }


    \section{Факториальность кольца многочленов}
    \textbf{Теорема \ref{Gauss}} (Теорема Гаусса)\textbf .
    $R$ --- UFD $\then R[t]$ --- UFD.

    \subsection{Примитивные многочлены}
    Пусть $f \in R[t]$, $f = a_n x^n + \dots + a_1 x + a_0$.
    \definition[Содержание многочлена $f$]{$\Cont(f) \bydef \gcd(a_n, \dots, a_0)$.}
    \definition[Примитивный многочлен $f$]{$\Cont(f) = 1$.}
    \definition[Сильно примитивный многочлен $f$]{$a_0, a_1, \dots, a_n$ --- комаксимальны (возможно, $a_1, \dots, a_n$ комаксимальны, я не справился узнать, где правда).}
    \lemma{
        Всякий многочлен представим в виде произведения его содержания и примитивного многочлена.
    }
    \lemma{
        Если $af \sim bg$, где $a, b \in R \sm \{0\}$, $f, g \in R[t]$ --- примитивные многочлены, то $a \sim b, f \sim g$.
        \provehere{

            $af \cdot u = bg$, где $u \in (R[t])^* = R^*$.
            Отсюда степени многочленов равны. Пусть $f = a_n x^n + \dots + a_0; \quad g = b_n x^n + \dots + b_0$.
            \[a \gcd(a_n, \dots, a_0) = \gcd(a a_n, \dots, a a_0) = \gcd(b b_n, \dots, b b_0) = b \gcd(b_n, \dots, b_0)\]
            откуда $a \sim b$.
            Отсюда $f \sim g$.
        }
    }
    \lemma[Лемма Гаусса]{
        Если $f, g \in R[t]$ --- примитивные многочлены, то $f \sim g$ в $R[t] \iff f \sim g$ в $K[t]$.
        \provehere{
            $f \sim g$ в $K[t] \then \left(\frac{a}{b}\right)f = g \then af = bg$.
            По предыдущей лемме $f \sim g$.
        }
    }
    \lemma[Лемма Гаусса]{
        $\forall f, g \in R[t]: \forall p \in \Irr(R): v_p(fg) = v_p(f) + v_p(g)$ где $v_p(f) = \min(v_p(a_0), \dots, v_p(a_n))$.

        В частности, $\Cont(f \cdot g) = \Cont(f) \cdot \Cont(g)$.

        В частности, примитивные многочлены образуют мультипликативную систему.
        \provehere{
            Введём $r$ --- наименьший номер, такой, что $p^{v_p(f) + 1} \notdivs a_r$ и $s$ --- наименьший номер, такой, что $p^{v_p(g) + 1} \notdivs b_s$.

            Рассмотрим $f \cdot g$, а именно, его коэффициент при $t^{r + s}$.
            Это \[\underbrace{a_{r + s}b_0 + \dots}_{\divisibleby\: p^{v_p(f) + v_p(g) + 1}} + a_r b_s + \underbrace{\dots + a_0 b_{r + s}}_{\divisibleby\: p^{v_p(f) + v_p(g) + 1}}\]
            Но средний коэффициент делится \textbf{точно} на $p^{v_p(f) + v_p(g)}$, значит, $v_p(f \cdot g) \le v_p(f) + v_p(g)$. (Оценка снизу очевидна)
        }
    }
    Пусть $R$ --- UFD, $K = Q(R)$.
    \theorem[Теорема Гаусса]{\label{gauss_irreducibility}
        Для всякого $f \in R[t]$: $f \in \Irr(R[t]) \then f \in \Irr(K[t])$.
        \provehere{
            Пусть $f = gh$ в $K[t]$. Запишем
            \[g = \frac{a_m}{b_m}t^m + \dots + \frac{a_0}{b_0}; \quad h = \frac{c_n}{d_n}t^n + \dots + \frac{c_0}{d_0}\]
            где $a_i, c_i \in R; b_i, d_i \in R \sm \{0\}$.
            Обозначим $B = \prod b_i, D = \prod d_i$.
            Получаем \[B D \cdot f = B g \cdot D h = \Cont(B g) \cdot \Cont(D h) \cdot \tilde{g} \cdot \tilde{h},\quad\text{где $\all{\tilde{g} = \nicefrac{B g}{\Cont(Bg)}\\ \tilde{h} = \nicefrac{Dh}{\Cont(Dh)}}$}\]

            Согласно предыдущей лемме $\tilde{g} \cdot \tilde{h}$ тоже неприводимый, а ещё тогда $f \sim \tilde{g} \cdot \tilde{h}$ в $R[t]$ ($f$ неприводим по условию теоремы).
        Так как $f$ неприводим, то $\deg g = 0$ или $\deg h = 0$, то есть $f$ неприводим и в $K[t]$.
        }
    }
    \corollary{
        Для всякого примитивного $f \in R[t]$: $f \in \Irr(R[t]) \iff f \in \Irr(K[t])$.
    }
    \note{
    Обратное следствие неверно для не примитивных многочленов: $2x - 2 \in \Z[x]$ не является неприводимым, но $2x - 2 \in \Q[t]$ --- неприводимый элемент.
    }
    \subsection{Теорема Гаусса}
    \theorem[Теорема Гаусса]{\label{Gauss}
        $R$ --- UFD $\then R[t]$ --- UFD.
        \provehere{
            Воспользуемся тем, что и $R$ факториально, и $K[t]$ факториально, где $K = Q(R)$.

            $f = \Cont(f) \cdot \tilde{f}$.
            Разложим $\Cont(f)$ внутри UFD $R$.

            Если $\tilde{f}$ разложим над $K[t]$, то он разложим и над $R[t]$~(\cref{gauss_irreducibility}).

            Так как кольцо $K[t]$ нётерово, то процесс оборвётся, значит получили разложение $f = u p_1 \proddots p_r q_1 \proddots q_s$, где $u \in R^*, p_i \in \Irr(R), q_j \in \Irr(R[t])$.

            Единственность доказывается следующим образом:
            \gather{
                u p_1 \proddots p_r q_1 \proddots q_s \sim u' p'_1 \proddots p'_r q'_1 \proddots q'_s \\
                \Downarrow\\
                u p_1 \proddots p_r \sim u' p'_1 \proddots p'_r \\
                q_1 \proddots q_s \sim q'_1 \proddots q'_s \\
            }
            $R$ факториально, поэтому первые разложения совпадают.
            Вторые разложения --- разложения и в $K[t]$, поэтому они ассоциированы в $K$ ($K[t]$ UFD, так как это евклидово кольцо. то есть PID).
            Но согласно лемме Гаусса они ассоциированы и в $R$.
        }
    }
    \corollary{\down
        \bullets{
            \item $K[t_1, \dots, t_n]$ --- UFD
            \item $\Z[t_1, \dots, t_n]$ --- UFD
        }
    }
%    Всякое коммутативное кольцо $R$ есть предел конечнопорождённых (над $\Z$) подколец.
    \newlection{28 марта 2023 г.}


    \section{Дифференцирование алгебр}
    Пусть $R$ --- коммутативное кольцо с единицей, $A$ --- алгебра над $R$.

    \definition[Дифференцирование]{
        Отображение $D: A \map A$, являющееся аддитивным, и удовлетворяющее \emph{тождеству Лейбница}
        \[D(x y) = D x \cdot y + x \cdot D y\]
    }
    $D$ называется \emph{$R$-дифференцированием}, если, кроме того, оно согласовано с умножением на элемент $R$: $D(\lambda x) = \lambda D x$.

    Множество всех дифференцирований алгебры $A$ обозначается $\Der(A)$, множество $R$-дифференцирований --- $\Der_R(A)$.
    \definition[Константа дифференцирования $D$]{
        Элемент $x \in A: D x = 0$.
    }
    \note{
        Аксиома $R$-дифференцирования --- о согласованности с домножением на элемент $R$ --- утверждает, что все элементы $R$ --- константы при вложении в $A$.
    }
    \lemma{
        Константы дифференцирования образуют подкольцо с единицей в $R$.
        \provehere{
            Замкнутость относительно сложения и умножения; $D (1 \cdot 1) = D(1) \cdot 1 + 1 \cdot D(1) \then D(1) = 0$
        }
    }
    \fact{
        Любое дифференцирование полностью определяется своими значениями на какой-то системе образующих $x_1, \dots, x_n$ алгебры $A$ над $R$.
        \provehere{
            Пусть $\forall x_i: D_1(x_i) = D_2(x_i)$.
            Введём $D \coloneqq D_1 - D_2$. $D(x_i) = 0$, так как $x_i$ --- система образующих, то $\Ker D = A$.
        }
    }
    \examples{
        \item[$\infty$.] $C^{(\infty)}(\R)$ --- множество бесконечно дифференцируемых функций. $\frac{\d}{\d x}$ --- дифференцирование.
        \item Внутреннее дифференцирование: для какого-то $a \in A$:\[d_a: A \map A; \quad x \mapsto [a, x] = ax - xa\]
    }

    \subsection{Операции над дифференцированиями}
    \numbers{
        \item Сумма: $D_1 + D_2$ является дифференцированием.
        \item Домножение на скаляр: $\forall \lambda \in R: \lambda D$ является дифференцированием.
        \item[-1.] Произведение дифференцирований дифференцированием, вообще говоря не является: квадрат дифференцирования, например, не удовлетворяет тождеству Лейбница: $(fg)'' = f''g + 2f'g' + fg'' \ne f'g + fg'$.
        Вторая производная является дифференцированием только в кольце характеристики $2$.
        \item Коммутирование: $D_1, D_2 \in \Der_R(A) \mapsto D_1 D_2 - D_2 D_1 = [D_1, D_2] \in \Der_R(A)$.
        \provehere{
            \multline{[D_1, D_2](xy) = D_1(D_2(xy)) - D_2(D_1(xy)) =\\= D_1(D_2 x\cdot y + x \cdot D_2 y) - D_2 (D_1 x \cdot y + x \cdot D_1 y) = \\ = [D_1, D_2]x \cdot y + x \cdot [D_1, D_2] y}
        }
    }
    \theorem{
        Для любой (не предполагается ассоциативность) алгебры $A$: $\Der_R(A)$ является алгеброй Ли над $R$ относительно суммы и коммутирования.

        Тождества алгебры Ли $(+, [\cdot, \cdot])$:
        \numbers{
            \item $[x_1 + x_2, y] = [x_1, y] + [x_2, y]$.
            \item $[x, y_1 + y_2] = [x, y_1] + [x, y_2]$.
            \item $[\lambda x, y] = \lambda[x, y] = [x, \lambda y]$.
            \item $[x, x] = 0$ --- тождество антикоммутативности.
            \item $[[x, y], z] + [[y, z], x] + [[z, x], y] = 0$ --- тождество Якоби.
        }
    }

    \subsection{Дифференцирование кольца многочленов, теорема Лейбница --- Бернулли}
    Рассматриваем $R$-алгебру $R[x]$.
    \definition[Формальная производная многочлена]{
        Для многочлена $f = a_n x^n + \dots + a_1 x + a_0$ ($a_i \in R$) это многочлен $f' = n a_n x^{n - 1} + \dots + a_1$.

        Операция взятия производной часто обозначается $\frac{\d}{\d x}: R[x] \map R[x], f \mapsto f'$.
    }
    \theorem[Лейбниц --- Бернулли]{
        $\Der_R(R[x]) = R[x] \cdot \frac{\d}{\d x}$.
        Иными словами, для любого дифференцирования $D$ существует многочлен $h \in R[x]$, такой, что $D \equiv h \cdot \frac{\d}{\d x}$.
        \provebullets{
            \item Эта формула задаёт дифференцирование:

            В силу $R$-линейности достаточно проверять на стандартных мономах.
            \gather{
                D(x^m \cdot x^n) = D(x^{m + n}) = h(x) \cdot (m + n)x^{m + n - 1} \\
                D(x^m \cdot x^n) = D(x^m)x^n + x^m D(x^n) = h(x)m x^{m - 1} + x^m h(x) n x^{n - 1} = h(x) \cdot (m + n)x^{m + n - 1}
            }
            \item Пусть $D \in \Der_R(R[x])$. Тогда $D$ полностью определяется значением на какой-то системе образующих алгебры, например, на элементе $x$.
            Пусть $D x = h, h \in R[x]$. В силу линейности достаточно доказать, что $D = h \cdot \frac{\d}{\d x}$ только на стандартных мономах.

            Это верно, так как для $f_1, \dots, f_n: D(f_1 \proddots f_n) = D(f_1) f_2 \proddots f_n + \dots + f_1 \proddots f_{n - 1}D(f_n)$.
            В частности, для коммутирующих $f$ и $D f$: $D (f^n) = n f^{n - 1} \cdot D f$.
        }
    }
    \properties[Свойства производной]{
        \item $D(f \circ g) = (D f \circ g) \cdot D(g)$.
        \item Тождество для дифференцирований высших порядков: $f'' = (f')', f''' = (f'')'$, $(f\cdot g)^{(n)} = \sum\limits_{k = 0}^{n}\binom{n}{k}f^{(k)}g^{(n - k)}$.
        \item Формула Фаа ди Бруно: \[D^n(f \circ g) = \sum \frac{n!}{m_1!1!^{m_1}\proddots m_n! n!^{m_n}}D^{(m_1 + \dots + m_n)}(f \circ g) \cdot \prod\limits_{j = 1}^{n}(D^j g)^{m_j}\]
    где сумма берётся по всем таким $m_1, \dots, m_n$, что $m_1 \cdot 1 + \dots + m_n \cdot n = n$.
        \item $D(g^{-1}) = -g^{-1} \cdot Dg \cdot g^{-1}$.
        Для коммутативного кольца, например, $K(x): \left(\frac{f}{g}\right)' = \frac{f'g - fg'}{g^2}$.
    }
    \theorem{
        Константы дифференцирования $K[x]$ у $\frac{\d}{\d x}$ --- это $K[x^p]$, где $p = \chr (K)$.
    }


    \section{Алгебраические и трансцендентные элементы; минимальный многочлен}
    Пусть $K$ --- поле, $A$ --- необязательно коммутативная $K$-алгебра.

    Гомоморфизм эвалюации определён $\forall c \in A: \ev_c: K[x] \map A, f \mapsto f(c)$.

    У гомоморфизма есть ядро $\Ker (\ev_c) \normeq K[x]$.
    \bullets{
        \item Либо $\Ker(\ev_c) = \{0\}$.
        В таком случае $c \in A$ --- \emph{трансцендентный} над $K$ элемент.
        \item Либо $\Ker(\ev_c) \ne \{0\}$.
        В таком случае $c \in A$ --- \emph{алгебраический} над $K$ элемент.
    }
    \definition[Минимальный многочлен для $c \in A$]{
        Многочлен $\theta_c$, порождающий $\Ker (\ev_c)$
    }
    Все многочлены из ядра $\Ker(\ev_c)$ называются \emph{аннулирующими}.
    Так как $K[x]$ --- PID, то минимальный многочлен существует (и все аннулирующие многочлены делятся на минимальный).


    \definition[Степень элемента $c$ над $K$]{
        Степень $\deg \theta_c$.
    }
    \singlepage{\theorem{\down
    \bullets{
        \item Если $c$ --- трансцендентный над $K$, то $K[c] \cong K[x]$.
        \item Если $c$ --- алгебраический над $K$, то $K[c] \cong K[x]/(K[x]\theta_c)$ --- векторное пространство над $K$ размерности $n \coloneqq \deg \theta_c$.
        \[K[c] = \defset{a_0 + a_1 + \dots + a_{n - 1}c^{n - 1} + K[x]\theta_c}{a_i \in K}\]
    }
    }
    \provehere{
        Теорема о ядре и образе для $\ev_c$.
    }
    }
    \note{$K[c]$ --- наименьшая $K$-подалгебра, содержащая $c$.}

    \subsection{Что можно сказать, если $A$ --- область целостности?}
    $\ev_c: K[x] \map A$ --- область целостности.
    Если $c$ --- алгебраическое, то $K[x]/K[x]\theta_c \cong K[c] \le A$.

    Таким образом, $\theta_c$ неприводим в $K[x]$: если $\theta_c = \phi \cdot \psi$, то $\overline{\phi}$, равно как и $\overline{\psi}$ --- делители нуля в $K[x]/K[x]\theta_c$.

    Обозначим поле частных $K[c]$ как $K(c) \bydef Q(K[c]) \le Q(A)$.
    \theorem{
        Если $c$ трансцендентно, то $K(c) \cong K(x)$. Если $c$ алгебраическое, то $K(c) = K[c]$.
        \provebullets{
            \item Часть про трансцендентность очевидна, так как $K[c] \cong K[x]$.
            \item Необходимо проверить, что $K[c]$ --- поле.
            Это верно, так как $K[x]$ --- PID, значит, идеал, порождённый неприводимым многочленом, максимален.
        }
    }


    \chapter{Канонические формы линейных операторов}
    \numbers{
        \item Конечные задачи:
        Рассмотрим линейное отображение $\phi: U \map V$ из первой главы.
        Его канонической формой является матрица $\vect{\arr{c| c}{e & 0 \\\hline 0 & 0}}$ при правильном выборе базиса в $U$ и в $V$.
        Все инварианты, возникавшие здесь, имели дискретную природу --- размерность и ранг.

        \item Ручные задачи: Сейчас мы рассмотрим более сложную задачу: каноническая форма линейного оператора $\phi: U \map U$.
        Трудность состоит в том, что матрицу хочется выбрать так, чтобы базисы в $U$ слева и справа совпадали.
        Здесь будут возникать непрерывные инварианты.
        \item Дикие задачи: классификация пар линейных операторов $\phi, \psi: U \map U$.
        Ответ на ту задачу не найден, и, по-видимому, не будет получен, так как он позволяет классифицировать слишком много всего.
    }


    \section{Инвариантные подпространства}
    Рассмотрим линейный оператор над полем $K$: $\phi: V \map V$ ($\phi \in \End_K(V)$).
    \definition[$\phi$-инвариантное подпространство $U \le V$]{
        Такое подпространство, что ${\phi(U) \subset U}$.
    }
    $\phi$ можно ограничить на любом $\phi$-инвариантном подпространстве $U$.
    \examples{
        \item Тривиальное ($\{0\}$) и несобственное ($V$) подпространства инвариантны для любого оператора.
        \item Движение пространства $\R^3$ с неподвижной точкой $0$ --- поворот (и, возможно, отражение). Ось вращения и ортогональная ей плоскость поворота инвариантны.
        \item $K[x]_{\le n}$ для любого $n \in \N$ инвариантно для оператора дифференцирования $\frac{\d}{\d x}$.
        \item Оператор сдвига бесконечномерного пространства:
        пусть базис пронумерован целыми числами $\dots, u_{-1}, u_0, u_1, \dots$
        Тогда оператор сдвига определён на базисе $\phi(u_i) = u_{i + 1}$.
        У него нет инвариантных подпространств, а если бы было $\phi(u_i) = u_{i + 2}$, то были бы только бесконечномерные.
    }
    Пусть $\dim V < \infty$, $\phi \in \End_K(V), \phi(U) \subset U$.
    \theorem{
        В подходящем базисе $\phi$ имеет матрицу $\vect{\arr{c|c}{\left[\phi\big|_U\right] & * \\\hline 0 & \left[\phi\big|_{V/U}\right] }}$
        \provehere{
            $\phi\big|_{V/U}: V/U \map V/U$ определено корректно: $\phi(v + U) = \phi(v) + U$.

            Выберем в качестве базиса произвольный базис $U$ --- $(v_1, \dots, v_m)$, а потом дополним его до базиса всего пространства $(v_{m + 1}, \dots, v_n)$.

            В этом базисе матрица действительно имеет такой вид. $v_{m + 1} + U, \dots, v_{n} + U$ --- базис $V/U$.
        }
    }
    \definition[Инвариантное дополнение $\phi$-инвариантного пространства $U \le V$]{
        Такое подпространство $W \le V$, что оно тоже $\phi$-инвариантно, причём $V = U \oplus W$.
    }
    \theorem[Случай полной приводимости]{
        Если $U$ имеет инвариантное дополнение $W$, то в подходящем базисе $[\phi] = \vect{\arr{c|c}{\left[\phi\big|_U\right] & 0 \\\hline 0 & \left[\phi\big|_W\right]}}$.
        \provehere{
            Выберем в качестве базисов объединение базисов $U$ и $W$.
        }
    }


    \section{Собственные подпространства. Собственные числа}
    Собственные подпространства инвариантны, но, к сожалению, инвариантно не дополняемы.

    Считаем, что $K$ --- поле, $\dim_K(V) < \infty$.
    \definition[Собственный вектор оператора $\phi$]{
        Такой вектор $\underset{\ne 0}{v} \in V$, что $\langle v \rangle = vK$ инвариантно относительно $\phi$.
        Иными словами, $\phi(v) = v \lambda$ для некоего $\lambda \in K$.
    }
    \definition[Собственное число оператора $\phi$]{
        Такое число $\lambda \in K$, что существует $\underset{\ne 0}{v} \in V$, такой, что $\phi(v) = v \lambda$.
    }
    \examples{
        \item Если $[\phi] = \vect{\lambda_1 & & 0 \\ & \ddots & \\ 0 & & \lambda_n}$ в некотором базисе $(v_1, \dots, v_n)$, то $v_1, \dots, v_n$ --- собственные векторы с соответственно собственными числами $\lambda_1, \dots, \lambda_n$.
        \emph{Оператор простой структуры} или \emph{диагонализуемый оператор}.
        \item $\vect{ 0 & 1 \\ 1 & 0}$ имеет собственные числа $1$ и $-1$ --- для векторов $\vect{1 \\ 1}$ и $\vect{1 \\ -1}$ соответственно.
        \item $\vect{0 & 1 \\ -1 & 0}$ не имеет собственных чисел, как оператор над полем $\R$.
        Как оператор над полем $\C$, оператор имеет собственные числа $i$ и $-i$ --- для векторов $\vect{1 \\ i}$ и $\vect{1 \\ -i}$ соответственно.

        Оператор диагонализуем над $\C$, но не над $\R$.
    }
    \lemma[Частный случай леммы Дедекинда --- Артина о линейной независимости характеров]{
        Пусть $v_1, \dots, v_m \in V$ --- ненулевые собственные векторы, отвечающие \textbf{попарно различным} собственным числам $\lambda_1, \dots, \lambda_m \in K$.

        Тогда $v_1, \dots, v_m$ линейно независимы.

        \provehere{
            Пусть $v_1 \mu_1 + \dots + v_m \mu_m = 0$ --- самая короткая линейная зависимость (наименьшее $m$, такое, что все $\mu_i \ne 0$).

            При $m = 1$ теорема верна, так как $v_1 \ne 0$.

            При $m \ge 2$: запишем два равенства
            \gather{
                0 = 0 \cdot \lambda_m  =  (v_1 \mu_1 + \dots + v_m \mu_m)\lambda_m \\
                0 = \phi(0) = v_1 \mu_1 \lambda_1 + \dots + v_m \mu_m \lambda_m
            }
            Вычитая равенства, получаем линейную зависимость длины ровно $m - 1$:\[0 = v_1 \cdot \mu_1(\lambda_1 - \lambda_m) + \dots + v_{m-1} \cdot \mu_{m-1} (\lambda_{m-1}-\lambda_m)\qedhere\]
        }
    }
    \theorem{
        Если оператор $\phi \in \End_K(V)$ имеет $n \coloneqq \dim V$ различных собственных чисел, то он диагонализуем.
        \provehere{
            По определению существуют ненулевые $v_1, \dots, v_n$ --- собственные векторы для данных собственных чисел.

            По лемме они линейно независимы, значит, образуют базис. В этом базисе $[\phi] = \vect{\lambda_1 & & 0 \\ & \ddots & \\ 0 & & \lambda_n}$
        }
    }


    \section{Характеристический многочлен оператора}
    Пусть $\phi \in \End_K(V)$.
    \definition[Характеристический многочлен $\chi_\phi(t)$]{
        Многочлен, равный $\det([\phi] - t e)$, где $[\phi]$ --- матрица $\phi$ в каком-то базисе, $e$ --- единичная матрица, $t$ --- свободная переменная в многочлене.
    }
    \lemma{
        $\chi_\phi$ не зависит от выбора базиса.
        \provehere{
            Любые две матрицы $\phi$ в разных базисах, $[\phi]_u$ и $[\phi]_v$ сопряжены: для $g = (u \rightsquigarrow v)$ выполняется $g[\phi]_u g^{-1} = [\phi]_v$.

            Тогда $\det([\phi]_v - te) = \det(g)\det([\phi]_v - te)\det(g^{-1}) = \det(g[\phi]_v g^{-1} - tgeg^{-1}) = \det([\phi]_u - te)$.
        }
    }
    \definition[Сингулярные собственные числа]{
        Корни $\chi_\phi$. Не путать с сингулярными числами (пусть они и не определялись).
    }
    Множество $\lambda$, для которых $\phi - \lambda e$ не является обратимым, называется \emph{спектром} оператора $\phi$.

    \theorem{
        Для конечномерного пространства $V$ над полем $K$ сингулярные собственные числа $\phi$ совпадают с собственными числами $\phi$.
        \provehere{
            Зафиксируем базис и отождествим $V = K^n$.
            Также отождествим $\phi$ и $[\phi]$.

            Для собственного числа $\lambda \in K$ найдётся собственный вектор $v \in V$, такой, что $\phi v = v \lambda \iff (\phi - \lambda \id)v = 0$.

            По теореме Крамера $\exists v \ne 0: (\phi - \lambda \id)v = 0 \iff \chi_\phi(\lambda) = \det(\phi - \lambda \id) = 0$.
        }
    }
    \note{
        Выше определённые собственные числа --- \emph{правые}.
        Можно определить левые собственные числа: $\ind{^n}K{} \map \ind{^n}K{}; \quad u \mapsto (u)\phi$. Всякий элемент $\lambda \in K$, такой, что $(u)\phi = \lambda u$ является \emph{левым собственным числом}.
        Для поля левые собственные числа и правые собственные числа совпадают с сингулярными собственными числами, то есть это всё одно и то же.
    }


    \section{Геометрическая и алгебраическая кратности собственного числа}
    \definition[\text{Собственное подпространство оператора $\phi$, отвечающее собственному числу $\lambda$}]{
        $V(\lambda) = \defset{v \in V}{\phi(v) = v \lambda}$.
    }
    Очевидно, что $V(\lambda)$ --- это подпространство, причём его размерность равна числу различных линейно независимых векторов с собственным числом $\lambda$.
    \definition[Геометрическая кратность собственного числа $\lambda$]{
        Размерность $V(\lambda)$.
    }
    \definition[Алгебраическая кратность собственного числа $\lambda$]{
        Кратность $\lambda$ как корня $\chi_\phi$.
    }
    \lemma{
        Геометрическая кратность $\lambda$ не превосходит алгебраической кратности.
        \provehere{
            Пусть $m$ --- геометрическая кратность $\lambda$. Значит, $\exists v_1, \dots, v_m$ --- линейно независимые собственные векторы для собственного числа $\lambda$.

            Выберем базис $V$, дополнив $(v_1, \dots, v_m)$. Теперь матрица $\phi$ имеет вид $[\phi] = \vect{\arr{c|c}{\vect{\lambda & & 0 \\  & \ddots & \\ 0 & & \lambda} & * \\\hline 0 & *}}$.
            Очевидно, характеристический многочлен делится на $(t - \lambda)^m$.
        }
    }
    \note{
        Если алгебраическая кратность собственного числа равна $1$, то она равна геометрической кратности.
    }
    \examples{
        \item Рассмотрим элементарную трансвекцию в каком-то базисе $[\phi] = \vect{1 & 1 \\ 0 & 1}$.

        С одной стороны, $\chi_\phi(t) = (t - 1)^2$.

        С другой стороны, $\vect{1 & 1 \\ 0 & 1}\vect{a \\ b} = \vect{a + b \\ b}\lambda$ выполняется для произвольного $\lambda$ только если $b = 0$, то есть геометрическая размерность единицы как собственного числа --- 1, что меньше алгебраической кратности 2.

        В частности, видим, что пространство не порождается собственными векторами, матрица не диагонализуема.
        \item Рассмотрим пространство $K[t]_{\le n}$ с оператором $\phi = \frac{\d}{\d t}$.
        В стандартном базисе: $[\phi] =  \vect{0 & 1 & & \dots & 0 \\ & 0 & 2 & &  \\ \vdots& & \ddots & \ddots & \\ & & & 0 & n \\ 0 &  & \dots &  & 0}$.

        Здесь $\chi_\phi(t) = (-t)^{n + 1}$. Алгебраическая кратность $n + 1$, геометрическая --- 1.
        \item Жорданова клетка $J(\lambda) = \vect{\lambda & 1 & & 0\\  & \ddots & \ddots & & \\ & & \ddots & 1 \\ 0& & & \lambda}_n$.
        Геометрическая кратность собственного числа $\lambda$ этой клетки равна 1, алгебраическая --- $n$.
    }


    \section{Корневые векторы. Корневое подпространство}
    По-прежнему $\phi \in \End_K(V)$.
    \definition[Корневой вектор $v \in V$ оператора $\phi$, отвечающий собственному числу $\lambda$]{
        Существует $m \in \N: (\phi - \lambda \id)^m (v) = 0$.
        Такое наименьшее $m$ называется высотой корневого вектора.
    }
    В частности, собственный вектор --- корневой вектор высоты 1.
    \definition[Подпространство корневых векторов высоты, не превосходящей $m$]{
        $V_m(\lambda) = \defset{v \in V}{(\phi - \lambda \id)^m(v) = 0}$.
    }
    Очевидна цепочка вложений $(V(\lambda) = )V_1(\lambda) \le V_2(\lambda) \le V_3(\lambda) \le \dots$

    Пространство конечномерно, цепочка стабилизируется.
    Можно заметить, что как только $V_m(\lambda) = V_{m + 1}(\lambda)$, так сразу $\forall k > m: V_k(\lambda) = V_m(\lambda)$.

    \theorem{
        Над алгебраически замкнутым полем всё пространство раскладывается в прямую сумму корневых подпространств, отвечающих собственному числу $\lambda$.
    \provehere{См. (\cref{about_root_decomposition}).    }
    }
    \example[Основной пример корневых векторов]{
        \definition[Экспоненциальные многочлены]{
            Конечная линейная комбинация мономов $t^m e^ {\lambda t}$, где $m \in \N_0, \lambda \in \R, e$ --- основание натурального логарифма.
        }
        Все мономы формально независимы и образуют кольцо экспоненциальных многочленов $\Exp_\R$ с умножением, определённым как обычно:
        \[t^m e^{\lambda t} \cdot t^n e^{\mu t} = t^{m + n} e ^{(\lambda + \mu)t}\]

        Также в данном кольце определено дифференцирование $\frac{\d}{\d t}\left(t^m e^{\lambda t}\right) = mt^{m-1}e^{\lambda t} + \lambda t^m e^{\lambda t}$.

        Заметим, что
        \begin{gather*}
            \left(\frac{\d}{\d t} - \lambda \id\right)\left(t^m e^{\lambda t}\right) = m t^{m - 1}e ^{\lambda t} \\
            \left(\frac{\d}{\d t} - \lambda \id\right)^2\left(t^m e^{\lambda t}\right) = m(m -1) t^{m - 1}e ^{\lambda t} \\
            \left(\frac{\d}{\d t} - \lambda \id\right)^m\left(t^m e^{\lambda t}\right) = m! \cdot e ^{\lambda t} \\
            \left(\frac{\d}{\d t} - \lambda \id\right)^{m+1}\left(t^m e^{\lambda t}\right) = 0
        \end{gather*}
    Таким образом, $t^m e^{\lambda t}$ --- корневой вектор, отвечающий собственному числу $\lambda$, высоты $m + 1$.
    }


    \section{Теорема Кэли --- Гамильтона}
    Отождествим эндоморфизм $\phi$ c его матрицей $[\phi]$.

    Заметим, что $\chi_{\phi}(\phi) = 0$, то есть
    \[\vect{a & b \\c & d}^2 - (a + d)\vect{a & b \\ c & d} + (ad - bc)\vect{1 & 0 \\ 0 & 1} = 0\]
    Для матриц $2 \times 2$ это заметил Гамильтон, для матриц $3 \times 3$ --- Кэли, Фробениус обобщил.


    \subsection{Алгебраическое доказательство}
    Формально, пусть $R$ --- произвольное коммутативное кольцо, $x \in M(n, R)$.
    \theorem[Кэли --- Гамильтон]{\label{Hamilton-Caley}
        $\chi_x(x) = \ev_x(\det(x - te)) = 0$.
        \provehere[Алгебраическое доказательство]{
            По теореме Крамера $x^\#\cdot x = x\cdot x^\# = \det(x) e$, где $x^\# = \adj(x)$.
            Запишем \[(x - te)^\#(x - te) =  \chi_x(t) e\]
            Это равенство в кольце $M(n, R[t]) \cong M(n, R)[t]$
            \[\left[\text{изоморфизм состоит в вынесении $t$ за матрицы:} \vect{1 - t & 0 \\ 0 & 1 - t} \leftrightarrow \vect{1 & 0 \\ 0 & 1} + \vect{-1 & 0 \\ 0 & -1}t\right]\]
            В равенство хочется подставить $t \leftarrow x$.
            Если получится нуль, то значит действительно $\chi_x(x) = 0$.

            При рассмотрении данного равенства, как равенства в $M(n, R[t])$ подстановка ничего интересного, по-видимому, не даст:
        мы хотим, чтобы $x - te$ стало нулём, а подстановка даст матрицу из $M(n, R[x])$, где $R[x]$ --- многочлены от данной матрицы, факторкольцо кольца многочленов.
        \[\left.\vect{x_{1,1} - t &\dots& x_{1,n} \\ \vdots&\ddots&\vdots \\ x_{n,1} &\dots& x_{n,n} - t}\right|_{t \leftarrow x} = \vect{x_{1,1}e - x &\dots& x_{1,n}e \\ \vdots&\ddots&\vdots \\ x_{n,1}e  &\dots& x_{n,n}e - x}\]
    Если же рассматривать данное равенство, как равенство в $M(n, R)[t]$, то априори подставлять $t \leftarrow x$ нельзя, так как можно утверждать о сохранении равенства при эвалюации только если коэффициенты коммутируют с элементом алгебры, который планируется подставить.

            Пусть $(x - te)^\# = b_{n-1}t^{n-1} + b_{n-2}t^{n-2} + \dots + b_0$, где $b_i \in M(n, R)$.\\
            Пусть $\chi_x(t) = c_n t^n + \dots + c_0$, где $c_i \in R$.\\
            В этих терминах равенство переписывается в $M(n, R)[t]$ следующим образом
            \[(b_{n-1}t^{n-1} + b_{n-2}t^{n-2} + \dots + b_0) \cdot (x - te) = (c_n t^n + \dots + c_0)e\]
            \indentlemma{
            Утверждается, что $x$ коммутирует со всеми $b_i$ (поэтому его можно подставить в данное равенство).
            }{Докажем, что матрица $b_{n-i}$ является многочленом от $x$ степени $i - 1$.
                Это доказывать мы будем по индукции, причём пользоваться будем  написанным выше равенством в $M(n, R)[t]$.

                Записав равенство коэффициентов при $t^{n-i}$, получаем \[b_{n - i}x - b_{n - 1 - i}e = c_{n - i}e\text{ для }0 \le i < n\text{ (здесь формально $b_n = 0$)}\]
                Сразу получаем $b_{n-1} = -c_n e$;\ $b_{n-1-i}=-c_{n-i}e + b_{n-i}x$.
            }
        Таким образом, эвалюация данного равенства $t \leftarrow x$ сохранит его справедливость, а левая часть очевидным образом обратится в нуль.
        }
        \subsection{Геометрическое доказательство}
        \definition[Алгебраическое замыкание]{
            Такое поле $\overline{K}$, что оно алгебраически замкнуто и все элементы $\overline{K}$ алгебраичны над $K$.
        }
        \intfact[Теорема Штейница]{
            Для любого $K$ существует (и единственно с точностью до изоморфизма) алгебраическое замыкание $\overline{K}$.
        }
        \provehere[Геометрическое доказательство теоремы Кэли --- Гамильтона]{
            Здесь будем рассматривать $x$ как матрицу некоего $\phi \in \End_K(V)$.

            Рассмотрим многочлен $\chi_\phi(t)$ с коэффициентами в некотором расширении $K$ --- конкретно, в алгебраическом замыкании.
            Будем считать $K = \overline{K}$ --- если в $\overline{K}: \chi_\phi(\phi) = 0$, то это же верно и в $K$.

            У $\chi_\phi$ есть корень, назовём его $\lambda$.

            $\chi_{\phi}(t) = (t - \lambda) f(t), \lambda \in K, f \in K[t], \deg f \le n - 1$.

            Собственному числу $\lambda$ соответствует вектор $\underset{\ne 0}{v} \in V$, такой, что $\phi(v) = v \lambda$.
            Разложим $V$ в прямую сумму $V = vK \oplus U$.
            \[[\phi] = \vect{\arr{c|c}{\lambda & * \\\hline 0 & \left[\phi\big|_{V/vK}\right]}}\]
            $\phi\big|_{V/vK} \eqqcolon \psi \in \End_K(U)$.

            Дальше будем действовать по индукции по $n$.
            Индукционное предположение звучит так: $\forall u \in U: f(\phi)(u) \in vK$, то есть матрица $f(\phi)$ выглядит следующим образом:
            \[[f(\phi)] = \vect{\arr{c|c}{\lambda & * \\\hline 0 & 0}}\]

            Теперь $\chi_\phi(\phi) = (\phi - \lambda \id) f(\phi) $ и $\forall w \in V: (\phi - \lambda \id)\cdot \underbrace{f(\phi)(v)}_{v\mu} = (\phi - \lambda \id) v \mu = 0$.
        }
    }
    \newlection{7 апреля 2023 г.}


    \section{Примарное разложение}
    Самым сложным случаем оказывается тот, когда минимальный многочлен (или характеристический) имеют примарный вид --- степень неприводимого.

    \subsection{Минимальный многочлен вектора относительно оператора}
    $\phi \in \End(V)$, причём $\dim_K V < \infty$.
    Рассмотрим $v \in V, f \in K[t]$.
    \definition[Многочлен $f$ аннулирует $v$ относительно $\phi$]{
        $f(\phi)(v) = 0$, то есть $v \in \Ker(f(\phi))$.
    }
    Теперь рассмотрим аннулятор $\Ann(\phi, v) \bydef \defset{f \in K[t]}{f(\phi)(v) = 0}$.
    Напомним, что просто аннулятор $\Ann(\phi) \bydef \defset{f \in K[t]}{f(\phi) = 0}$.
    \lemma{
        $\Ann(\phi, v) \normeq K[t]$.
    }
    \definition[Минимальный многочлен вектора $v$ относительно $\phi$]{
        Нормированный многочлен $\theta_{\phi, v}$, порождающий $\Ann(\phi, v)$, как идеал.
    }
    \lemma{
        $\Ann(\phi) = \bigcap\limits_{v \in V}\Ann(\phi, v)$
    }
    \corollary{
        Для любого $v \in V$ минимальный многочлен $\theta_{\phi, v}$ делит минимальный многочлен $\theta_\phi$.
    }
    Ещё можно заметить, что так как $\theta_\phi \divs \chi_{\phi}$, то $\theta_{\phi, v} \divs \chi_\phi$.
    \corollary{
        Делителей многочлена конечное число, значит, $\{\theta_{\phi, v}\}_{v \in V}$ конечно.
    }

    \subsection{Ядро операторного многочлена}
    Рассмотрим оператор $\phi \in \End_K(V)$;
    зафиксируем многочлен $f \in K[t]$.
    Какие векторы он аннулирует?

    \lemma{
        Если $f, g \in K[t]$, то $\Ker(f(\phi))$ инвариантно относительно $g(\phi)$.
        \provehere{
            Рассмотрим $v \in \Ker(f(\phi))$. Покажем $g(\phi)(v) \in \Ker(f(\phi))$:
            \[f(\phi)(g(\phi)(v)) = (f(\phi) \cdot g(\phi))(v) = (g(\phi)\cdot f(\phi))(v) = g(\phi)(\underbrace{f(\phi)(0)}_{0}) = 0\qedhere\]
        }
    }
    \lemma{
        Если $f, g \in K[t], f \divs g$, то $\Ker(f(\phi)) \le \Ker(g(\phi))$.
        \provehere{
            Пусть $g = hf$. Тогда если $f(\phi)(v) = 0$, то $g(\phi)(v) = (hf)(\phi)(v) = h(0) = 0$.
        }
    }
    \theorem{\label{yet_another}
    Пусть $f, g, h \in K[t]; f = gh$, где $g\perp h$ --- взаимно просты.

    Тогда $\forall \phi \in \End_K(V): \Ker(f(\phi)) = \Ker(g(\phi)) \oplus \Ker(h(\phi))$.
    \provebullets{
        \item

        Так как $K[t]$ --- PID, то есть кольцо Безу, то $\exists p, q \in K[t]: pg + qh = 1$.

        Эвалюация в $\phi$:
        \[p(\phi)g(\phi) + q(\phi)h(\phi) = \id\]
        Применим к произвольному вектору $v \in V$:
        \[v = p(\phi)(g(\phi)(v)) + q(\phi)(h(\phi)(v))\]
        \item Покажем $\Ker(g(\phi)) \cap \Ker(h(\phi)) = \{0\}$.

        В самом деле, если $v \in \Ker(g(\phi)) \cap \Ker(h(\phi))$, то $v = 0 + 0$.
        \item Покажем $\Ker(g(\phi)) + \Ker(h(\phi)) = \Ker(f(\phi))$.

        Пусть $v \in \Ker(f(\phi))$.
        Опять же,    запишем \[v = p(\phi)(g(\phi)(v)) + q(\phi)(h(\phi)(v))\]
        Первое слагаемое лежит в $\Ker(h(\phi))$, второе --- в $\Ker(g(\phi))$.

        Согласно лемме, применение $p(\phi)$ ничего не меняет --- $p(\phi)(g(\phi)(v))$ тоже лежит в ядре $\Ker(h(\phi))$.
    }
    }

    \subsection{Примарное разложение}
    $\phi \in \End_K(V)$, рассмотрим $\chi_\phi = (-1)^n p_1^{m_1}\proddots p_s^{m_s}$, где $p_i \in K[t]$ --- неприводимые, нормированные многочлены.

    \definition[Примарное подпространство]{
        $V^{p_i} = \Ker(p_i^{m_i}(\phi))$ --- аналог корневого подпространства.
    }
    \theorem[О примарном разложении]{
        $V = V^{p_1} \oplus \dots \oplus V^{p_s}$.
        \provehere{
            Теорема Гамильтона --- Кэли~(\cref{Hamilton-Caley}) + (\cref{yet_another}) + индукция по $s$.
        }
    }

    \subsubsection{Случай алгебраически замкнутого поля}
    Все неприводимые многочлены имеют степень 1.
    В таком случае $\chi_\phi(t) = (\lambda_1 - t)^{m_1} \proddots (\lambda_s - t)^{m_s}$.

    $V^{t - \lambda}$ --- в точности корневое подпространство, отвечающее собственному числу $\lambda$.
    \theorem[О корневом разложении]{\label{about_root_decomposition}
        Если $\chi_\phi$ разложим на линейные множители, как выше (в частности, если $K$ --- алгебраически замкнутое поле), то
        $V = V^{\lambda_1} \oplus \dots \oplus V^{\lambda_s}$.
    }
    Для приведения оператора к каноническому виду достаточно привести его, ограниченного на корневые подпространства.


    \section{Теорема о жордановой форме}
    Ограничим $\psi \coloneqq \phi\big|_{V^{\lambda_i}}$.

    Ограниченный оператор имеет единственное собственное число;\ $\chi_\psi = (\lambda - t)^n$.

    Чтобы было ещё удобнее, будем считать, что $\lambda = 0$ --- вместо $\psi$ рассмотрим $\psi - \lambda \id_{V^\lambda}$.

    Теперь $\chi_{\psi}(t) = (-t)^n$, то есть $\psi^n = 0$ или $\psi$ --- нильпотентен.

    Как выглядит нильпотентный оператор?
    Например, так: \[\vect{0 &  & * \\  & \ddots & \\ 0 & & 0}\]
    Рассмотрим ещё более специфичный случай
    \[J_n(0) = \vect{0 & 1 & & 0 \\ & \ddots & \ddots & \\ & & \ddots & 1 \\ 0 & & & 0};\text{ прибавим $\lambda \id$ обратно: } J_n(\lambda) = \vect{\lambda & 1 & & 0 \\ & \ddots & \ddots & \\ & & \ddots & 1 \\ 0 & & & \lambda}\]
    Оказывается, над полем ничего другого не бывает.
    \definition[Жорданова клетка (жорданов блок) степени $n$ с собственным числом $\lambda$]{
        Выше изображённая матрица $J_n(\lambda)$.
    }
    \theorem{
        Если $\phi$ --- оператор, такой, что его характеристический многочлен разложим над $K$ на линейные множители: $\chi_\phi = \prod\limits_{i = 1}^{s}(t - \lambda_i)^{n_i}$, то в пространстве $V$ существует базис, в котором матрица $\phi$ имеет вид
        \[J_{m_1}(\mu_1) \oplus \dots \oplus J_{m_t}(\mu_t) = \vect{J_{m_1}(\mu_1) & & 0 \\ & \ddots & \\ 0 & & J_{m_t}(\mu_t)}\]
        где $m_1 + \dots + m_t = n = \dim_K(V)$, а $\mu_i \in \{\lambda_i\}$. Быть может, $\mu_i = \mu_j$, но типы жордановых клеток --- пары $(m_i, \mu_i)$ --- определены однозначно.
    }
    \definition[Жорданов базис]{
        Базис, в котором $\phi$ имеет вышеописанный вид.
    }
    Если многочлен не разложим на линейные множители, то возникнут Фробениусовы клетки в разложении в прямую сумму.
    Впрочем, возникает трудный вопрос о единственности.
    \newlection{11 апреля 2023 г.}

    \subsection{Жорданов базис нильпотентного оператора}
    Пусть $\phi \in \End(V)$ над произвольным полем, нильпотентен: $\exists m: \phi^m = 0$.

    Обозначим за $m$ \emph{ступень нильпотентности} $\phi$ --- наименьшее $m$, такое, что $\phi^m = 0$.
    По определению, $\Ker(\phi^{m - 1}) \lneqq \Ker(\phi^m) = V$.
    \lemma{
        Если $v_1, \dots, v_s \in \Ker\left(\phi^{k + 1}\right)$ и линейно независимы относительно $\Ker\left(\phi^k\right)$, то
        $\phi(v_1), \dots, \phi(v_s) \in \Ker(\phi^k)$ (очевидно) и линейно независимы относительно $\Ker(\phi^{k - 1})$.
        \provehere{
            Пусть $\phi(v_1)\lambda_1 + \dots + \phi(v_s)\lambda_s \in \Ker(\phi^{k - 1})$.

            Тогда $\phi(v_1 \lambda_1 + \dots + v_s \lambda_s) \in \Ker(\phi^{k - 1})$, и $v_1 \lambda_1 + \dots + v_s \lambda_s \in \Ker(\phi^{k})$, откуда $\lambda_1 = \dots = \lambda_s = 0$.
        }
    }
    Рассмотрим цепочку $\{0\} \lneqq \Ker(\phi) \lneqq \Ker(\phi^2) \dots \lneqq \Ker(\phi^m) = V$.

    \numbers{
        \item[$m$.] Пусть $v_1^{m}, \dots, v_{n_1}^{m}$ --- базис $V$ относительно $\Ker(\phi^{m - 1})$.

        \item[$m - 1$.] Рассмотрим $\phi(v_1^m), \dots, \phi(v_{n_1}^m)$ --- линейно независимые векторы $\Ker(\phi^{m - 1})$ относительно $\Ker(\phi^{m - 2})$.
        Дополним их до базиса $\Ker(\phi^{m - 1})$ относительно $\Ker(\phi^{m - 2})$, добавив векторы $v_1^{m - 1}, \dots, v_{n_2}^{m - 1}$.

        \item[$m - 2$.] Ко всем векторам на предыдущем уровне ещё раз применим $\phi$:
        \[\phi^2(v_1^m), \dots, \phi^2(v_{n_1}^m), \phi(v_1^{m - 1}), \dots, \phi(v_{n_2}^{m - 1})\]
        Дополним их до базиса $\Ker(\phi^{m - 2})$ относительно $\Ker(\phi^{m - 3})$, добавив векторы $v_1^{m - 2}, \dots, v_{n_3}^{m - 2}$.

        \item[$\le m - 3$.] И так далее.
        \item [1.] На данном шаге получается набор векторов $\phi^{m - 1}(v_1^m), \dots, \phi^{m - 1}(v_{n_1}^m), \phi^{m - 2}(v_1^{m-1}), \dots, \phi^{m - 2}(v_{n_2}^{m-1}), \dots$, независимых в $V$ относительно $\{0\}$.

        Дополним их до абсолютного базиса $\Ker(\phi)$, он же --- относительный базис $\Ker(\phi)$ относительно $\{0\}$.
    }
    \theorem{
        Полученные векторы $\phi^i(v_j^k)$ --- базис $V$.
        \provehere{
            Очевидно из того, что (для $U \le V$) объединение базиса $U$ и базиса $V$ относительно $U$ --- базис $V$.
        }
    }
    Получили жордановы башенки следующего вида:
    % https://q.uiver.app/?q=WzAsMTYsWzAsMCwidl8xXjEiXSxbMCwxLCJcXGJ1bGxldCJdLFswLDIsIlxcYnVsbGV0Il0sWzAsNCwiXFxidWxsZXQiXSxbMSwxLCJ2XzJeMSJdLFsxLDIsIlxcYnVsbGV0Il0sWzEsMywiXFxidWxsZXQiXSxbMSw0LCJcXGJ1bGxldCJdLFsyLDEsInZfMl4yIl0sWzIsMiwiXFxidWxsZXQiXSxbMiwzLCJcXGJ1bGxldCJdLFsyLDQsIlxcYnVsbGV0Il0sWzMsMywidl80XjEiXSxbMyw0LCJcXGJ1bGxldCJdLFs0LDQsInZfNV4xIl0sWzAsMywiXFxidWxsZXQiXSxbMCwxLCJcXHBoaSJdLFsxLDIsIlxccGhpIl0sWzQsNSwiXFxwaGkiXSxbNSw2LCJcXHBoaSJdLFs2LDcsIlxccGhpIl0sWzgsOSwiXFxwaGkiXSxbOSwxMCwiXFxwaGkiXSxbMTAsMTEsIlxccGhpIl0sWzEyLDEzLCJcXHBoaSJdLFsyLDE1LCJcXHBoaSJdLFsxNSwzLCJcXHBoaSJdXQ==
    \[\begin{tikzcd}
    {v_1^1}
          \\
          \bullet & {v_2^1} & {v_2^2} \\
          \bullet & \bullet & \bullet \\
          \bullet & \bullet & \bullet & {v_4^1} \\
          \bullet & \bullet & \bullet & \bullet & {v_5^1}
          \arrow["\phi", from=1-1, to=2-1]
          \arrow["\phi", from=2-1, to=3-1]
          \arrow["\phi", from=2-2, to=3-2]
          \arrow["\phi", from=3-2, to=4-2]
          \arrow["\phi", from=4-2, to=5-2]
          \arrow["\phi", from=2-3, to=3-3]
          \arrow["\phi", from=3-3, to=4-3]
          \arrow["\phi", from=4-3, to=5-3]
          \arrow["\phi", from=4-4, to=5-4]
          \arrow["\phi", from=3-1, to=4-1]
          \arrow["\phi", from=4-1, to=5-1]
    \end{tikzcd}\]
    где цепочек высоты $k$ будет $n_{m - k}$.
    Башне высоты $k$ соответствует жорданова клетка $J_k(0) = \vect{0 & 1 & & 0\\ & \ddots & \ddots & \\ & & \ddots & 1 \\ 0 & & & 0}$.
    Клеток $J_k(0)$ будет $n_{m - k}$, а $\phi = \underbrace{J_m(0) \oplus \dots \oplus J_m(0)}_{n_1} \oplus \dots \oplus \dots$

    Осталось доказать единственность в некотором смысле.

    Это видно из следующей выкладки: \gather{n_1 = \codim(\Ker(\phi^{m - 1}), V)\\n_2 = \codim(\Ker(\phi^{m - 2}), \Ker(\phi^{m - 1})) - n_1 \\ n_3 = \codim(\Ker(\phi^{m - 3}), \Ker(\phi^{m - 2})) - n_1 - n_2 }
    Таким образом, количество жордановых клеток данного размера зависит только от коразмерностей ядер, не зависят от выбора базиса.

    \note{
        Для разложения оператора $\phi$ с характеристическим многочленом $(t - \lambda)^n$ надо рассмотреть оператор $\phi - \lambda \id$, после чего прибавить $\lambda\id$ обратно.
    }


    \section{Сепарабельные многочлены, совершенные поля}
    Пусть $f \in K[t]$.
    \definition[$f$ --- сепарабельный]{
        $f \perp f'$.
        Так как $K[t]$ --- PID, то $K[t]f + K[t]f' = K[t]$.
    }
    \example{
        Допустим, $f(x) = (x - c)^2 g(x)$.
        Тогда $f'(x) = 2(x - c)g(x) + (x - c)^2 \cdot g'(x)$.
        Это же можно записать для $f = p^2 g$ --- все многочлены такого вида не сепарабельны.

        Таким образом, сепарабельный многочлен не имеет кратных корней (ни в одном расширении поля $K$).
    }
    Обратно, если $f = p_1 \proddots p_m$, где $p_i \in K[t]$, различны (с точностью до ассоциированности) и неприводимы \textbf{и все $p_i$ сепарабельны}, то $f$ сепарабелен.
    \definition[Совершенное поле $K$]{
        Все неприводимые многочлены над $K[t]$ сепарабельны.
    }
    \examples[Совершенные поля]{
        \item Любое поле характеристики 0.
        \item Алгебраически замкнутое поле. (Все неприводимые многочлены --- $(x - c)$, они сепарабельны по определению).
        \item Все конечные поля.
    }
    \counterexample[Не все поля совершенны]{
        \item Пусть $\chr(K) = p > 0$. Поле $K(x)$ несовершенно:

        Рассмотрим $y \coloneqq x^{\nicefrac{1}{p}}$ --- элемент какого-то расширения $K(x)$. Он является корнем своего минимального многочлена ${\theta_y(t) \coloneqq t^p - x \in K(x)[t]}$.

        $\theta_y' = 0$, значит, $\gcd(\theta_y, \theta_y') = \theta_y$, откуда $\theta_y$ не является сепарабельным.

        Многочлен $\theta_y$ неприводим ($x^{\nicefrac{1}{p}}$ не является рациональной функцией), но в расширении поля, где есть $y$, многочлен $\theta_y$ разложим на линейные множители: $\theta_y(t) = (t - y)^p$.
    }
    К счастью, этот пример является единственным в некотором роде.
    \intfact{
        Все совершенные поля --- поля, для которых эндоморфизм Фробениуса ($\Frob_p: K \map K, \Frob_p(x) = x^p$) сюръективен.
    }


    \section{Разложение Жордана --- Шевалле}
    Пусть $K$ --- совершенное поле.

    Рассмотрим $x \in M(n, K)$.
    \definition[Полупростая матрица] {
        Диагонализуемая над каким-то расширением матрица.
        Над совершенным полем достаточно взять алгебраическое замыкание.
    }
    \definition[Унипотентная матрица]{
        Такая матрица $x$, что $x - e$ --- нильпотентна, то есть все собственные числа $x - e$ равны 0.
    }

    \intfact[Аддитивное разложение Жордана --- Шевалле]{
        $\forall x \in M(n, K): \exists! x_s, x_n \in M(n, K)$, такие, что
        \numbers{
            \item $x_s$ --- полупростая.
            \item $x_n$ --- нильпотентна.
            \item $x = x_s + x_n$.
            \item $x_s x_n = x_n x_s$.
        }
        Утверждается, что, более того, такие матрицы $x_s$ и $x_n$ являются многочленами от $x$.
        \provehere{
            Перейдём к алгебраическому замыканию $K$, разложим $J_n(\lambda) = \lambda \id + J_n(0)$.
            Доказательство единственности сложнее.
        }
    }

    \intfact[Мультипликативное разложение Жордана --- Шевалле]{
        $\forall x \in GL(n, K): \exists! x_s, x_u \in M(n, K)$, такие, что
        \numbers{
            \item $x_s$ --- полупростая.
            \item $x_u$ --- унипотентна.
            \item $x = x_s x_u$.
            \item $x_s x_u = x_u x_s$.
        }
        Утверждается, что, более того, такие матрицы $x_s$ и $x_u$ являются многочленами от $x$.
    }
    \newlection{12 апреля 2023 г.}


    \section{Вещественные жордановы формы}
    Пусть $V$ --- векторное пространство над $\R$.

    Рассмотрим $V_\C = V \ind{}{\otimes}{_\R} \C$.
    Что такое это в общем случае --- непонятно, но здесь это значит, что для базиса $V$ $(e_1, \dots, e_n)$ над $\R$ у пространства $V_\C$ базис --- $(e_1, \dots, e_n)$ над $\C$.

    Это называется \emph{комплексификация} $V$.
    Вещественный базис комплексификации --- $(e_1, e_1 i, \dots, e_n, e_n i)$, где $i$ --- мнимая единица.
    Можно сказать, что комплексификация имеет двойную размерность.

    Всякому оператору  $\phi: V \map V$ сопоставляется \emph{комплексификация оператора} $\phi: V_\C \map V_\C$.
    Воспользовавшись тем, что мы зафиксировали базис, мы определим комплексификацию, как оператор с той же матрицей: $M(n, \R) \hookrightarrow M(n, \C)$.

    Можно привести матрицу $\phi$ к жордановому виду над $\C$.
    Вспомнив, что $\phi$ --- вещественный оператор, получаем $\chi_\phi(t) \in \R[t]$.
    Таким образом, его корни --- либо вещественные числа, либо пары сопряжённых комплексных.

    \lemma{
        Если $u$ --- корневой вектор $\phi$, отвечающий собственному числу $\lambda \in \C \sm \R$ высоты $m$, то
        $\overline{u}$ --- корневой вектор той же высоты и собственного числа $\overline{\lambda}$.
        \provehere{
            $(\phi - \lambda \id)^m(u) = 0 \quad \then \quad \left(\overline{\phi - \lambda \id}\right)^m\left(\overline{u}\right) = 0$ --- пользуемся тем, что комплексное сопряжение --- автоморфизм.
        }
    }
    \corollary{
        Жордановы клетки комплексно сопряжённых пар тоже бьются на пары одной размерности.
    }
    Значит, для приведения комплексной жордановой формы к какой-то хорошей вещественной, надо преобразовать $J_m(\lambda) \oplus J_m(\overline{\lambda})$.

    Вспомним, что $\vect{\lambda & 0 \\ 0 & \overline{\lambda}} \sim \vect{a & b \\ -b & a}$ для $\lambda = a + bi$.
    \[\vect{\lambda & & 0 \\ & \ddots &  \\ 0 & & \lambda} \oplus \vect{\overline{\lambda} & & 0 \\ & \ddots &  \\ 0 & & \overline{\lambda}} = \vect{\arr{c|c|c}{\arr{c c}{a & b \\ -b & a} & \arr{c c}{1 & 0 \\ 0 & 1} & 0 \\\hline & \ddots & \arr{c c}{1 & 0 \\ 0 & 1}\\\hline & & \arr{c c}{a & b \\ -b & a}}}\]
    Эти матрицы тоже сопряжены:
    \provehere{
        Если $J_m(\lambda)$ отвечает базису $u_1, \dots, u_m$, то $J_m(\overline{\lambda})$ отвечает базису $\overline{u_1}, \dots, \overline{u_m}$.

        Тогда матрица из $M(2m, \R)$ отвечает базису $(\frac{u_1 + \overline{u_1}}{2}, \frac{u_1 - \overline{u_1}}{2i}, \dots) = (\Re(u_1), \Im(u_1), \dots)$.
    }
    Зафиксируем результат.
    \theorem{
        Матрица любого оператора $\phi \in \End_\R(V)$ приводится к виду прямой суммы клеток двух типов --- $J_m(\lambda)$ для $\lambda \in \R$ и клеток $J_m(a, b): a, b \in \R, b \ne 0$.

        При этом числа и размеры клеток определены однозначно.
    }


    \section{Циклические подпространства, фробениусовы клетки}
    Пусть $\phi \in \End_K(V)$, $v \in V$.
    \definition[Циклическое подпространство оператора $\phi$, порождённое вектором $v$]{
        Наименьшее $\phi$-инвариантное подпространство в $V$, содержащее $v$.
    }
    \lemma{
        Циклическое подпространство, порождённое $v$ --- это $\angles{v, \phi(v), \phi^2(v), \dots}$.
    }
    Если $n = \dim V$, то $v, \phi(v), \dots, \phi^n(v)$ линейно зависимы.
    Возьмём наибольшее $m \in \N: \phi^0(v), \dots, \phi^{m - 1}(v)$ линейно независимы:

    Значит, $\phi^m(v) \in \angles{\phi^0(v), \dots, \phi^{m - 1}(v)}$:
    \[\phi^m(v) = \phi^0(v)\alpha_0 + \dots + \phi^{m - 1}(v)\alpha_{m - 1}\]
    откуда циклическое подпространство --- $\angles{\phi^0(v), \dots, \phi^{m - 1}(v)}$.

    \lemma{
        $\phi\big|_{\angles{\phi^0(v), \dots, \phi^{m - 1}(v)}}$ в этом базисе имеет матрицу \[B(f) \bydef \underset{\text{(сопровождающая матрица многочлена $f$, фробениусова клетка)}}{\vect{0 & & & 0 & \alpha_0 \\ 1 & & & & \alpha_1 \\ & & \ddots & & \vdots\\ 0 & & & 1 & \alpha_{m - 1}}}\]
        где $f = t^m - \alpha_{m - 1}t^{m - 1} - \dots - \alpha_1 t - \alpha_0$.
    }
    \note{
        $\chi_{B(f)} = (-1)^mf$.
    }
    Разложим характеристический многочлен $\phi$ на произведение примарных множителей  $p_1^{m_1} \proddots p_s^{m_s}$.
    Пространство разложится в сумму примарных подпространств $V = V^{p_1} \oplus \dots \oplus V^{p_s}$, на которых $\chi_{\phi|_{V^{p_i}}} = \pm p_i^{m_i}$.
    \intfact{
        Любое примарное пространство раскладывается в прямую сумму циклических.

        Любой оператор приводится к прямой сумме фробениусовых клеток, отвечающих примарным многочленам.
    }


    \chapter{Классификация модулей над PID}


    \section{Нормальная форма Смита}
    Доказана Смитом над $\Z$, над произвольным PID --- Фробениусом.

    \subsection{Над евклидовым кольцом}
    $x \in M(m, n, R)$, где $R$ --- евклидово кольцо с нормой $\delta: R \map \N_0 \cup \{-\infty\}$.

    Если бы вместо кольца было поле, то матрицу можно было бы привести к окаймлённому виду $\vect{\arr{c | c}{e & 0 \\\hline 0 & 0}}$

    \theorem{
        Если $R$ евклидово, то $\forall x \in M(m, n, R): \exists h \in E(m, R), g \in E(n, R)$, такие, что $hxg = \vect{\arr{c | c}{\arr{c c c}{\eps_1 & & 0 \\ & \ddots & \\0 &  & \eps_k} & 0 \\\hline 0 & 0}}$,
        где $\eps_1 \divs \eps_2 \divs \cdots \divs \eps_k$, причём $\eps_i$ определены однозначно с точностью до ассоциированности.
        \provehere{
            Рассмотрим множество \[\mathcal{M} \coloneqq \defset{hxg}{h \in E(m, R), g \in E(n, R)}\] и множество элементов матриц из $\mathcal{M}$\[\mathcal{D}\coloneqq\defset{m_{i,j}}{m \in \mathcal{M}, 1 \le i \le n, 1 \le j \le m}\]
            \bullets{
                \item Либо $x = 0$, тогда она уже приведена к необходимому виду.

            \item Либо в множестве $\mathcal{D}$ есть элементы кроме $0$.
                Выберем среди них элемент с минимальной нормой $\delta$.
                Так как перестановки содержатся в $E(n, R)$ и в $E(m, R)$, то можно считать, что для неких $h, g$ этот элемент --- $(hxg)_{1,1}$.
            }

            Заменим для удобства $x$ на эту матрицу, теперь $x_{1,1}$ имеет минимальную норму в $\mathcal{D}$.
                \[\vect{\arr{c | c c c}{x_{1,1} & x_{1,2} & \dots & x_{1,n} \\\hline x_{2,1} & & & \\ \vdots & &*& \\ x_{m,1} & & &}}\]
        Заметим, что $x_{1,1}$ делит все остальные $x_{1,j}$ и $x_{i,1}$, так как иначе можно было бы получить элемент меньшей нормы, чем $\delta(x_{1,1})$ с помощью одного шага алгоритма Евклида ($y = x_{1,1}q + r$, где $\delta(r) < \delta(x_{1,1})$, значит, с помощью трансвекции получаем $r = y - x_{1,1}q$).

                Применим элементарные преобразования, получим
                \[\vect{\arr{c | c c c}{x_{1,1} & 0  & \dots &0  \\\hline 0 & & & \\ \vdots & &*& \\ 0 & & &}}\]
                Дальше по индукции ненулевые числа останутся только на неком префиксе главной диагонали.

        Тот факт, что $x_{1,1} \divs x_{2,2}$ можно видеть, если прибавить вторую строчку к первой --- в противном случае опять можно было бы получить элемент в $\mathcal{D}$ меньшей нормы, чем $x_{1,1}$.

            Единственность разложения следует из того, что результирующие $x_{i,i}$ можно найти из формул:
            \gather{x_{1,1} = \gcd(\mathcal{D}) = \gcd(x_{i,j}, 1 \le i \le n, 1 \le j \le m) = \gcd(\text{миноры первого порядка})\\
            x_{2,2} = \frac{\gcd(\text{миноры второго порядка})}{x_{1,1}}\\
            x_{3,3} = \frac{\gcd(\text{миноры третьего порядка})}{x_{1,1} \cdot x_{2,2}}}

        Эти инварианты не меняются (с точностью до ассоциированности) при домножении на элементы $E(n, R)$ или $E(m, R)$, а ещё однозначно задают нормальную форму.
        }}
    \corollary{
        Над евклидовым кольцом

        $SL(n, R) = E(n, R)$ --- матрицы с единичным определителем и группа, порождённая элементарными трансвекциями.

        $GL(n, R) = GE(n, R)$ --- обратимые матрицы и матрицы, порождённые элементарными трансвекциями и псевдоотражениями.
    }
    \counterexample[Хитрая PID]{
        Возьмём локализацию $\Z[t]$ относительно мультипликативной системы $S \coloneqq \angles{\Phi_n|n \in \N}$, где $\Phi_n$ --- круговой многочлен номера $n$, то есть минимальный многочлен над $\Q$, делящий $x - \omega_n$, ($\omega_n^n = 1$).

        В данном кольце главных идеалов $E(n, R) \ne SL(n, R)$.
    }

    \subsection{Над PID}
    Пусть $R$ --- PID.
    \theorem{
        Для матрицы $x \in M(m, n, R)$ существует $h \in SL(m, R), g \in SL(n, R)$, такие, что $hxg = \vect{\arr{c | c}{\arr{c c c}{\eps_1 & & 0 \\ & \ddots & \\0 &  & \eps_k} & 0 \\\hline 0 & 0}}$
        где $\eps_1 \divs \eps_2 \divs \cdots \divs \eps_k$, причём $\eps_i$ определены однозначно с точностью до ассоциированности.
        \indentlemma{
            Любая унимодулярная строчка (строка с комаксимальными элементами) длины 2 дополняется до матрицы с определителем 1.
        }{
            $aR + bR = R \then \exists u, v \in R: au + bv = 1$.
            Матрица $\vect{a & b \\ -v & u}$ искомая:  $\abs{\arr{c c}{a & b \\ -v & u}} = 1$
        }
        \indentlemma{
            Если $R$ --- PID, то $a \perp b \then aR + bR = R$.
            $\exists g \in SL(2, R): \vect{a & b}g = \vect{d & 0}$ где $d = \gcd(a, b)$.
        }{
            Строчку $\vect{\nicefrac{a}{d} & \nicefrac{b}{d}}$ надо достроить до $SL(2, R)$:
        пусть $\abs{\arr{c c}{\nicefrac{a}{d} & \nicefrac{b}{d} \\ -u & v}} = 1$.
            Тогда \[\vect{a & b}\cdot \vect{v & -\nicefrac{b}{d}\\ u & \nicefrac{a}{d}} = \vect{d & 0}\text{, причём} \vect{v & -\nicefrac{b}{d}\\ u & \nicefrac{a}{d}} \in SL(2, R)\qedhere\]
        }
        \newlection{18 апреля 2023 г.}
        \provehere[Доказательство формы Смита для PID]{
            По индукции.

            Пусть $\vect{\arr{c|c c}{x_{1,1} & \dots & x_{1,n}\\\hline\vdots &*& \\ x_{n,1} & & }} = x \in M(m, n, R)$.

            Умножая справа, её можно привести к виду $\vect{\arr{c|c c}{d & \cdots & 0\\\hline\vdots &*& \\ y_{n,1} & & }}$, где $d = \gcd(x_{1,1}, \dots, x_{1,n})$.

            Дальше, умножив слева, мы приводим все к виду $\vect{\arr{c|c c}{d' & \cdots & z_{1,n}\\\hline\vdots &*& \\ 0 & & }}$, где $d' = \gcd(d, y_{2, 1}, \dots, y_{n, 1})$.
            Так, умножая то справа, то слева, мы (так как PID $\then$ нётерово кольцо, и всякий раз идеал растёт), мы в какой-то момент придём к матрице
            $\vect{\arr{c|c c}{\eps_1 & \cdots & 0\\\hline\vdots &*& \\ 0 & & }}$.

            Дальше по индукции, приводим оставшуюся матрицу к диагональной.

            $\vect{\eps_1 & 0 \\ 0 & \eps_2} \sim \vect{\eps_1 & \eps_2 \\ 0 & \eps_2} \sim \vect{\gcd(\eps_1, \eps_2) & 0 \\ * & *} \underset{\text{все преобразования были с определителем 1}}{\sim} \vect{\gcd(\eps_1, \eps_2) & 0 \\ 0 & \lcm(\eps_1, \eps_2)}$, поэтому после приведения нижнего правого прямоугольника к хорошему виду можно добиться преобразования, такие, что $\eps_1 \divs \eps_2$.
        }
    }

    \section{Подмодули кручения, модули без кручения}
    Пусть $M$ --- модуль над коммутативным кольцом $R$.

    Обычно будем предполагать, что $R$ --- область целостности.

    \definition[Элемент кручения $x \in M$] {
        $\exists \lambda \in \Reg R$ --- не делитель 0 --- такой, что $\lambda x = 0$.
        Также такой элемент называют \emph{периодическим}.
    }
    Обозначим $T(M) \bydef \defset{x \in M}{\exists \lambda \in \Reg R: \lambda x = 0}$ --- множество элементов кручения.
    \lemma{
        $T(M) \le M$ --- подмодуль.
        $T(M / T(M)) = \{0\}$, то есть $M / T(M)$ --- модуль без кручения.
        \provebullets{
            \item Пусть $x, y \in T(M)$. $\exists \lambda, \mu \in \Reg R: \lambda x = \mu y = 0$.
            Тогда $\lambda \mu (x + y) = 0$, но $\lambda \mu \in \Reg R$.

            Теперь покажем, что $x \in T(M) \then \mu x \in T(M)$: $\lambda (\mu x) = \mu (\lambda x) = 0$.

            \item От противного: пусть $\exists x \notin T(M), \exists \lambda \in \Reg R: \lambda x \in T(M)$.
            Значит, $\exists \mu \in \Reg R: \mu \lambda x = 0$. Тогда $x \in T(M)$ с множителем $\mu\lambda$.
        }
    }
    \definition[Модуль $M$ без кручения]{
        $T(M) = \{0\}$
    }
    \definition[Модуль кручения, периодический модуль]{
        $T(M) = M$.
    }


    \section{Формулировка основных теорем о строении конечнопорождённых модулей над PID}
    Пусть $R$ --- PID, $M$ --- свободный модуль.
    \theorem{\label{free_submodule}\down
    \numbers{
        \item Подмодуль $N$ свободного модуля свободен и $\rk N \le \rk M$.
        \item Конечнопорождённый модуль без кручения свободен.
        \item Если $M$ --- конечнопорождён, то $M\cong R^n \oplus T(M)$.
    }
    }
    \provehere{
        (\cref{lemma1}) и ниже.
    }
    \definition[Циклический модуль $M$]{
        $M$ порождён одним элементом: $M = Rx$.
    }
    Посмотрим на отображение $\phi: R \map M: \lambda \mapsto \lambda x$.
    У гомоморфизма есть ядро $\Ann_R(x) \bydef \Ker(\phi)$ --- \emph{аннулятор} $x$.

    По теореме о гомоморфизме $M \cong R / \Ann_R(x)$.
    \bullets{\item Если $\Ann_R(x) = \{0\}$, то модуль свободен и изоморфен $R$.

    \item Если $\Ann_R(x) \ne \{0\}$, то $M$ --- модуль кручения.
    Так как $R$ --- PID, то $\Ann_R(x) = R\lambda$ для некоего $\lambda \in R$ --- для порождающего $\Ann_R(x)$.
    }

    \theorem{
        Любой конечнопорождённый периодический модуль является прямой суммой циклических подмодулей.
    }
    \corollary{
        Любой конечнопорождённый периодический модуль является прямой суммой примарных циклических подмодулей.
        Примарный циклический модуль --- модуль вида $R/p_1^{m_1}R$.
    \provehere{
        Китайская теорема об остатках: \[R/(p_1^{m_1}\proddots p_s^{m_s})R \cong (R/p_1^{m_1}R) \oplus \dots \oplus (R/p_s^{m_s}R)\qedhere\]
    }
    }
    \theorem[О существовании согласованных базисов для подмодулей свободного модуля]{
        Пусть $N \le M \cong R^n$. Тогда $\exists (e_1, \dots, e_n)$ --- базис в $M$, $\exists \lambda_1, \dots, \lambda_m \in R: \lambda_1 \divs \cdots \divs \lambda_m$, причём $N = \angles{\lambda_1 e_{1}, \dots, \lambda_m e_{m}} \cong R^m$.
        \provehere{
            См. (\cref{good_basises}).
        }
    }

    \subsection{Вложение конечнопорождённых модулей без кручения в свободные модули}
    \theorem{\label{lemma1}
    Пусть $R$ --- область целостности, $M$ --- конечнопорождённый модуль без кручения.
    Тогда для некоего $n$: $M$ можно вложить в $R^n$ так, чтобы он имел ненулевое пересечение со всеми координатными осями.
    \provehere{
        $M$ порождено элементами $\angles{x_1, \dots, x_m}$.
        Пусть $y_1, \dots, y_n \in M$ --- максимальная линейно независимая система.
        Построим $R^n$ на системе образующих $\angles{e_1, \dots, e_n}$.

%            Устроим гомоморфизм $\psi: R^m \map M, e_i \mapsto x_i$ --- существует по универсальному свойству базиса.
%            $\{y_i\}$ порождают модуль, гомоморфизм сюръективен.
%
%            Пусть $v_i \coloneqq \psi^{-1}(y_i)$.
%            Рассмотрим подмодуль $R^m \ge \angles{v_1, \dots, v_n}$.
%            Прообразы $v_1, \dots, v_n$ линейно независимы --- если $\lambda_1 v_1 + \dots + \lambda_n v_n = 0$, то применим $\psi$.
%
%            Перейдём к $K \coloneqq Q(R)$. $v_1 K + \dots + v_n K \le K^m$.

        Рассмотрим подмодуль в $M \ge \angles{y_1, \dots, y_n} \eqqcolon N$.
        Построим вложение $M \overset{\phi}\rightarrow N$.
        $N \cong R^n$ --- просто переводим базис $\{y_i\}$ в базис $\{e_i\}$ --- поэтому данное вложение изоморфно искомому $M \map R^n$.

        $\forall x_i: (x_i, y_1, \dots, y_n)$ --- линейно зависимая система.
        Тогда $\exists \lambda_i \ne 0: \lambda_i x_i \in N$.

        Устроим вложение следующим образом: для $\lambda = \lambda_1\proddots \lambda_m \ne 0$ положим
        \[\phi: M \map N; \qquad x \mapsto \lambda x\]
        Оно инъективно, так как модуль $M$ --- без кручения. $\phi(M) \cap Ry_i \ne \{0\}$, так как там есть $\lambda y_i$.
    }
    }
    \corollary{1. в (\cref{free_submodule}).
    Если $R$ --- PID, $M$ --- свободный модуль конечного ранга, то $\forall N \le M$: $N$ свободен, причём $\rk N \le \rk M$.
    \provehere{
        Индукция по рангу $M$.

        \underline{База:} $\rk M = 1$, $M \cong R$.
        Все подмодули имеют ранг 0 или 1 --- это идеалы в кольце.

        \underline{Переход:} $M \cong R^n$. Построим проекцию $\pi: R^n \map R^{n - 1}, \vect{x_1 \\ \vdots \\x_{n-1}\\ x_n} \mapsto \arr{c}{\vect{x_1 \\ \vdots \\ x_{n-1}}\\~}$.

        $N \le M \then \pi(N) \le R^{n - 1}, \Ker\left(\pi\big|_N\right) \le \Ker \pi \cong R$. Подмодули в $R$ мы знаем, $\Ker \left(\pi\big|_N\right) = \{0\}$, либо $\Ker\left(\pi\big|_N\right) \cong R$.

        Воспользовавшись индукционным предположением, получаем, что $\pi(N)\cong R^{l}$, где $l \le n - 1$.
        Если $\Ker\left(\pi\big|_N\right) = \{0\}$, то $N \cong R^l$.
        Иначе $\Ker(\pi) \cong R$, тогда $N \cong R^{l + 1}$.
    }
    }
    \corollary{
    Конечнопорождённый модуль без кручения над PID свободен.
    }
    \theorem{
        Если $M$ --- конечнопорождённый, то $M = R^n \oplus T(M)$.
        \provehere{
            $M / T(M)$ --- модуль без кручения, причём тоже конечнопорождён.
            Значит, $M / T(M) \cong R^n$ для некоего $n \in \N$. Пусть $R^n = \angles{e_1, \dots, e_n}$, поднимем базис до некоторых $f_1, \dots, f_n \in M$ (то есть для всех $i$ образ $f_i$ внутри $M/T(M)\cong R^n$ равен $e_i$). Несложно проверить, что $M \cong T(M) \oplus \angles{f_1, \dots, f_n}$, при этом $f_1, \dots, f_n$ линейно независимы.
            \precaution{Если $M \cong A/B$, где $B \le A$ --- подмодуль, то совсем необязательно $A \cong M \oplus B$. Скажем, $\Z/(2\Z) \cong \Z/2\Z$, но, конечно, неправда, что $\Z \cong \Z \oplus \Z/2\Z$. Однако, как мы видели выше, это правда, если $M$ свободен.\qedhere}
        }
    }
    Таким образом, (\cref{free_submodule}) полностью доказана.


    \section{Согласованный выбор базисов в свободном модуле и его подмодуле}
    \theorem{\label{good_basises}
    Пусть $N \le M \cong R^n$. Тогда $\exists (e_1, \dots, e_n)$ --- базис в $M$, $\exists \lambda_1, \dots, \lambda_m \in R: \lambda_1 \divs \cdots \divs \lambda_m$, причём $N = \angles{\lambda_1 e_{1}, \dots, \lambda_m e_{m}} \cong R^m$.
    \provehere{
        Пусть $u_1, \dots, u_n$ --- базис в $M$, $v_1, \dots, v_m$ --- базис в $N$. Разложим $v$ по базису $u$:
        \[\vect{v_1 \\\vdots \\ v_m} = x\vect{u_1 \\ \vdots \\ u_n}\] где $x \in M(m, n, R)$.
        При замене базиса векторы $v, u$ домножаются слева на матрицы из $h \in SL(m, R)$ и $g \in SL(n, R)$ соответственно.

        При этом над $x$ будут совершаться преобразования $x \rightsquigarrow h^{-1}xg$, то есть $x$ можно привести к нормальной форме Смита:
        \[\vect{\lambda_1 e_1 \\ \vdots \\ \lambda_m e_m} = \vect{\arr{c|c}{\arr{c c c}{\lambda_1 & & 0 \\ & \ddots & \\0 & & \lambda_n} & 0}}\vect{e_1 \\ \vdots \\ e_n}, \quad \lambda_1 \divs \cdots \divs \lambda_m\]
    }}
    \newlection{19 апреля 2023 г.}
    \theorem{
        Любой конечнопорождённый модуль $M = \angles{u_1, \dots, u_n}$ над PID является прямой суммой циклических.
        \provehere{
            Рассмотрим сюръекцию $\phi: R^n \map M, e_i \mapsto u_i$.
            Положим $N \coloneqq \Ker(\phi)$.

            $N$ --- подмодуль свободного модуля, он свободен. Пусть $(v_1, \dots, v_m)$ --- базис $N$.

            Выразим базисы через матрицу перехода: $\vect{v_1 \\ \vdots \\ v_m} = x\vect{e_1 \\ \vdots \\ e_n}$, $x \in M(m, n, R)$.
            Воспользовавшись для $x$ канонической формой Смита, можно выбрать согласованные базисы, так, что $\forall i = 1..m: v_i = e_i \lambda_i$, причём $\lambda_1 \divs \cdots \divs \lambda_n$.

            Таким образом, $M \cong R^{n - m} \oplus (R/\lambda_1 R) \oplus (R/\lambda_m R)$.

            По китайской теореме об остатках получаем, что любой модуль является прямой суммой свободных и примарных модулей.
        }
    }

    \subsection{Частные случаи}
    \numbers{
        \item $R = \Z$ --- конечнопорождённые абелевы группы.

        Согласно ранее доказанной теореме, любая абелева группа \[G \cong \Z^m \oplus \underbrace{\Z/p_1^{m_1}\Z}_{c_{{p_1}^{m_1}}} \oplus \dots \oplus \Z/p_s^{m_s}\Z\]
        где $p_i \in \P, m_i \in \N, p_i$ могут повторяться, но пары $(p_i, m_i)$ определены однозначно.

        Такие группы, соответствующие примарным числам, называются \emph{элементарными абелевыми группами}.

        К сожалению, классифицировать что-то более сложное, даже метабелевые группы (группы, содержащие абелеву подгруппу, фактор по которой абелев) --- задача несоизмеримо большей сложности.
        Классификация метабелевых групп влечёт классификацию пары матриц над полем, а это --- дикая задача.

        \item $R = K[t]$ --- форма Фробениуса.
        Пусть $V$ --- конечномерное векторное пространство над $K$, $\phi \in \End_K(V)$.

        $(V, \phi)$ имеет структуру $K[t]$ модуля: $t \cdot v = \phi(v)$. Модуль, очевидно --- модуль кручения (например, по теореме Кэли --- Гамильтона).

        Значит, $V \cong \bigoplus K[t]/\left(p^m K[t]\right)$, на каждом подпространстве $\phi$ имеет примарный характеристический многочлен.

        Значит, любой оператор имеет базис, в котором его матрица --- прямая сумма фробениусовых клеток.
    }


    \chapter{Геометрия пространств со скалярным произведением}


    \section{Скалярные произведения}
    $K$ --- поле, $V$ --- векторное пространство над $K$ ($\dim V < \infty$).
    \definition[Скалярное произведение]{
        Отображение $B: V \times V \map K$, удовлетворяющее следующим свойствам:
        \numbers{
            \item Билинейность.
            \item Рефлексивность $B(u, v) = 0 \iff B(v, u) = 0$.
        }
    }
    \definition[Ортогональные векторы]{
        $u \perp v \iff B(u, v) = 0$.
    }
    \definition[Симметрическое скалярное произведение]{$\forall u, v \in V: B(u, v) = B(v, u)$.}
    \definition[Кососимметрическое скалярное произведение]{$\forall u, v \in V: B(u, v) = -B(v, u)$.}
    \note{Если характеристика 2, то кососимметрическое скалярное произведение --- симметрическое.}
    \definition[Симплектическое скалярное произведение]{
        Любой вектор \emph{изотропен}: $\forall u \in V: B(u, u) = 0$.
    }
    \note{
        В эрмитовом скалярном произведении $B(u, v) = \overline{B(v, u)}$, например, в гильбертовом пространстве над $\C$.
    }
    \fact{
        Симплектическое и кососимметрические произведения связаны:

        симплектическое всегда кососимметрическое, обратное верно не в характеристике 2.
        \gather{0 = B(u + v, u + v) = B(u, u) + B(u, v) + B(v, u) + B(u, u) = B(u, v) + B(v, u)\\
        B(u, u) = -B(u, u) \then 2B(u, u) = 0
        }
    }
    \definition[Невырожденное скалярное произведение]{
        $\forall u \in V: u \ne 0 \then \exists v: B(u, v) \ne 0$.
    }
    \examples{
        \item $(K^n, B)$, где $B\left(\smallvect{u_1 \\ \vdots \\ u_n}, \smallvect{v_1 \\ \vdots \\ v_n}\right) = u_1 v_1 + \dots + u_n v_n = u^t v$.

        Если $K = \R$, то это евклидово скалярное произведение, обладающее свойствами
        \bullets{
            \item Анизотропность: $B(u, u) \ne 0$ для $u \ne 0$.
            \item Положительная определённость: $B(u, u) \ge 0$, причём $B(u, u) = 0 \iff u = 0$.
        }
        \item Можно выбрать базис и $r$, в котором скалярное произведение имеет вид:
        \[B(u, v) = u_1 v_1 + \dots + u_r v_r - u_{r+1}v_{r+1} - \dots - u_n v_n\]
        Такое скалярное произведение пишут в пространстве $\R^{r,s}$ ($r + s = n$), самое известное --- пространство Минковского $\R^{3,1}$.
        \item $B(u, v) = u_1 v_n + u_2 v_{n - 1} + \dots + u_n v_1$ --- расщепимое скалярное произведение.
        \item Пусть $n = 2m$. \[B(u, v) = (u_1 v_2 - u_2 v_1) + \dots + (u_{2m-1}v_{2m} - u_{2m}v_{2m-1})\]
        Это пример симплектического скалярного произведения.
        \item $V = M(n, K)$. Здесь можно выбрать $B(x, y) = \tr (x^t y)$
    }

    \subsection{<<Классификация>> билинейных скалярных произведений}
    \theorem{
        Любое билинейное рефлексивное $B: V \times V \map K$ --- симметрическое или симплектическое (в характеристике 2 может выполняться одновременно и то, и то).
        \provehere{
            Рассмотрим $u, v, w \in V$, вычислим \[B(u, vB(u, w) - wB(u, v)) = B(u, v)B(u, w) - B(u, w)B(u, v) = 0\]
            Из рефлексивности в другом порядке тоже 0:
            \begin{equation}
                \label{eq1}0 = B(vB(u,w) - wB(u, v), u) = B(v, u)B(u, w) - B(w, u)B(u, v)
            \end{equation}
            Подставим $w = u$:
            \begin{equation}
                \label{eq2}B(u,u)(B(u, v) -  B(v, u)) = 0
            \end{equation}
            Таким образом, если $B(u, u) \ne 0$, то $\forall v: B(u, v) = B(v, u)$, а если $B(u, v) \ne B(v, u)$, то $B(u,u) = B(v,v) = 0$.

            Докажем, что если найдутся такие $u, v \in V: B(u, v) - B(v, u) \ne 0$, то все векторы изотропны.
            Пусть нашлись. Тогда выберем $w \in V$, предположим, что $B(w,w) \ne 0$.

            Посчитаем \gather{B(v,u+w)=B(v,u) + B(v,w) \\ B(u+w, v) = B(u, v) + B(w, v)}
            Первые слагаемые неравны по предположению, вторые --- равны, так как $B(w,w)\ne0$~\eqref{eq2}.
            Значит, $B(v, u + w) \ne B(u + w, v)$, откуда~\eqref{eq2} $B(u + w, u + w) = 0$.

            Кроме того, из~\eqref{eq1} видим, что так как $B(u, v) \ne B(v, u)$, но $B(u, w) = B(w, u)$, то $B(u, w) = B(w, u) = 0$.
            Отсюда, раскрыв скобки в $B(u + w, u + w) = 0$ действительно получаем, что $B(w,w) = 0$.
        }
    }


    \section{Матрица Грама скалярного произведения}
    $V, (e_1, \dots, e_n)$ --- пространство и базис.
    \definition[Симплектическое пространство]{
        Пара $(V, B)$ <<пространство --- скалярное произведение>>, если $B$ --- симплектическое.
    }
    \definition[Квадратическое пространство]{
        Пара $(V, B)$ <<пространство --- скалярное произведение>>, если $B$ --- симметрическое.
    }
    \note{
        Термин \emph{симметрическое пространство} уже зарезервирован под что-то другое, а в связи с симметрическим скалярным произведением будут возникать квадратичные формы, поэтому термин таков.
    }
    \definition[Матрица Грама]{
        $G_e(B) = (B(e_i, e_j))_{1 \le i, j \le n}$.
    }
    \lemma{
        Записав векторы столбцами координат в данном базисе, получаем $B(u, v) = u^t G_e(B) v$.
        \provehere{
            \[B(u, v) = B(u_1 e_1 + \dots + u_n e_n, v_1 e_1 + \dots + v_n e_n) = \sum\limits_{i,j}u_i B(e_i,e_j)v_j = u^t G_e(B) v\qedhere\]
        }
    }
    \lemma{
        $B$ --- симметрическое $\iff G_e(B)$ симметрическая ($G_e(B) = G_e(B)^t$).

        $B$ --- симплектическая $\iff G_e(B)$ антисимметрическая ($G_e(B)^t = -G_e(B)\land G_e(B)_{i,i} = 0$).
    }
    \lemma{
        Скалярное произведение $B$ невырождено $\iff G_e(B)$ невырождена.
        \provehere{
            $B$ вырождено $\iff \exists v \ne 0: \forall u: B(u, v) = 0 \iff \forall u: u^t G_e(B) v = 0 \iff G_e(B)v = 0 \iff G_e(B)$ вырождена.
        }
    }
    \newlection{24 апреля 2023 г.}
    \lemma{
        При замене базиса матрица Грама преобразуется по формуле $G_{e'}(B) = g^t G_e(B) g$, где $g$ --- матрица перехода.
        \provehere{
            Пусть $g$ --- матрица перехода от базиса $(e_i)_{i = 1}^{n}$ к базису $(e'_i)_{i = 1}^{n}$: \[\vect{e_1 & \dots & e_n}g = \vect{e'_1 & \dots & e'_n}\]

            Тогда координаты преобразуются контравариантно: $g^{-1}\vect{u_1 \\ \vdots \\ u_n} = \vect{u'_1 \\ \vdots \\ u'_n}; \quad \vect{u_1 \\ \vdots \\ u_n} = g\vect{u'_1 \\ \vdots \\ u'_n}$.

            Получаем, что $(gu')^t\cdot G_e(B)\cdot(gv') = (u')^t \cdot g^t G_e(B) g \cdot v'$.
        }
    }
    \note{
        Если матрица $x$ симметрическая ($x^t = x$), то $g^t x g$ --- тоже симметрическая: \[(g^t x g)^t = g^t x^t g^{tt} = g^t x g\]
    }
    \note{
        Задача поиска канонической формы матриц $x$ относительно преобразований $g^t x g$ не решена, хотя, казалось бы, должна быть того же уровня сложности, что и каноническая форма относительно поиска базиса --- сопряжения $g^{-1}xg$.

        Это связано с тем, что идейно матрица Грама --- не матрица; она имеет два индекса, оба описывающие столбцы (или оба строки).
        Отсюда и появляется транспонирование первого вектора.
    }


    \section{Скалярное произведение и двойственные пространства}
    $V^* = \Hom_K(V, K)$ --- множество ковекторов (линейных функционалов).

    Базису $(e_1, \dots, e_n)$ сопоставляется двойственный базис $(e_1^*, \dots, e_n^*)$, такой, что $e_i^*(e_j) = \delta_{i,j}$.

    Рассмотрим пространство всех билинейных отображений $L(V, V; K) = \defset{B: V \times V \map K}{B \text{ --- билинейно}}$.
    Оказывается, есть канонический изоморфизм между $L(V, V; K)$ и $\Hom(V, V^*)$.

    Пусть $B: V \times V \map K$ --- билинейно.
    Сопоставим ему парциальные отображения \[\ind{_u}B{} \bydef B(u, \cdot): V \map K; \qquad \ind{}B{_v}\bydef B(\cdot, v): V \map K\]
    Полученные парциальные отображения линейны.

    Значит, отображение $\tilde{B}: u \mapsto \ind{_u}B{}$ бьёт из $V$ в $V^*$.
    Более того, оно само линейно, и задаёт биекцию, не зависящую от выбора базисов.

    \theorem{
        $L(V, V; K) \map \Hom(V, V^*); \quad B \mapsto \tilde{B}$ задаёт канонический изоморфизм $L(V, V; K)\cong \Hom(V, V^*)$.
        \provehere{
            Проверим, что отображение --- гомоморфизм: $\widetilde{B_1 + B_2} = \widetilde{B_1} + \widetilde{B_2}$ и $\tilde{\lambda B} = \lambda \tilde{B}$.

            Проверим, что $B \mapsto \tilde{B}$ обратимо: $B(u, v) = \tilde{B}(u)(v)$.
            Отсюда получаем инъективность, а сюръективность следует из теоремы о размерности ядра и образа --- мы работаем с конечномерными пространствами.

            $\dim(L(V, V; K)) = \dim(V) \cdot \dim(V) = \dim(V) \cdot \dim(V^*) = \dim(\Hom(V, V^*))$.
        }
    }
    \theorem{
        $B: V \times V \map K$ невырождено $\iff \tilde{B}: V \map V^*$ --- изоморфизм.
        \provehere{\up
        \gather{
            \forall u \ne 0: \exists v \in V: B(u, v) \ne 0 \\
            \Updownarrow\\
            \forall u \ne 0: B(u, \cdot) \ne 0\qedhere
        }
        }
    }
    \note{
        Получается, всякий раз, когда пишут транспонирование, задают изоморфизм $V \cong V^*$, который никак не является каноническим.
        Это уже не линейная алгебра, а евклидова геометрия. Транспонированию не место в канонической линейной алгебре!
    }
    \note{
        Если билинейная форма симметрическая, то $\forall u \in V: B(u, \cdot) = B(\cdot, u)$, то есть изоморфизмы фиксирования первого и второго аргумента одинаковы.

        Если билинейная форма симплектическая, то $\forall u \in V: B(u, \cdot) = -B(\cdot, u)$.
    }


    \section{Классификация пространств со скалярным произведением}
    Первый шаг классификации: скалярное произведение бывает симметрическим или симплектическим.

    Пусть $(U, B_U)$ и $(V, B_V)$ --- два пространства со скалярными произведениями.
    \definition[Изометрия пространств]{
        Изоморфизм векторных пространств $\phi: U \map V$, сохраняющий скалярное произведение: $B_U(u, v) = B_V(\phi(u), \phi(v))$.
    }
    \problem{
        Когда $(U, B_U) \cong (V, B_V)$?
    }
    Очевидные инварианты:
    \numbers{
        \item Размерность $n = \dim U = \dim V$ --- если равенства нет, то нет изоморфизма.
        \item Ранг $r \coloneqq \rk U \bydef \rk(G(B_U))$ --- не зависит от выбора базиса, замена базиса --- обратимая матрица.

        Можно также заметить, что $\rk(G(B_U)) = \rk\left(\tilde{B_U}\right)$.
        \item \up
        \definition[Дискриминант]{
            $\disc(V) = \left(\det(G(B_V))\cdot(K^*)^2\right)$ --- элемент $K/(K^*)^2$.
        }
        В частности, $\R^*/\R^{*2} \cong \{\pm 1\}; \quad \Ff_q^* / \Ff_q^{*2} \cong \{\pm 1\}$ для $q \in \P_{\ge 3}$.
    }
    \definition[Радикал $V$]{
        $\Rad(V) = \defset{u \in V}{\forall v \in V: B(u, v) = 0}$.
        Иначе говоря, $V^\perp$.
    }
    Пусть $V = \Rad(V) \oplus U$, где $U$ -- произвольное прямое слагаемое.
    Заметим, что $\Rad(U) = \{0\}$, иначе $\Rad(V)$ больше, чем предполагался.

    Значит, классификацию подпространств можно свести к классификации невырожденных подпространств.
    \theorem[О классификации симплектических пространств]{
        $U \cong V \iff \all{\dim U = \dim V \\ \rk U = \rk V}$.
        \provehere{
            См. (\cref{simplectic_classification})
        }
    }
    \corollary{
        Для любой чётной размерности существует единственное невырожденное симплектическое пространство.
        Примерами матриц Грама для этих изоморфных пространств являются следующие матрицы
        \[\underset{\text{так пишут физики}}{\vect{\arr{c | c}{0 & \arr{c c c}{1 & & 0 \\ & \ddots & \\ 0 & & 1} \\\hline \arr{c c c}{-1 & & 0 \\ & \ddots & \\ 0 & & -1} & 0}}} \underset{\text{так пишут топологи}}{\vect{\arr{c | c | c}{\arr{c c}{0 & 1 \\ -1 & 0} & & 0 \\\hline & \ddots & \\\hline 0 & & \arr{c c}{0 & 1 \\ -1 & 0} }}} \underset{\text{так пишут алгебраисты}}{\vect{\arr{c | c}{0 & \arr{c c c}{0 & & 1 \\ & \contradots & \\ 1 & & 0} \\\hline \arr{c c c}{0 & & -1 \\ & \contradots & \\ -1 & & 0} & 0}}}\]
    }
    \definition[Квадратически замкнутое поле $K$]{
        Такое поле, что $(K^*)^2 = K^*$, то есть $\forall x \in K: \exists y \in K: y^2 = x$.
    }
    \theorem{
        Если $K$ квадратически замкнуто и ${\chr(K) \ne 2}$, то квадратические пространства $U \cong V \iff \all{\dim(U) = \dim(V) \\ \rk(U) = \rk(V)}$.
        \provehere{См. (\cref{quadratic_classification}).        }
    }
    \corollary{
        В частности, над квадратически замкнутым полем в любой размерности существует единственное невырожденное квадратическое пространство.
    }
    \intfact{Над конечными полями --- ровно два пространства, с дискриминантом, являющимся и не являющимся полным квадратом.}
    \theorem[Закон инерции Сильвестра]{
        Над $\R$ поля со скалярным произведением определяются тремя инвариантами
        \numbers{
            \item $\dim(V) = n$.
            \item $\rk(V) = r = r^+ + r^-$.
            \item Сигнатура $s = r^+ - r^-$.
        }
        Здесь $r^+$ и $r^-$ --- количества положительных и отрицательных квадратов.

        В матрице Грама на главной диагонали стоит $r^+$ единиц, $r^-$ минус единиц, остальные --- нули.
        \provehere{См. (\cref{silvester_inertion_law})}
    }
    \newlection{25 апреля 2023 г.}


    \section{Ортогональное дополнение}
    $U \le V$ --- подпространство, $B: V \times V \map K$ --- скалярное произведение.
    \definition[Ортогональное дополнение]{
        $U^\perp \bydef \defset{v \in V}{\forall u \in U: B(u, v) = 0}$.
    }
    \note{
        Рефлексивность скалярного произведения влечёт, что можно не различать $\ind{}U{^\perp}$ и $\ind{^\perp}U{}$.
    }
    \precaution{
        Ортогональное дополнение не является дополнением: совсем не факт, что $U \oplus U^\perp = V$.
    }
    \properties{
        \item $\forall U \le V: U \cap U^\perp = \Rad(U) \bydef \defset{u \in U}{\forall u' \in U: B(u, u') = 0}$.
        \item $\Rad(V) = V^\perp$; $\{0\}^\perp = V$.
        \item $U^\perp \le V$.
        \item $U \le U^{\perp\perp}$ (равенство в случае невырожденного $V$: следствие~(\cref{orthogonal_dimension})).
        \item $U \rightsquigarrow U^\perp$ обращает включения: $U \le W \then W^\perp \le U^\perp$.
        \item $(U + W)^\perp = U^\perp \cap W^\perp$.
        \item $(U \cap W)^\perp \ge U^\perp + W^\perp$ (равенство в случае невырожденного $V$: следствие~(\cref{orthogonal_dimension})).
    }

    \subsection{Ортогональная прямая сумма}
    $(U, B_U), (V, B_V)$ --- два произвольных пространства (но либо оба симметрические, либо оба симплектические).

    Определим скалярное произведение на $U \oplus V$ следующим образом:
    \[B_{U \oplus V} : (U \oplus V) \times (U \oplus V) \map K; \qquad (u_1, v_2), (u_2, v_2) \mapsto B_U(u_1, u_2) + B_V(v_1, v_2)\]
    Так как $B((u, 0), (0, v)) = 0$ в данном определении, то $(U \oplus V, B_{U \oplus V})$ --- \emph{ортогональная прямая сумма}.
    \lemma{
        Определённая выше $B_{U \oplus V}$ --- скалярное произведение на $U \oplus V$.
    }
    Будем обозначать ортогональную прямую сумму $U \boxplus V \bydef (U \oplus V, B_{U \oplus V})$.

    Если $U, W \le V$ --- лежат в одном объемлющем пространстве, то прямая сумма $U \boxplus W$ --- внутренняя ортогональная прямая сумма --- существует если
    \numbers{
        \item $U \cap W = \{0\}$
        \item $U \perp W \noteiff U \le W^\perp \noteiff W \le U^\perp$.
    }
    \lemma{
        Пусть $U$ --- любое дополнение к $\Rad(V): U \oplus \Rad(V) = V$.

        Тогда $V = U \boxplus \Rad(V)$, причём $B_U$ невырождено.
        \provehere{
            Докажем лишь часть про невырожденность, первое очевидно.

            Если $\exists u \in U, u \ne 0: \forall v \in U: B(u, v) = 0$, то $\forall v \in V: v \in U + \Rad(V) \then B(u, v) = 0$ по линейности $B$, противоречие --- $B_U$ невырождено.
        }
    }

    \subsection{Теорема об ортогональном дополнении}
    \lemma{\label{orthogonal_dimension}
    Если $U$ невырождено, либо $V$ невырождено, то имеет место $\dim(U) + \dim(U^\perp) = \dim(V)$.
    \provehere{
        Вложению $U \overset{i}\hookrightarrow V$ отвечает $V^* \overset{i^*}\map U^*$ --- двойственное линейное отображение.
        Воспользуемся отображением $\tilde{B}: V \map V^*$. Найдём $\Ker(V \overset{\tilde{B}}\Map V^* \overset{i^*}\Map U^*) = \defset{v \in V}{\left(\underset{\in U}{u} \mapsto B(v, u)\right) = 0}$.
        Это $U^\perp$ по определению.

        Кроме того, $V \overset{\tilde{B}}\Map V^* \overset{i^*}\Map U^*$ сюръективно:
        \bullets{
            \item Если $U$ невырождено, то даже ${U \overset{i}\Map V \overset{\tilde{B}}\Map V^* \overset{i^*}\Map U^*}$ сюръективно --- $B_U$ невырождено.

            \item Иначе это верно, так как $V$ невырождено и $V \overset{\tilde{B}}\Map V^*$ --- сюръекция ($i^*$ --- просто сужение).
        }
        Используя теорему о размерности ядра и образа получаем, что $\dim(U) + \dim(U^\perp) = \dim(V)$.
    }
    }
    \precaution{
        Если $U \le V$, $V$ невырождено, то совсем необязательно $U$ невырождено.
        Например, $\dim(V) = 2, G(B) = \vect{0 & 1 \\ -1 & 0}$.
        Оба пространства размерности 1, натянутые на базисные векторы, вырождены.
    }
    \theorem{\label{orthogonal_decomposition}
    Если $U \le V, B_U$ невырождено, то $V = U \boxplus U^\perp$.
    \provebullets{
        \item $U \cap U^\perp = \Rad(U) = \{0\}$.
        \item По определению $U \perp U^\perp$.
        \item $\dim(U) + \dim\left(U^\perp\right) = \dim(V)$ согласно~(\cref{orthogonal_dimension}).
    }
    }
    \note{
        Может быть, что скалярное произведение на $U$ невырождено, но на $U^\perp$ --- вырождено.
        Тем не менее,
    }
    \theorem{
        Если $V$ невырождено, то $\forall U \le V: U = U^{\perp\perp}$.
        \provehere{
            Согласно~(\cref{orthogonal_dimension}) получаем $\dim(U) = \dim(U^{\perp\perp})$.
        }
    }
    \theorem{\label{was_it_proved_or_not}
    Если из пространств $V, U, U^\perp$ два невырождены, то и третье тоже, в этом случае разложения $V = U \boxplus U^\perp = U^\perp \boxplus U^{\perp\perp}$ симметричны по $U$ и $U^\perp$.
    \provebullets{
        \item Если $V$ невырождено, то (тривиально) $U^{\perp\perp} \ge U$, но согласно~(\cref{orthogonal_dimension}) наблюдается равенство.

        Если $U^\perp$ невырождено, то заменим $\all{U^\perp \rightsquigarrow U^{\perp\perp} \\ U \rightsquigarrow U^\perp}$, в дальнейшем доказательстве невырождено $U$.

        Таким образом, $\forall \underset{\ne 0}{u} \in U^\perp: \exists v \in U^\perp: B(u, v) \ne 0$ (иначе данный $u$ лежит в $U^{\perp\perp}$).
        Но это по определению невырожденность $U^\perp$.
        \item Если $U^\perp, U$ невырождены, то $\dim(U) + \dim(U^\perp) = \dim(V)$. Из невырожденности их пересечение пусто, откуда $V = U \oplus U^\perp$.
        \[\forall v \in V: \exists u \in U, u' \in U^\perp: v = u + u' \quad \then \quad B(v, \cdot) = B(u, \cdot) + B(u', \cdot)\]
        Так как $U$ невырождено, то найдётся $w \in U: B(u, w) \ne 0$. $B(u', w) = 0 \then B(v, w) \ne 0$.
    }
    }
    \corollary{
        Если в $V$ нашлось невырожденное подпространство, то можно взять к нему ортогональное дополнение, матрица Грама разложится на блоки в базисах $U$ и $U^\perp$:
        \[G(B) = \vect{\arr{c|c}{* & 0 \\\hline 0 & *}}\]
        Дальше можно пытаться раскладывать пространство по индукции в прямую сумму одномерных.
    }

    \subsection{Теорема Лагранжа о существовании ортогонального базиса в квадратичном пространстве}
    \definition[Ортогональный базис]{
        Базис $(e_1, \dots, e_n)$ пространства $V$, такой что $i \ne j \then B(e_i, e_j) = 0$.
    }
    В ортогональном базисе матрица Грама диагональна: $G(B) = \vect{a_1 && 0 \\ &\ddots&\\0 && a_n}, a_i \in K$.
    \theorem[Лагранж]{\label{orthogonal_basis_by_lagrange}
        $B: V \times V \map K$ --- симметрическая форма. Если ${\chr(K) \ne 2}$, то в любом пространстве над $K$ существует ортогональный базис.
        \provehere{
            \indentlemma{\label{anisotropic_vector}
            Если ${\chr(K) \ne 2}$, то в пространстве с ненулевым симметрическим скалярным произведением найдётся неизотропный вектор $v: B(v, v) \ne 0$.
            }{
                Пусть $B(u, v) \ne 0$. Тогда среди векторов $u, v, u + v$ хотя бы один неизотропен: $B(u, v) = \frac{1}{2}(B(u + v, u + v) - B(u, u) - B(v,v))$ и здесь существенно, что характеристика --- не 2.
            }
            Если $B = 0$, то всякий базис ортогонален, доказывать нечего.

            Если $B \ne 0$, то проведём индукцию по размерности.

            \underline{База:} В одномерном пространстве любой базис ортогонален.

            \underline{Переход:}
            Найдётся неизотропный $e_1 \in V$, тогда согласно~(\cref{was_it_proved_or_not}) $V = e_1 K \boxplus (e_1 K)^\perp$, по индукционному предположению $(e_1 K)^perp = \angles{e_2} \boxplus \dots \boxplus\angles{e_{n}}$.
        }
    }


    \section{Введение в теорию (Диксона --- ) Витта. Классификация симплектических пространств}
    Теория опубликована Виттом примерно в 1936 году, но Диксон показал примерно то же в 1905, в год рождения Витта.
    К сожалению, работа Диксона осталась незамеченной.

    \subsection{Выделение гиперболических плоскостей}
    $B: V \times V \map K$ --- произвольное скалярное произведение.

    Пусть $u \in V$ --- изотропный вектор.
    \definition[Анизотропное скалярное произведение]{
        $\forall u \in V, u \ne 0 \then B(u, u) \ne 0$.
    }
    \note{Анизотропные скалярные произведения изучаются в матанализе, и там хорошо, что они положительно определены.
    А в алгебре --- это, наоборот, мешает.}
    \definition[Гиперболическая плоскость $H$]{
        Двумерное пространство над $K$ с матрицей Грама $G(B_H) = \vect{0 & 1 \\ 1 & 0}$ или $G(B_H) = \vect{0 & 1 \\ -1 & 0}$.
    }
    \lemma{\label{extraction_of_hyperbolic_surface}
    Пусть $B$ невырождено, нашёлся $u \in V, u \ne 0, B(u, u) = 0$. Если $B$ симметрическое, то дополнительно предположим, что ${\chr(K) \ne 2}$.

    Тогда $u$ можно вложить в гиперболическую плоскость, то есть $\exists v \in V: B(u, v) = 1, B(v, v) = 0$.
    \provehere{
        В силу невырожденности $\exists w \in V: B(u, w) \ne 0$. Домножением $w$ на скаляр можно добиться того, что $B(u, w) = 1$.

        Так как $B(u, u) = 0 \ne B(u, w)$, то $\angles{u, w}$ --- пространство размерности 2.
        Матрица Грама данного пространства в базисе $(u, w)$ --- это $\vect{0 & 1 \\ \pm 1 & *}$.

        Если пространство симплектическое, то матрица уже имеет искомый вид.

        Иначе ($B$ симметрическое) элементарным преобразованием получаем, что искомая гиперболическая плоскость натянута на векторы $u, w + \alpha u$, где $\alpha$ подобрано таким образом, что
        \[B(w + \alpha u, w + \alpha u) = 0 \then B(w, w) + 2\alpha B(u, w) = 0 \then \alpha = -\frac{1}{2}\frac{B(w, w)}{B(u, w)}\]
    }
    }
    \note{
        Условие невырожденности $B$ можно ослабить до $u \notin \Rad(V)$.
    }
    \newlection{26 апреля 2023 г.}
    \theorem{
        Пусть $u \in V \sm \Rad(V)$ --- изотропный вектор, причём если $V$ квадратично, то дополнительно предполагаем, что ${\chr(K) \ne 2}$.

        Тогда $u$ можно включить в гиперплоскость $H \le V$, такую, что $H \boxplus H^\perp = V$.
        \provehere{
            По лемме $H$ существует;\ $H$ невырождена, значит достаточно сослаться на~(\cref{extraction_of_hyperbolic_surface}).
        }
    }

    \subsection{Классификация симплектических пространств}
    Пусть $K$ --- произвольное поле, $V$ --- симплектическое пространство над $K$.
    Тогда $V = \underbrace{H \boxplus \dots \boxplus H}_{l} \boxplus \Rad(V)$.

    \theorem{\label{simplectic_classification}
    Два симплектических пространства $U \cong V \iff \dim(U) = \dim(V)$ и ${\rk(U) = \rk(V)}$.
    \provehere{
        Количество гиперплоскостей --- это $\frac{1}{2}\rk$.
        Размерность радикала --- это $\dim - \rk$, причём все радикалы одной размерности изометричны.
    }
    }
    \corollary{
        Ранг симплектического пространства чётен.
    }
    \corollary{
        Невырожденные симплектические пространства существуют только в чётных размерностях.
    }


    \section{Квадратические пространства. Квадратичные формы}
    $V$ --- векторное пространство над $K$.
    Будем предполагать, что ${\chr(K) \ne 2}$, иначе всё намного сложнее.

    \definition[Квадратичная форма]{
        Отображение $Q: V \map K$, такое, что \numbers{
            \item $Q$ --- однородно степени 2: $Q(v\lambda) = Q(v)\lambda^2$.
            \item Поляризация формы $Q$ --- билинейное (симметрическое автоматически) скалярное произведение.
            \definition[Поляризация квадратичной формы $Q$]{
                Скалярное произведение \[B(u, v) \bydef \frac{1}{2}(Q(u + v) - Q(u) - Q(v))\]
            }
        }
    }
    \fact{
        Квадратичная форма --- скалярный квадрат: $Q(v) = B(v, v)$.
    }
    \theorem{
        Существует биективное соответствие между квадратичными формами и симметрическими скалярными произведениями.
        \provehere{
            В одну сторону --- поляризация, в другую --- скалярный квадрат.
        }
    }

    \subsection{Квадратичная форма в координатах}
    Пусть $V \ni x = x_1 e_1 + \dots + x_n e_n$.
    Тогда квадратичная форма --- однородный многочлен степени 2: \[Q(x) = B(x, x) = x^t G(B) x = \sum\limits_{i,j = 1}^{n}a_{i,j}x_i x_j = \sum\limits_{i < j}2a_{i,j}x_i x_j + \sum\limits_{i = 1}^{n}a_{i,i}x_i^2\]
    \theorem[Лагранж]{
        Пусть ${\chr(K) \ne 2}$. Любая квадратичная форма $Q: V \map K$ линейно невырожденной заменой переменных приводится к сумме квадратов:
        \[Q(x) = a_1 x_1^2 + \dots + a_n x_n^2,\quad a_i \in K\]
        \provehere{Есть ортогональный базис:~(\cref{orthogonal_basis_by_lagrange})}
    }


    \section{Классификация квадратичных пространств}

    \subsection{Над квадратично замкнутым полем}
    $K^* = (K^*)^2$, ${\chr(K) \ne 2}$.
    \definition[Ортонормированный базис $V$]{
        Ортогональный базис $V$, такой, что $B(e_i, e_i) \in \{0, 1\}$.
    }
    \theorem{\label{quadratic_classification}
    В любом квадратичном пространстве над квадратично замкнутым полем характеристики не 2 выполнимы следующие условия:
    \numbers{
        \item Существует ортонормированный базис.
        \item У квадратичных пространств ровно 2 инварианта: размерность и ранг.
        \item Любая квадратичная форма приводима к виду \[Q(x_1, \dots, x_n) = x_1^2 + \dots + x_r^2, \quad r \le n\]
        \item Всякое пространство приводимо к виду
        \[
            V = H \boxplus \dots \boxplus H \boxplus \Rad(V) \boxplus \underbrace{\angles{1}}_{\text{если $\rk V$ нечётен}}
        \]
        \provehere{
            Согласно теореме Лагранжа~(\cref{orthogonal_basis_by_lagrange}) найдётся ортогональный базис $(e_1, \dots, e_n)$.
            Переупорядочим базисные векторы так, что первые $r$ имеют ненулевой скалярный квадрат, остальные --- нулевой.

            После этого заменим $e_i \rightsquigarrow \frac{e_i}{\sqrt{B(e_i, e_i)}}, \quad i \le r$.

            Пункт 4 следует из того, что над таким полем (например, $K = \C$): $\smallvect{1 & 0 \\ 0 & 1} \sim \smallvect{0 & 1 \\ 1 & 0}$.

            А именно рассмотрим сначала матрицу $\smallvect{1 & 0 \\ 0 & -1}$: \[\all{B(e, e) = 1 \\ B(f, f) = -1 \\ B(e, f) = 0}\] Выберем новый базис $\left(\frac{e + f}{\sqrt{2}}, \frac{e - f}{\sqrt{2}}\right)$.
            Для него \[\all{B\left(\frac{e + f}{\sqrt{2}}, \frac{e + f}{\sqrt{2}}\right) = 0 \\ B\left(\frac{e + f}{\sqrt{2}}, \frac{e - f}{\sqrt{2}}\right) = 1\\ B\left(\frac{e - f}{\sqrt{2}}, \frac{e - f}{\sqrt{2}}\right) = 0}\]
            Таким образом, например, над полем $\R: \smallvect{1 & 0 \\ 0 & -1} \sim \smallvect{0 & 1 \\ 1 & 0}$.
            Над квадратичным полем можно заменить вектор $v \rightsquigarrow \sqrt{-1}\cdot v$, получается, над $K: \smallvect{1 & 0 \\ 0 & 1} \sim \smallvect{0 & 1 \\ 1 & 0}$.
        }
    }
    }

    \subsection{Над полем вещественных чисел (закон инерции Сильвестра)}
    Пусть $V$ --- пространство над $\R$ c симметрическим скалярным произведением.

    \note{Доказать также можно доказать для формально вещественных полей --- числа бывают отрицательные и положительные, а множество квадратов --- множество положительных чисел.}
    \definition[Ортонормированный базис $(e_1, \dots, e_n)$]{
        Ортогональный базис, такой, что $B(e_i, e_i) \in \{+1, -1, 0\}$.
    }
    \theorem{
        В $V$ существует ортонормированный базис.
        \provehere{
            Согласно теореме Лагранжа~(\cref{orthogonal_basis_by_lagrange}) найдётся ортогональный базис $(e_1, \dots, e_n)$.
            Переупорядочим базисные векторы так, что первые $r$ имеют ненулевой скалярный квадрат, остальные --- нулевой.

            После этого заменим $e_i \rightsquigarrow \frac{e_i}{\sqrt{|B(e_i, e_i)|}}, \quad i \le r$.
        }
    }
    Таким образом, ортонормированный базис есть, характеризуется тремя числами --- $r^+, r^-, n$.
    Являются ли они инвариантами?

    Ограничимся невырожденными пространствами: \[V_1 = U_1 \boxplus \Rad(V_1) \cong U_2 \boxplus \Rad(V_2) = V_2 \quad \then \quad U_1 \cong U_2\] (из-за единственности ранга $\dim\Rad(V_1) = \dim \Rad(V_2)$; разные прямые слагаемые к одному радикалу изометричны, так как в них можно выбрать базисы, где соответствующие векторы различаются на вектор из радикала).
    \theorem[Сильвестр]{
        Обозначим $\R^{p, q}$ как пространство с матрицей Грама \[\vect{\arr{c | c}{\arr{c c c}{1 && 0 \\ &\ddots& \\ 0 && 1} & 0 \\\hline 0 & \arr{c c c}{-1 && 0 \\ &\ddots& \\ 0 && -1}}}\] где размеры блоков $p$ и $q$ соответственно.

        Пространства $\R^{p,q}\cong \R^{s,t}$ изометричны $\iff (p, q) = (s, t)$.
        \provehere{
            Обозначим за $U^+, U^-, V^+, V^-$ пространства, натянутые на соответствующие базисные векторы.

            Предположим, что $p > s$. Рассмотрим отображение $U^+ \hookrightarrow U \cong V \overset{\text{pr}}{\Map} V^+$, где $\text{pr}$ --- проекция на $V^+$ вдоль (параллельно) $V^-$.

            Пусть $\phi: U \cong V$, тогда $\phi(U^+) \le V$, но так как $s < p$, то проекция $\text{pr}(\phi(U^+))$ имеет ненулевое ядро.

            $\Ker(\text{pr}) = V^-$, значит, $\Ker\left(\text{pr}\big|_{\phi(U^+)}\right) \le V^-$. Значит, нашёлся вектор из $U^+$, который при изометрии попал в $V^-$.
            Но так не бывает при изометрии --- значит, ядро на самом деле нулевое, противоречие.
        }
    }
    \theorem[Закон инерции Сильвестра]{\label{silvester_inertion_law}
    Любое квадратичное пространство над $\R$ изометрично ровно одному пространству вида
        \[\langle\underbrace{1, \dots, 1}_{r^+}, \underbrace{-1, \dots, -1}_{r^-}, \underbrace{0, \dots, 0}_{n - r^+ - r^-}\rangle \bydef \underbrace{\angles{1} \boxplus \angles{1}}_{r^+}\boxplus\underbrace{\angles{-1} \boxplus \angles{-1}}_{r^-}\boxplus\underbrace{\angles{0} \boxplus \angles{0}}_{n - r^+ - r^-}\]
    }
    Заметим, что пространства $\angles{1,\dots,1 }$ и $\angles{-1, \dots, -1}$ --- евклидово и антиевклидово соответственно, значит, они анизотропны.
    \newlection{2 мая 2023 г.}
    Положим $m = \min(r^+, r^-)$.
    Получается, всякое квадратичное пространство над $\R$ изометрично ровно одному пространству вида
    \[\underbrace{H \boxplus \dots \boxplus H}_{m} \boxplus \arr{c}{\angles{1, \dots, 1} \\\text{или}\\ \angles{-1, \dots, -1}} \boxplus \Rad(V)\]


    \section{Теория (Диксона --- ) Витта}
    \theorem[Витт о разложении]{
        Пусть $V$ --- пространство над $K$, ${\chr(K) \ne 2}$. Тогда
        \[V = \underbrace{H \boxplus \dots \boxplus H}_{s} \boxplus V_0 \boxplus \Rad(V)\]
        причём $s$ определено однозначно, $V_0$ --- анизотропно и определено однозначно с точностью до изометрии.
        \provehere{См.(\cref{Witt_about_decomposition})}
    }
    \theorem[Витт о продолжении]{
        Пусть $V$ --- пространство над $K$, ${\chr(K) \ne 2}$, пусть $U, W \le V$.
        Если $\psi: U \cong W$ --- изометрия, то $\exists \phi \in \Isom(V): \phi\big|_U = \psi$.
        Дополнительно потребуем невырожденности либо $U$ (тогда и $W$), либо $V$.
        \provehere{См. (\cref{Witt_about_continuation_1, Witt_about_continuation_2}).}
    }
    Если всё невырождено, то эта теорема эквивалентна следующей:
    \theorem[Витт о сокращении]{
        Пусть $U, W, V$ --- невырожденные пространства над $K$, ${\chr(K) \ne 2}$.
        Если $U \boxplus V \cong W \boxplus V$, то $U \cong W$.
        \provehere{
            Пусть $\phi: U \boxplus V \cong W \boxplus V$;\ согласно теореме Витта о продолжении можно считать, что $\phi$ оставляет $V$ на месте ($V \cong \phi(V)$).
            Тогда $U \cong W$, как ортогональные дополнения $V$ в одном и том же пространстве.
        }
    }

    \subsection{Ортогональные отражения}
    Пусть $V$ --- квадратичное пространство, ${\chr(K) \ne 2}$.
    Дополнительно предположим, что $B \ne 0$, выберем $v \in V: B(v, v) \ne 0$ (такой есть, так как ${\chr(K) \ne 2}$).

    \definition[Ортогональное отражение относительно $v$]{
        $w_v: V \map V,\quad {w_v(x) = x - 2\frac{B(x, v)}{B(v, v)}v}$.
    }
    Обозначим $L_v = \angles{v}^\perp$ --- \emph{зеркало отражения}.
    Так как $V = \angles{v} \boxplus L_v$ --- $v$ анизотропен --- то ортогональное отражение переводит $v \mapsto -v$, а каждая точка ортогональной гиперплоскости остаётся на месте.
    \lemma{\label{one-dimensional-case}
    Пусть $\chr(K)\ne 2$, $B(u, u) = B(v, v) \ne 0$. Тогда $\exists \phi \in \Isom(V): \phi(u) = v$.
    \provehere{
        $u + v, u - v \in \angles{u, v}$.
        Один из этих двух векторов анизотропен: \[B(u + v, u - v) = B(u, u) - B(v, v) = 0\] откуда \[0 \ne 4B(u, u) = B((u + v) + (u - v), (u + v) + (u - v)) = B(u + v, u + v) + B(u - v, u - v)\]
        Если $u - v$ анизотропен, то $w_{u - v}(u) = v$.
        Иначе $u + v$ анизотропен, тогда $w_{u + v}(u) = -v$, домножив преобразование на -1 получим необходимое.
        Можно написать выкладку, а можно посмотреть на картинку:
    % https://q.uiver.app/?q=WzAsNixbMiwyXSxbMiwwLCJcXGJ1bGxldCJdLFs0LDIsIlxcYnVsbGV0Il0sWzQsMCwiXFxidWxsZXQiXSxbMCw0LCJcXGJ1bGxldCJdLFswLDBdLFswLDEsInUiXSxbMCwyLCJ2IiwyXSxbNCwzLCJcXHRleHR70LfQtdGA0LrQsNC70L4g0L7RgtGA0LDQttC10L3QuNGPfSIsMSx7ImxhYmVsX3Bvc2l0aW9uIjozMCwib2Zmc2V0IjoxLCJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFswLDIsIndfe3Utdn0odSkiXSxbMiwxLCIiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkb3R0ZWQifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFswLDUsInUgLSB2Il1d
    % https://q.uiver.app/?q=WzAsOSxbMiwzXSxbMiwxLCJcXGJ1bGxldCJdLFswLDBdLFs0LDZdLFs0LDMsIlxcYnVsbGV0Il0sWzQsMSwiXFxidWxsZXQiXSxbMCwzLCJcXGJ1bGxldCJdLFswLDFdLFs0LDVdLFswLDEsInUiXSxbMCw0LCJ2IiwyXSxbMCw1LCJ1ICsgdiIsMl0sWzAsNiwid197dSt2fSh1KSIsMV0sWzYsMSwiIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbOCw3LCJcXHRleHR70LfQtdGA0LrQsNC70L4g0L7RgtGA0LDQttC10L3QuNGPfSIsMSx7ImxhYmVsX3Bvc2l0aW9uIjozMCwib2Zmc2V0IjotMSwic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XV0=
        \[\arr{c c c}{\begin{tikzcd}[ampersand replacement=\&]
                          \bullet \&\& \bullet \&\& {} \\
                          \\
                          \&\& {} \&\& \bullet \\
                          \\
                          {}
                          \arrow["u", from=3-3, to=1-3]
                          \arrow["v"', from=3-3, to=3-5]
                          \arrow["{\text{зеркало отражения}}"{description, pos=0.3}, shift right=1, dashed, no head, from=5-1, to=1-5]
                          \arrow["{w_{u-v}(u)}", from=3-3, to=3-5]
                          \arrow[dotted, no head, from=3-5, to=1-3]
                          \arrow["{u - v}", from=3-3, to=1-1]
        \end{tikzcd} & \quad & \begin{tikzcd}[ampersand replacement=\&]
        {}
                                   \\
                                   {} \&\& \bullet \&\& \bullet \\
                                   \\
                                   \bullet \&\& {} \&\& \bullet \\
                                   \\
                                   \&\&\&\& {} \\
                                   \&\&\&\& {}
                                   \arrow["u", from=4-3, to=2-3]
                                   \arrow["v"', from=4-3, to=4-5]
                                   \arrow["{u + v}"', from=4-3, to=2-5]
                                   \arrow["{w_{u+v}(u)}"', from=4-3, to=4-1]
                                   \arrow[dotted, no head, from=4-1, to=2-3]
                                   \arrow["{\text{зеркало отражения}}"{description, pos=0.3}, shift left=1, dashed, no head, from=6-5, to=2-1]
        \end{tikzcd}
        }\qedhere\]
    }
    }
    \precaution{
        Если $B(u, u) = B(v, v) = 0$, то необязательно $\exists \phi \in \Isom(V): \phi(u) = v$.
        Это верно только если пространство невырождено.
    }
    \counterexample{
        Пусть $u \in V \sm \Rad(V), v \in \Rad(V)$. $v$ ортогонален всему, $u$ --- не всему, нет изометрии, переводящей один в другой.
    }
    \lemma{
        Если $V$ невырождено, то для любых ненулевых изотропных векторов $u, v \in V: \exists \phi \in \Isom(V): \phi(u) = v$.
    }

    \subsection{Доказательство теоремы Витта о продолжении для невырожденных подпространств}
    \theorem{\label{Witt_about_continuation_1}
    Если $U, W \le V, \psi: U \cong W$, причём $U, W$ невырождены ($B$ симметрическое, ${\chr(K) \ne 2}$). Тогда $\exists \phi: V \cong V: \phi\big|_U = \psi$.
    \provehere{
        Индукция по $\dim(U) = \dim(W)$.

        \underline{База:} (\cref{one-dimensional-case}).

        \underline{Переход:} Согласно~(\cref{anisotropic_vector}), в $U$ найдётся неизотропный вектор $u \in U$.
        Положим $v = \psi(u) \in W$.

        Выберем $\theta \in \Isom(V), \theta(u) = v$ --- такая есть согласно~(\cref{one-dimensional-case}).

        Заменим $W$ на $\theta^{-1}(W)$, а $\psi$ --- на $\theta^{-1}\psi$.
        Достаточно доказать теорему после замены, изначально искомое $\phi$ получится домножением полученного на $\theta$ слева.
        После замены $u = \psi(u)$.

        Применим трижды теорему об ортогональном разложении~(\cref{orthogonal_decomposition}):
        \gather{
            U = \angles{u} \boxplus \angles{u}^\perp_U\\
            W = \angles{u} \boxplus \angles{u}^\perp_W\\
            V = \angles{u} \boxplus \angles{u}^\perp_V
        }
        Понятно, что $\angles{u}^\perp_U, \angles{u}^\perp_W \le \angles{u}^\perp_V$.

        Ограничение $\psi\big|_{\angles{u}^\perp_U}: \angles{u}_U^\perp \map \angles{u}_W^\perp$ --- изометрия.
        По индукционному предположению $\exists \eta \in \Isom\left(\angles{u}^\perp_V\right)$, такая, что $\eta\big|_{\angles{u}^\perp_U} = \psi\big|_{\angles{u}^\perp_U}$.

        Тогда $\phi = \id_{\angles{u}} \oplus \, \eta$ подойдёт.
    }
    }

    \subsection{Доказательство теоремы Витта о продолжении для невырожденного пространства}

    \theorem{\label{Witt_about_continuation_2}
    Пусть $U, W \le V, \psi: U \cong W$, причём $V$ невырождено ($B$ симметрическое, ${\chr(K) \ne 2}$). Тогда $\exists \phi: V \cong V: \phi\big|_U = \psi$.
    \provehere{
        Сначала докажем следующее: \up
        \indent{
            \theorem{
                Пусть $V$ невырождено, $U \le V$, $U = U_0 \boxplus \Rad(U)$ ($U_0$ невырождено). Тогда $\exists \text{ невырожденное } \overline{U}: U \le \overline{U} \le V$, такое, что
                \[\overline{U} = U_0 \boxplus \underbrace{H \boxplus \dots \boxplus H}_{d(U) \coloneqq \dim(\Rad(U))}\]
                \provehere{
                    Индукция по $d(U)$ --- \emph{дефекту} $U$.

                    Пусть $e_1, \dots, e_s$ --- базис $\Rad(U)$. Из невырожденности $V$ следует $\dim(U) + \dim(U^\perp) = \dim(V)$.

                    Назовём $W = U_0 \boxplus \angles{e_1, \dots, e_{s - 1}} \le U$. $\dim(W) = \dim(U) - 1, \qquad \dim(W^\perp) = \dim(U^\perp) + 1$.

                    Значит, $\exists v \in W^\perp \sm U^\perp$. Тогда $B(e_s, v) \ne 0$. Согласно ~(\cref{extraction_of_hyperbolic_surface}) (подпространство $\angles{e_{s}, v}$ невырождено, так как $B(e_s, v) \ne 0$, но $e_s$ изотропен) найдётся $e_{-s} \in \angles{e_s, v}: B(e_{-s}, e_{-s}) = 0, B(e_s, e_{-s}) = 1$.

                    Получили равенство $U \oplus \angles{e_{-s}} = W \boxplus H$, дальше действуем по индукции.
                }
            }
        }
        Согласно доказанной теореме найдутся $\overline{U}, \overline{W}$:
        \gather{
            U \le \overline{U} \le V \qquad \dim\left(\overline{U}\right) = \dim(U) + d(U) \\
            W \le \overline{W} \le V \qquad \dim\left(\overline{W}\right) = \dim(W) + d(W)
        }
        Пространства изоморфны, значит, их дефекты равны, то есть $\dim\left(\overline{U}\right) = \dim\left(\overline{W}\right)$.
        С другой стороны,
        \[U = U_0 + \Rad(U) \qquad W = W_0 + \Rad(W)\]
        Заметим, что ограничение $\psi$ --- тоже изометрия: $\psi\big|_{U_0}: U_0 \cong W_0$.
        Достроим эту изометрию до $\overline{\psi}: \overline{U} \cong \overline{W}$ --- все гиперболические плоскости изометричны, понятно, что можно достроить так, чтобы $\overline{\psi}(U_0) = W_0$.
        Согласно предыдущей теореме~(\cref{Witt_about_continuation_1}) эту изометрию можно продолжить на всё $V$.
    }
    }
    \theorem[Витт о разложении]{\label{Witt_about_decomposition}
        $(V, B)$ --- пространство над $K$, ($B$ симметрическое, ${\chr(K) \ne 2}$). Тогда $V$ представимо в виде \[V_0 \boxplus \underbrace{H \boxplus \dots \boxplus H}_{s\text{ --- индекс Витта}} \boxplus \Rad(V)\]
        где $V_0$ анизотропно, причём класс изометрий $V_0$ и $s$ определены однозначно.
        \provehere{
            Индукция по $\dim V$. Для начала избавимся от радикала, включив его прямым слагаемым.

            Пока существуют ненулевые изотропные векторы, будем включать их в гиперболические гиперплоскости.
            В результате останутся только анизотропные векторы, образующие $V_0$.

            Единственность разложения следует из теоремы Витта о сокращении: все гиперболические плоскости изометричны, на них можно сокращать.
        }
    }
    Такое разложение пространства на анизотропную, гиперболическую, и вырожденную части называется \emph{разложением Витта}.
    Естественно выбирать ортогональный базис в анизотропной части, гиперплоскостной базис в гиперболической части (и любой --- в радикале, всё равно там $B \equiv 0$) --- это \emph{базис Витта}.

    Пусть $V = H_1 \boxplus \dots \boxplus H_s$.
    Выберем полученный гиперплоскостной базис $H_i = \angles{e_i, e_{-i}}$.

    Определим $U = \angles{e_1, \dots, e_s}, U' = \angles{e_{-1}, \dots, e_{-s}}$.
    Получим разложение $V = U \oplus U'$, причём $B_U \equiv 0$ и $B_{U'} \equiv 0$.
    \definition[Вполне изотропное пространство $U$]{Все векторы $U$ изотропны.}
    Если характеристика не 2, то во вполне изотропных пространствах $B_U \equiv 0$ (иначе~(\cref{anisotropic_vector})).

    \corollary{
        Если $V$ невырождено, то $V \cong V_0 \boxplus (U \oplus U')$, где $V_0$ анизотропно, $U, U'$ --- вполне изотропны.
    }
    \fact{
        $U, U'$ --- максимальные (и по размерности, и по включению) вполне изотропные подпространства в $V$.
        \provehere{
            Максимальность по включению очевидна --- никакой вектор не добавить.

            Согласно теореме Витта о сокращении, в невырожденном $V$ все максимальные по включению вполне изотропные подпространства изометричны.

            А именно, пусть $U, \tilde{U} \le V$ --- вполне изотропные подпространства, причём $\dim(U) < \dim(\tilde{U})$. Тогда $U$ изометрично некому подпространству в $\tilde{U}$. Изометрию можно продолжить на всё $V$, получается, $U$ содержится в б$\acute{\text{о}}$льшем вполне изотропном подпространстве. Противоречие.
        }
    }

    \newlection{3 мая 2023 г.}


    \section{Полуторалинейные скалярные произведения}
    Иноязычно полуторалинейные называют sesquilinear, полулинейные --- semilinear.

    \subsection{Полулинейные отображения, инволюции}
    Раньше было так: $R$ --- кольцо, $U, V$ --- два модуля над ним, $\phi: U \map V$ --- линейное отображение: \gather{\phi(u + v) = \phi(u) + \phi(v)\\ \phi(v \lambda) = \phi(v) \lambda}

    Пусть теперь $U$ --- $R$-модуль, $V$ --- $S$-модуль.
    Что естественно понимать под морфизмом $U \map V$?
    Первое свойство удобно сохранить: $\phi(u + v) = \phi(u) + \phi(v)$.
    Так как $V$ --- не $R$-модуль, то при вынесении скаляра из $R$ надо его преобразовать в скаляр из $S$.

    Зададим \textbf{унитальный} гомоморфизм колец $\psi: R \map S$.

    \definition[$\psi$-полулинейное отображение]{
        Такое аддитивное $\phi: U \map V$, что \[\forall u \in U, \lambda \in R: \phi(u \lambda) = \phi(u)\psi(\lambda)\]
    }
    Линейное отображение можно понимать, как полулинейное, где $R = S$.
    До сих пор $\psi$ было тождественным.
    \definition[Инволюция]{
        Антиавтоморфизм порядка 2. Часто обозначается чертой: \[\overline{\cdot}: R \map R, \lambda \mapsto \overline{\lambda}\]
    }
    \properties{
        \item $\overline{\lambda + \mu} = \overline{\lambda} + \overline{\mu}$ --- определение антиавтоморфизма.
        \item $\overline{\lambda \cdot \mu} = \overline{\mu}\cdot \overline{\lambda}$ --- определение антиавтоморфизма.
        \item $\overline{1} = 1$.
        \item $\overline{\overline{\lambda}} = \lambda$ --- порядок 2.
    }
    \examples{
        \item Комплексное сопряжение --- ещё и автоморфизм, так как кольцо коммутативно.
        \item Кватернионное сопряжение: $a + bi + cj + dk \mapsto a - bi - cj - dk$. \gather{w + \overline{w} = 2a \in \R \\w\overline{w} = a^2 + b^2 + c^2 + d^2 \in \R}
        \item Инволюция на $\Q\left(\sqrt{2}\right): a + b \sqrt{2} \mapsto a - b \sqrt{2}$.
        \item Инволюция на $\Ff_{q^2}$: \[\Frob: \Ff_{q^2} \map \Ff_{q^2}; \quad x \mapsto x^q\]
        \item Пусть $R$ --- коммутативное кольцо.
        Тогда $R = R^o$ и транспонирование --- инволюция: $M(n, R) \map M(n, R^o); \quad x \mapsto x^t$.
        \item Главная инволюция группового кольца $K[G] \map K[G]; \quad g \mapsto g^{-1}$.
    }
    Пусть $U, V$ --- модули над \textbf{коммутативным} кольцом $R$ с инволюцией.
    \definition[Полулинейное отображение $\phi: U \map V$ по отношению к инволюции]{
        Аддитивное $\phi$, такое, что $\phi(u \lambda) = \phi(u)\overline{\lambda}$.
    }
    В 1840-е годы Эрмит ввёл это для комплексных чисел, Гамильтон --- для кватернионов.

    \subsection{Полуторалинейные скалярные произведения}
    Никаких билинейных анизотропных скалярных произведений (кроме одномерных) над $\C$ нет: всегда уравнение $z^2 + w^2 = 0$ имеет решение.

    А анизотропность иногда бывает удобна.
    Поэтому над $\C$ билинейные скалярные произведения не позволяют построить такую же геометрию, как над $\R$.
    Эрмит предложил заменить сумму квадратов на сумму $z\overline{z} + w \overline{w}$, которая никогда не 0 (разве что $z = w = 0$).
    Для этого пришлось отказаться от линейности по одному из аргументов.

    \ok

    Пусть $K$ --- поле с инволюцией, $V$ --- векторное пространство над $K$.
    \definition[Полуторалинейная форма $B: V \times V \map K$]{
        $B$, линейное по одному аргументу, и полулинейное --- по второму:
        \gather{
            B(u + v, w) = B(u, w) + B(v, w) \\
            B(u, v + w) = B(u, v) + B(u, w) \\
            B(u\lambda, v\mu) = \overline{\lambda}\cdot B(u, v)\cdot\mu \text{ --- для правых модулей} \\
            B(\lambda  u, \mu v) = {\lambda}\cdot B(u, v)\cdot\overline{\mu} \text{ --- для левых модулей}
        }
    }
    \definition[Полуторалинейное скалярное произведение]{
        Полуторалинейная форма, в которой ортогональность симметрична: $B(u, v) = 0 \iff B(v, u) = 0$.
    }
    \definition[Эрмитова полуторалинейная форма]{
        Такая форма $B$, что $B(u, v) = \overline{B(v, u)}$.
        Также называется \emph{эрмитовски симметричной формой}.
    }
    \note{
        Казалось бы, можно ввести эрмитовски антисимметричную форму: $B(u, v) = -\overline{B(v, u)}$.
        Но смысла в этом нет: если $B$ эрмитовски симметрична, то $i \cdot B$ --- эрмитовски антисимметрична.
    }
    \intfact{
        Все полуторалинейные скалярные произведения с точностью до нормировки --- эрмитовски симметричны.
    }
    \definition[Унитарное пространство]{
        $(V, B)$, где $B$ --- полуторалинейное эрмитово скалярное произведение.
    }
    \definition[Унитарная группа]{
        Группа изометрий унитарного пространства: $\defset{\phi}{B(\phi u, \phi v) = B(u, v)}$.
    }
    \example[Классический пример]{
        $V = \C^n,\qquad  \overline{\cdot}: \C \map \C, z \mapsto \overline{z} \qquad B(u, v) = \overline{u_1}v_1 + \dots + \overline{u_n}v_n$.

        $B$ здесь положительно определено: \bullets{\item $B(u, u) \ge 0$ --- положительная полуопределённость. \item Равенство наступает при $u = 0$.}
        Пространство называют \emph{конечномерным гильбертовым} или \emph{классическим унитарным пространством}.
    }
    Для таких пространств можно заново переизложить теорию, описанную в данной главе.

    Так, матрица Грама $G(B)$ --- такая матрица, что $B(u, v) = \overline{u}^t G(B) v$.
    \theorem{
        Любое эрмитово скалярное произведение над $\C$ имеет вид \[B(u, v) = \overline{u_1}v_1 + \dots + \overline{u_{p}}v_{p} - \overline{u_{p+1}}v_{p+1} - \dots - \overline{u_{p+q}}v_{p+q}\]
        Это аналог теоремы Сильвестра: всякое скалярное произведение определяется тремя числами, $n, p, q$.
        \provehere[Набросок доказательства]{
            $B(u, u) = \overline{B(u, u)} \then B(u, u) \in \R$.
            Домножая вектор $u$ на $\lambda$ получаем $B(u\lambda, u\lambda) = \lambda\overline{\lambda}B(u, u)$, то есть можно заменить число на любое того же знака --- привести в $\{-1, 0, +1\}$.
        }
    }
    \precaution[Гильбертово пространство намного сложнее евклидова]{
        Гильбертово пространство включает в себя и симметрическое, и симплектическое произведения, причём они связаны.
        Об этом ниже.
    }

    \subsection{Вещественная и мнимая часть эрмитова скалярного произведения}
    Пусть $K = \C$, рассмотрим единственную непрерывную нетривиальную инволюцию $z \mapsto \overline{z}$.

    Пусть $V = \C^n$, $B: V \times V \map \C$ --- скоро будет полуторалинейным скалярным произведением

    Можно <<забыть про комплексную структуру>>: $V_{\R} \cong \R^{2n}$.

    Введём два новых отображения: $A(u, v) = \Re(B(u, v)); C(u, v) = \Im(B(u, v))$.
    Они скоро будут билинейными вещественными скалярными произведениями: $A, C: V_{\R} \times V_{\R} \map \R$.

    \theorem{
        Следующие условия эквивалентны:
        \numbers{
            \item $B$ --- эрмитово скалярное произведение (полулинейное по первому аргументу, линейное --- по второму).
            \item \numbers{
                \item[(a)] $A$ симметрическое, $C$ симплектическое.
                \item[(b)] $A(ui, vi) = A(u, v); \quad C(ui, vi) = C(u, v)$.
                \item[(c)] $A(ui, v) = C(u, v); \quad C(ui, v) = -A(u, v)$.

            }
        }
        \provetwhen{
            \bullets{
                \item[(a)] $B(u, v) = \overline{B(v, u)}$.
                \item[(b)] $B(ui, vi) = \overline{i}iB(u, v) = B(u, v)$.
                \item[(c)] $A(ui, v) + iC(ui, v) = B(ui, v) = \overline{i}B(u, v) = \overline{i}(A(u, v) + iC(u, v)) = C(u, v) - i A(u, v)$.
            }
        }{
            Из определения $B(u, v) = A(u, v) + iC(u, v)$ видно, что форма линейна по отношению к вещественным числам.
            Запишем \[\all{A(u, vi) = A(vi, u) = C(v, u) = -C(u, v) \\ C(u, vi) = -C(vi, u) = A(v, u) = A(u, v)}\]
            Теперь проверим линейность по второму аргументу, полулинейность по первому, эрмитовость:
            \gather{B(u, vi) = A(u, vi) + iC(u, vi) = -C(u, v) + iA(u, v) = i(A(u, v) + iC(u, v)) = iB(u, v) \\
            B(ui, v) = A(ui, v) + iC(ui, v) = C(u, v) - iA(u, v) = \overline{i}(A(u, v) + iC(u, v)) \\
            B(u, v) = \overline{B(v, u)}\qedhere
            }
        }
    }
%    Теория фон Неймана: чем замечательны матрицы над полем (телом)? Матрицы являются простой алгеброй, то есть такой, где ровно два идеала — {0} и сама алгебра.
%    Классическая теорема Артина --- Веддербарна говорит о том, что кольцо, удовлетворяющее условию обрыва убывающей цепочки --- обязательно имеет вид M(n, T).
%    Без условия на артиновость их тоже можно классифицировать, но труднее гораздо.
%    Фон Нейман в 30-е годы пытался классифицировать простые алгебры операторов бесконечномерных пространств.
%    Там возникает куча алгебр, где возникает в записи M(n, T) такое n, которое естественно истолковывать, как вещественное число.


    \chapter{Теория групп}
    \newlection{10 мая 2023 г.}
%    Действия групп
%    Конечные группы (теоремы Силова)
%    констуркции: коммутант, произведения...
%    Образующие соотношения: свободные группы


    \section{Действия групп}

    \subsection{Действия групп на множествах}
    Пусть $G$ --- группа, $X$ --- множество.
    \definition[$G$ действует на $X$ слева]{
        Задано отображение (\emph{левое действие}) \[\text{act}: {G \times X \map X} \qquad g, x \mapsto gx \text{ или }\ind{^g}x{} \text{ (или ещё как-то обозначается)}\]
        При действии группы должны быть выполнены аксиомы:
        \bullets{
            \item Внешней ассоциативности: $h(gx) = (hg)x$.
            \item Унитальности: $1_G \cdot x = x$.
        }
        Также говорят <<$X$ --- $G$-множество>>.
    }
    При правом действии $x(hg) = (xh)g$.

    \note{Для групп любое левое $G$-множество можно превратить в правое и наоборот: \[xg \leftrightsquigarrow g \cdot x = xg^{-1}\]}
    Чаще будем рассматривать левые действия --- действия группы аналогичны применениям функций, а функции мы применять привыкли слева.
    Например, левым действиям будут соответствовать гомоморфизмы, а не антигомоморфизмы.

    \note{Возникавшие у нас группы на самом деле возникали уже вместе с действиями.}
    \examples{
        \item Естественное действие $S_n \bydef \Bij\left(\underline{n}\right)$, где $\underline{n} \bydef \{1, \dots, n\}$.
        Значит, $S_n$ естественно действует на $\underline{n}$: \[S_n \times \underline{n} \map \underline{n} \qquad \pi, i \mapsto \pi(i)\]

        Вообще, для любого множества $X$ (необязательно конечного): $S_X$ действует на $X$.
        \lemma{
            Других действий нет.
            При фиксированных $G, X$ действиям ${G \curvearrowright X}$ биективно сопоставляются гомоморфизмы $\phi: G \map S_X\qquad g \mapsto (x \mapsto gx)$.
            Отображения $L_g: X \map X, x \mapsto gx$ называются \emph{левыми трансляциями} на $g$.

            \provehere{
                Определение очевидно корректно, проверим, что $\phi$ --- гомоморфизм.
                Аксиомами действия являются $L_{gh} = L_g L_h$ и $L_1 = \id_X$, откуда следует, что $(L_g)^{-1} = L_{g^{-1}}$.

                Обратно: гомоморфизму $\phi: G \map S_X$ сопоставим ему левое действие $G$ на $X$: $gx = \phi(g)(x)$.
            }
        }
        Как раз-таки правые действия соответствовали бы не гомоморфизмам, а антигомоморфизмам.
        \definition[Перестановочное представление]{
            Выше рассмотренный гомоморфизм $\phi: G \map S_X$.
        }
        \item Естественное действие $GL(n, R) \curvearrowright R^n$:
        \[GL(n, R) \times R^n \map R^n \qquad g, u \mapsto gu\]
        Левое действие --- векторное представление $GL(n, R)$ на $R^n$.

        Также есть правое действие $\ind{^n}R{} \curvearrowleft GL(n, R)$, которому можно сопоставить $GL(n, R) \times R^n \map R^n, g, u \mapsto g^{-t}u$ --- \emph{ковекторное представление}.

        \definition[Линейные действия]{
            Действия $G \times V \map V$, удовлетворяющие аксиомам $g(u + v) = gu + gv$ и $g(u\lambda) = (gu)\lambda$.
        }
        \lemma{При фиксированных $G, R^n$ линейным действиям $G \curvearrowright R^n$ биективно соответствует гомоморфизмы $\phi: G \map GL(n, R)$.}
        \definition[Линейное представление]{
            Вышеописанный гомоморфизм $G \map GL(n, R)$.
        }
        \item Действие группы $SL(2, \C) \times \overline{\C} \map \overline{\C}$, где $\overline{\C}$ --- одноточечная компактификация $\C$, сфера Римана, $\C \cup \{\infty\}$.

        $\smallvect{a & b \\ c & d}, z \mapsto \frac{az + b}{cz + d}$.
        Если знаменатель обнуляется, то (так как $ad - bc = 1$) числитель не обнуляется, по определению $z \mapsto \infty$.
        Если $z = \infty$, то $\smallvect{a&b\\c&d}z = \all{\frac{a}{b},&b \ne 0 \\ \infty,&b=0}$.
        Проверка того, что это действие, оставляется читателю в качестве упражнения.
    }

    \subsection{Действие группы на себе. Теорема Кэли}
    Давайте для группы $G$ считать, что множество $X = G$, посмотрим, что получится.
    \definition[Левое регулярное представление]{Действие $G$ на себе левыми сдвигами: $G \times G \map G\qquad g, x \mapsto gx$.
        \[L_g: G \map G, x \mapsto gx \text{ --- левая трансляция. Так как в группе есть сокращение, то }L_g \in S_G\]}
    \theorem[Кэли]{
        Отображение $G \map S_G, g \mapsto L_g$ задаёт вложение $G$ в $S_G$.
        \provebullets{
            \item $L_g \in S_G$.
            \item Это гомоморфизм.
            \item $L_h = L_g \then h = g$ --- проверим в любой точке, например, в 1: $h = L_h(1) = L_g(1) = g$.
        }
    }
    \corollary{
        $|G| = n \then G \le S_n$.
    }
    Это ни в коем случае не биекция, например, так как порядок $S_{|G|} = |G|!$, что бы это не значило для бесконечных групп.
    \ok
    \definition[Правое регулярное представление]{Действие $G$ на себе правыми сдвигами: $G \times G \map G\qquad g, x \mapsto x g^{-1}$.
        \[R_g: G \map G, x \mapsto xg^{-1} \text{ --- правая трансляция. Так как в группе есть сокращение, то }R_g \in S_G\]}
    \note{
        И правое представление, и левое представление --- левые действия.
        Мы рассматриваем левые действия, потому что они соответствуют гомоморфизмам, а не антигомоморфизмам.
    }
    \theorem[Кэли]{
        Отображение $G \map S_G, g \mapsto R_g$ задаёт вложение $G$ в $S_G$.
    }
    \note{
        Любая левая трансляция коммутирует с любой правой трансляцией: $L_h R_g (x) = h(xg^{-1}) = (hx)g^{-1} = R_g L_h (x)$.
        Таким образом, на $G$ действует даже не сама группа $G$, а \[G \times G \curvearrowright G\quad  (G \times G) \times G \map G\quad (h, g), x \mapsto hxg^{-1}\]
        Это, правда, уже необязательно вложение, например, в абелевой группе вообще $L_g = R_{g^{-1}}$.
    }

    В частности, совместив с диагонализацией $\text{diag}: G \map G \times G, g \mapsto (g, g)$ получим \emph{действие сопряжения}: $G \times G \map G, g, x \mapsto \ind{^g}x{} = gxg^{-1}$.

    Это отображение называется $I_g: G \map G, x \mapsto gxg^{-1} = \ind{^g}x{}$ --- внутренний автоморфизм $G$.
    Отображение $G \map S_g, g \mapsto I_g$ уже не является вложением, его ядро --- центр группы, $\Cent(G)$.

    \subsection{Действие группы на однородных пространствах. Обобщённая теорема Кэли}
    Зафиксируем подгруппу $H \le G$ --- в предыдущем разделе $H = \{1\}$.
    Ей соответствует $G/H =\defset{xH}{x \in G}$.
    \definition[Стандартное действие $G$ на $G/H$]{
        $L_g: G \times G/H \map G/H$, $g, xH \mapsto gxH$.
    }
    Аналогично $H \bs G \times G \map H \bs G, \qquad Hx, g \mapsto Hxg^{-1}$.

    Получили гомоморфизм $G \map S_{G/H}, g \mapsto L_g$, не обязательно являющийся вложением.
    Найдём ядро этого гомоморфизма.

    Ядро любого гомоморфизма, вообще-то --- нормальная подгруппа, а ещё ядро должно быть как-то связано с $H$.
    С $H$ связаны две нормальные подгруппы $G$: $H_G \le H \le H^G$ --- \emph{сердцевина} $H$ (наибольшая нормальная подгруппа $G$, содержащаяся в $H$) и нормальная подгруппа $G$, порождённая $H$ (наименьшая нормальная подгруппа $G$, содержащая $H$) соответственно.
    А именно, \[H_G = \bigcap\limits_{g \in G}H^g\qquad H^G = \angles{h^g| h \in H, g \in G}\]
    \theorem[Обобщённая теорема Кэли]{
        Ядро гомоморфизма $L: G \map S_{G/H}, g \mapsto L_g$ равно сердцевине --- $H_G$.
        \provehere{
            Мы знаем, что $L$ --- гомоморфизм, вычислим его ядро.
            \gather{g \in \Ker(L) \iff L_g = \id_{G/H} \iff \forall x \in G: L_g(xH) = xH \iff \forall x \in G: gxH = xH \iff \\
            \iff \forall x \in G: x^{-1}gx \in H \iff \forall x \in G: g^x \in H \iff \forall x \in G: g \in \ind{}H{^{x^{-1}}}{}
            }
            Отсюда действительно получается, что $g \in \Ker(L) \iff \forall x \in G: g \in H^x \iff x \in H_G$.
        }
        Это очень сильная теорема.
        \corollary{\label{corollary1}
            $|G : H| = n \then |G : H_G| \bigdivs n!$.
            \provehere{
                $G/H_G \hookrightarrow S_{G/H}$. Так как $|G/H| = n$, то $|S_{G/H}| = n!$.
            }
        }
    }
    \corollary[Теорема Пуанкаре]{
        Подгруппа конечного индекса содержит нормальную подгруппу конечного индекса, то есть $|G:H| < \infty \then |G:H_G| < \infty$.
    }
    \corollary{
        Если $p$ --- наименьшее простое, делящее порядок $G$ и $|G : H| = p$, то $H \normeq G$.
        \provehere{
            Согласно~(\cref{corollary1}): $|G:H_G| \bigdivs p!$; помимо этого, $|G:H_G| \bigdivs |G|$, откуда
            \[|G:H_G| \bigdivs \gcd(p!, |G|) = p \then H_G = H\qedhere\]
        }
    }
    \ok
    Пусть $X, Y$ --- два $G$-множества.
    Гомоморфизмом $G$-множеств $\phi: X \map Y$ называют отображение $\phi(gx) = g\phi(x)$.
    Должна быть коммутативна диаграмма
    % https://q.uiver.app/?q=WzAsNCxbMCwwLCJHIFxcdGltZXMgWCJdLFsxLDAsIlgiXSxbMSwxLCJZIl0sWzAsMSwiRyBcXHRpbWVzIFkiXSxbMCwzLCJcXGlkX0cgXFx0aW1lcyBcXHBoaSJdLFsxLDIsIlxccGhpIl0sWzAsMSwiXFx0ZXh0e2FjdH1fWCJdLFszLDIsIlxcdGV4dHthY3R9X1kiXV0=
    \[\begin{tikzcd}[ampersand replacement=\&]
    {G \times X}
          \& X \\
          {G \times Y} \& Y
          \arrow["{\id_G \times \phi}", from=1-1, to=2-1]
          \arrow["\phi", from=1-2, to=2-2]
          \arrow["{\text{act}_X}", from=1-1, to=1-2]
          \arrow["{\text{act}_Y}", from=2-1, to=2-2]
    \end{tikzcd}\]
    Если же на множествах действуют разные группы, $G \curvearrowright X, H \curvearrowright Y$, то надо ввести ещё \emph{эквивариантное отображение} $\psi: G \map H$, тогда коммутативной должна быть диаграмма
    % https://q.uiver.app/?q=WzAsNCxbMCwwLCJHIFxcdGltZXMgWCJdLFsxLDAsIlgiXSxbMSwxLCJZIl0sWzAsMSwiSCBcXHRpbWVzIFkiXSxbMCwzLCJcXHBzaSBcXHRpbWVzIFxccGhpIl0sWzEsMiwiXFxwaGkiXSxbMCwxLCJcXHRleHR7YWN0fV9YIl0sWzMsMiwiXFx0ZXh0e2FjdH1fWSJdXQ==
    \[\begin{tikzcd}[ampersand replacement=\&]
    {G \times X}
          \& X \\
          {H \times Y} \& Y
          \arrow["{\psi \times \phi}", from=1-1, to=2-1]
          \arrow["\phi", from=1-2, to=2-2]
          \arrow["{\text{act}_X}", from=1-1, to=1-2]
          \arrow["{\text{act}_Y}", from=2-1, to=2-2]
    \end{tikzcd}\quad \phi(gx) = \psi(g)\phi(x)\]

    \newlection{13 мая 2023 г.}
    Пусть $G \curvearrowright X$.
    Рассмотрим $x \in X$, с ним можно связать две вещи.
    \definition[Орбита $x$]{
        $Gx \bydef \defset{gx}{g \in G} \subset X$.
    }
    \definition[Стабилизатор $x$]{
        $G_x \bydef \defset{g \in G}{gx = x} \le G$.
        В зависимости от конкретной природы действия его также называют \emph{централизатор}, \emph{нормализатор}, \emph{подгруппа изотропии}.
    }
    \definition[$G$ действует на $X$ транзитивно]{
        $X$ состоит из одной орбиты: \[\exists x \in X: Gx = X \noteiff \forall x \in X: Gx = X \noteiff \forall x, y \in X: \exists g \in G: gx =y\] Ещё говорят \emph{$X$ является однородным $G$-множеством}.
    }
    \theorem{
        $Gx \cong G/G_x$ --- изоморфизм $G$-множеств.
        \provehere{
            Рассмотрим $y \in Gx \iff \exists g \in G: y = gx$. Так как $\forall h \in G_x: x = hx$, то $\forall h \in G_x: y = (gh)x$.

            Обратно: $y = g_1 x = g_2 x \then g_2^{-1}g_1 x = x \then g_2^{-1}g_1 \in G_x$, то есть $g_1 G_x = g_2 G_x$.

            Таким образом, $g_1 x = g_2 x \iff g_1 G_x = g_2 G_x$. Значит, можно сопоставить \[Gx \longleftrightarrow G/G_x \qquad gx \longleftrightarrow g G_x\]
            Теперь проверим, что это не просто изоморфизм множеств, а изоморфизм $G$-множеств: \[\forall f \in G: fy = f(gx) = (fg)x\qedhere\]
        }
    }
    Другими словами, теорема утверждает, что никаких других однородных $G$-множеств, кроме факторов по стабилизаторам, нет.
    \corollary{
        $|Gx| = |G: G_x|$.
    }
    \lemma{Две орбиты либо не пересекаются, либо совпадают.
    \provehere{
        $\exists h, g \in G: hx = gy \then y = g^{-1}hx \then y \in Gx \then Gy \subset Gx$. Аналогично $Gx \subset Gy$.
    }
    }
    \precaution{
        Пусть $S$ --- моноид, действующий на $X$. Тогда нужно различать орбиты и \emph{траектории}.
        $Sx = \defset{sx}{s \in S}$ --- траектория.

        Из того, что нашлись $h, g \in G: hx = gy$ совсем не следует, что траектории $x$ и $y$ совпадают --- преобразование необратимо.
        Чтобы получить орбиты, надо взять транзитивное замыкание траекторий:
    % https://q.uiver.app/?q=WzAsNixbMCwxLCJ4Il0sWzAsMCwiXFxidWxsZXQiXSxbMSwxLCJcXGJ1bGxldCJdLFsyLDAsIlxcYnVsbGV0Il0sWzIsMSwiXFxidWxsZXQiXSxbMywwLCJ5Il0sWzAsMSwiZ18xIl0sWzIsMV0sWzIsMywiIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn19fV0sWzQsM10sWzQsNSwiZ19uIl1d
        \[\begin{tikzcd}[ampersand replacement=\&]
              \bullet \&\& \bullet \& y \\
              x \& \bullet \& \bullet
              \arrow["{g_1}", from=2-1, to=1-1]
              \arrow[from=2-2, to=1-1]
              \arrow[dotted, from=2-2, to=1-3]
              \arrow[from=2-3, to=1-3]
              \arrow["{g_n}", from=2-3, to=1-4]
        \end{tikzcd}\quad\text{$x$ и $y$ здесь в одной орбите.}\]
    }
    Согласно аксиоме выбора существует система представителей --- \emph{трансверсаль} к действию $G$ на $X$.
    \theorem{
        $X = \bigsqcup\limits_{x \in Y}Gx$, где $Y$ --- трансверсаль.
    }
    Для конечного трансверсаля $X = X_1 \sqcup \dots \sqcup X_m$, где $X_i$ --- однородные $G$-множества.
    \examples{
        \item Подгруппа $H \le G$ может действовать на группе трансляциями: $H \curvearrowright G; h, g \mapsto hg$.
        В этом случае орбиты --- смежные классы $H \bs G$, стабилизатор любого элемента --- $\{1\}$.
        Можно выбрать трансверсаль $T, G = \bigsqcup\limits_{x \in T}xH$.

        Каждая орбита изоморфна $H \curvearrowright H$.
        \definition[$X$ --- главное однородное пространство для $G$]{
            $X \cong G$ как $G$-множество, то есть \[\forall x, y \in X: \exists! g: gx = y\]}
        Как только изоморфизм фиксируется: $1 \mapsto x$ для конкретного $x$, $X$ перестанет отличаться от $G$.

        Прослеживается аналогия с евклидовым пространством, в котором не выбрали начало координат.
        \item $G \curvearrowright G, g, x \mapsto \ind{^g}x{} = gxg^{-1}$.
        В данном частном случае орбиты --- \emph{классы сопряжённых}, стабилизатор --- \emph{централизатор}: $C_G(x) = \defset{g \in G}{\ind{^g}x{} = x}$.

        Согласно предыдущей теореме $\ind{}x{^G} \cong G/C_G(x)$.
        \item Группа $G$ может действовать на $2^G$. В данном частном случае стабилизаторы --- \emph{нормализаторы}: для $Y \subset X$: $N_G(Y) \bydef \defset{g \in G}{\ind{^g}Y{} = Y}$.
    }
    \note{Вычисление жордановой формы --- задача вычисления трансверсаля орбит группы $GL(n, R)$, на которой она сама ($GL(n, R)$) действует сопряжением.}


    \section{Классификация $G$-множеств}
    Как мы уже знаем, $\forall G$-множества $X$: $X = \bigsqcup\limits_i X_i$, где $X_i$ --- однородное $G$-множество.

    Всякое же однородное $G$-множество изоморфно $G/H$ для $H \le G$.

    Когда для двух подгрупп $F, H \le G: G/F \cong G/H$ --- изоморфизм $G$-множеств?

    Выберем произвольный $x \in G$. Пусть $X = Gx, y \in X$.
    Значит $X \cong G/G_x$, но так как $X = Gy$, то ещё и $X \cong G/G_y$.
    Рассмотрев $h \in G_y$ (используя, что $y = gx$ для некоего $g \in G$) получаем, что $g^{-1}hg \in G_x$.
    \lemma{$\forall g \in G: \left(y = gx \then g^{-1}G_y g = G_x\right)$, то есть стабилизаторы точек в одной орбите сопряжены.}
    \corollary{
        $F$ сопряжено с $H \then G/F \cong G/H$ --- изоморфизм $G$-множеств.
    }
    \theorem[Классификация однородных пространств]{
        Пусть $F, H \le G$. Тогда $\underset{\text{изоморфизм $G$-множеств}}{G/F \cong G/H} \iff F \sim H$ ($F$ и $H$ сопряжены).
        \provewthen{
            Доказано выше.
        }{
            Пусть $G/F \cong G/H$. Выберем $g \in G: F \mapsto gH$.
            Стабилизатор точки $F$ (при действии $G \curvearrowright G/F$) --- это $F$, стабилизатор точки $gH$ (при действии $G \curvearrowright G/H$)--- $gHg^{-1}$. Значит, $F \sim H$.
        }
    }
    Таким образом, чтобы описать все $G$-множества, надо описать все подгруппы с точностью до сопряжения.
    Это, правда, дикая задача.


    \section{Конечные группы}
    Будем рассматривать конечные группы, действующие на конечных множествах.

    \subsection{Центр $p$-группы, теоремы Коши}
    Обозначим $\Fix_G(X) = X^G \bydef \defset{x \in X}{\forall g \in G: gx = x}$.
    К сожалению, $X^G$ уже ранее было задействовано в другом смысле.
    Очень жаль\ldots

    Пусть $p \in \P$ --- простое.
    \lemma{
        Пусть $\forall H \le G: H \ne G \then |G : H| \divisibleby p$. При действии $G \curvearrowright X$: $\abs{X^G} \equiv |X| \pmod{p}$.
        \provehere{
            Посмотрим на орбиты. $X^G = \bigsqcup \tilde{X}_i$, где $\tilde{X}_i$ --- одноэлементные орбиты.
            Значит, $X = X^G \sqcup X_1 \dots \sqcup X_m$, где $X_i$ --- различные орбиты, такие, что $|X_i| > 1$. Так как $|G x_i| = |G : G_{x_i}|$, то $|G x_i| \divisibleby p$.
        }
    }
    \definition[$G$ --- $p$-группа]{$|G| = p^m$ для некоего $m \in \N_0$.}
    \theorem[Доказал Силов, но пока ещё не теорема Силова]{
        Если $G$ --- $p$-группа, то её центр нетривиален.
        \provehere{
            Рассмотрим $G \curvearrowright G$ --- действие сопряжением.
            Центр --- множество инвариантов (неподвижных точек) этого действия.
            Значит, $|\Cent(G)| \equiv |G| \pmod{p}$.
        }
    }
    \corollary[Нетте]{
        Группы порядка $p$ и $p^2$ абелевы.
        \provehere{
            Для $|G| = p$ её центр --- она сама.
            Предположим, что $|G| = p^2$, $|\Cent(G)| = p$. Тогда $|G/\Cent(G)| = p$, то есть $G/\Cent(G) \cong C_p$, откуда $G$ --- абелева (всякий элемент $G$ представим в виде $g^i h$, где $0 \le i < p, h \in \Cent(G)$. Легко видеть, что они коммутируют)
        }
    }
    \theorem[Коши]{
        Пусть $|G| \divisibleby p$. Тогда количество решений уравнения $x^p = 1$ делится на $p$.
        \provehere[Доказательство Маккея]{
            Положим $X = \defset{(x_1,\dots, x_p)}{x_i \in G; x_1 \proddots x_p = 1} \underset{\text{как множество}}\cong G^{p - 1}$. $|X| \divisibleby p$.

            Рассмотрим действие $C_p \curvearrowright X$ оператором $\text{RotateRight}: X \map X; \quad \text{RotateRight}(x_1, \dots,x_{p-1}, x_p) = (x_p, x_1, \dots, x_{p-1})$ --- это действие произвольной образующей $C_p$, остальные определяются однозначно.

            Неподвижные точки $X^{C_p}$ --- это в точности $\defset{(x, \dots, x)}{x^p = 1}$. Поэтому количество решений уравнения сравнимо с $|X|$ по модулю $p$.
        }
    }
    \intfact[Теорема Фробениуса]{
        Если $|G| \divisibleby n$, то количество решений уравнения $x^n = 1$ в $G$ делится на $n$.
    }
    \corollary{
        В частности, в группе порядка, делящегося на $p$, существует $x \ne 1: x^p = 1 \noteiff o(x) = p$.
    }
    \corollary{В $p$-группе нормализатор любой собственной подгруппы строго больше чем она.}
    \subsection{Теоремы Силова}
    Если $G$ --- абелева, то $G = \bigoplus\limits_{p \in \P, p \divs |G|}G_p$, где $G_p$ --- примарные компоненты.
    В неабелевых группах будет что-то отдалённо похожее.
    \definition[$G_p \le G$ --- силовская $p$-подгруппа]{\down
    \numbers{
        \item $G_p$ --- $p$-группа.
        \item $|G : G_p| \perp p$.
    }
    }
    \theorem[Силов, $E_p$ (existence)]{
        Пусть $G$ --- конечная группа.
        Для любого $p \in \P: \exists H \le G$ --- силовская $p$-подгруппа.
    }
    \theorem[Силов, $C_p$ (conjugancy)]{
        Для данного $p$ любые две силовские $p$-подгруппы сопряжены в $G$.
    }
    \theorem[Силов, $D_p$]{
        Если $H \le G$, $H = p^l$, то найдётся силовская $p$-подгруппа, содержащая $H$.
    }
    \theorem[Силов --- Фробениус, $F_p$ (Anzahlsatz)]{
        Для любого $l \in \N_0: p^l \divs |G| \then \abs{\defset{H \le G}{|H| = p^l}} \equiv 1 \pmod{p}$.
    }
    В частности, количество силовских $p$-подгрупп делится на $p$ с остатком 1.
    \example{
        Рассмотрим $GL(n, q) \bydef GL(n, \Ff_q)$, где $q = p^m$.
        \[|GL(n, q)| =  (q^n - 1)(q^n - q)\proddots (q^n - q^{n-1}) = q^{\nicefrac{n(n-1)}2}(q^n - 1)\proddots(q - 1)\]
        так как каждый столбец необходимо выбирать так, что он не лежит в линейной оболочке предыдущих.

        Рассмотрим подгруппу $U(n, q)$, состоящую из верхних унитреугольных матриц $\vect{1 & * & * \\ &1&*\\0&&1}$. $|U(n, q)| = q^{\nicefrac{n(n-1)}2}$.
        Значит, $U(n, q)$ --- силовская $p$-подгруппа в $GL(n, q)$.
    }

    \subsubsection{Первое доказательство Фробениуса теоремы Силова}
    \provehere[Доказательство $E_p$]{
        $G \underset{\text{теорема Кэли}}\hookrightarrow S_{|G|} \underset{\text{матрицы перестановки}}\hookrightarrow GL(|G|, p)$.
        Пусть $H = U(|G|, p)$ --- силовская $p$-подгруппа в $GL(|G|, p)$.

        Рассмотрим двойные смежные классы $G \bs GL(|G|, p) / H$.
        Пусть $\{x_1, \dots, x_m\}$ --- трансверсаль.
        Согласно формуле индекса Фробениуса \[|GL(|G|, p) : H| = |G : (G \cap x_1 H x_1^{-1})| + \dots + |G : (G \cap x_m H x_m^{-1})\]
        Так как левая часть взаимно проста с $p$, то $\exists x_i: |G : (G \cap x_i H x_i^{-1})| \perp p$.
        Таким образом, $G \cap x_i H x_i^{-1}$ --- силовская $p$-подгруппа в $G$.
    }
    \note{У Фробениуса вместо $GL(|G|, p)$ была симметрическая группа, в которой $p$-подгруппу построить весьма нетривиально.}
    \provehere[Доказательство $C_p$ и $D_p$]{
        Пусть $H, P \le G$ причём $|P| = |G|_p$, где $|G|_p$ --- $p$-часть числа, наибольшая степень $p$, делящая $|G|$.

        Докажем, что если $|H| = p^m$, то $\exists g \in G: \ind{}H{^g} \le P$.

        $H\bs G/P = H x_1 P \sqcup \dots \sqcup H x_s P$.
        \[p \perp |G : P| = |H : (H \cap x_1 P x_1^{-1})| + \dots + |H : (H \cap x_s P x_1^{-1})|\]
        Так как $H$ --- $p$-группа, то в правой части --- степени $p$.
        Значит, $\exists x_i: H = H \cap x_i P x_i^{-1} \then \ind{}H{^{x_i}} \le P$.
    }
    \provehere[Доказательство частного случая $F_p$ --- для $p^l = |G|_p$]{
        Рассмотрим множество силовских $p$-подгрупп $\Syl_p(G)$.
        Пусть $P \in \Syl_p(G)$, рассмотрим действие сопряжениями $P \curvearrowright \Syl_p(G)$.
        Если $Q$ --- неподвижная точка действия, то $P$ нормализует $Q$, то есть $PQ = QP$, откуда $PQ \le G$.

        Согласно формуле произведения $|PQ| \bigdivs |P| \cdot |Q|$.
        Значит, $PQ$ --- $p$-группа.
        Если $P \ne Q$, то $P \lneq PQ$, силовская $p$-подгруппа не максимальна, противоречие.

        Значит, у действия ровно одна неподвижная точка, откуда $|\Syl_p(G)| \equiv 1 \pmod{p}$.
    }

    \subsubsection{Формула классов, второе доказательство Фробениуса}
    \provehere[Доказательство $E_p$]{Пусть $|G| < \infty, p \bigdivs |G|$.
    Значит, $\exists x \in G: o(x) = p$.

    Рассмотрим действие сопряжением $G \curvearrowright G$, выберем трансверсаль $X$ к орбитам.
    \[X = \Cent(G)\cup \underset{\text{представители нецентральных классов}}{\{x_1, \dots, x_m\}}\]
    Формула классов: \[|G| = |\Cent(G)| + |G : C_{G}(x_1)| + \dots + |G : C_G(x_m)|\]

    Индукция по $|G|$.
    \bullets{
        \item Либо $|\Cent(G)| \divisibleby p$, тогда $\exists x \in \Cent(G): x^p = 1$, тогда $|G/\angles{x}| \le |G|$.
        В факторгруппе силовская $p$-подгруппа уже есть, $|Q| = p^{h - 1}$, где $p^h = |G|_p$. Прообраз $Q$ в $G$ --- группа $\pi^{-1}(Q)\angles{x}$, её порядок --- как нужно.
        \item Либо $|\Cent(G)| \notdivisibleby p$. Значит, из формулы классов выше $\exists x_i: C_G(x_i) \lneq G$, но $|G : C_G(x_i)| \perp p$.
        Тогда получается, что $|C_G(x_i)|_p = |G|_p$, найдём силовскую $p$-подгруппу по индукции.
    }}
    \example[Силовские $p$-подгруппы в $S_n$]{
        Силовская подгруппа в $S_p$ --- это $C_p$.
        Силовская подгруппа в $S_{p^2}$ порядка $|p^{p + 1}|$ --- это сплетение $C_p \wr C_p$ ---можно переставлять элементы в каждом столбце таблицы $p \times p$, а ещё --- переставлять сами столбцы.
    }
    \ok
    \definition[$H \le G$ --- холловская подгруппа]{
        $|H| \perp |G : H|$.
    }
    Пусть $\pi \subset \P$.
    \definition[$G$ --- $\pi$-группа]{
        $p \divs |G| \then p \in \pi$.
    }
    \definition[$H$ --- холловская $\pi$-подгруппа в $G$]{
        $H$ --- $\pi$-группа и $|G : H|$ взаимно прост со всеми $p \in \pi$.
    }
    Оказывается, $E_\pi, C_\pi, D_\pi, F_\pi$ --- ничего из этого неверно.

    Но можно добавить условие разрешимости $G$ (определение было в I семестре, есть цепочка подгрупп, фактор следующей по предыдущей абелев, последняя подгруппа тривиальна).
    В разрешимых группах $E_\pi, C_\pi, D_\pi, F_\pi$ выполнены.

    Более того, если для каждых двух простых существует холловская $\pi$-подгруппа, то сама группа разрешима??


    \section{Тождества с коммутаторами}
    Пусть $G$ --- произвольная группа.
    \definition[Левонормированный коммутатор]{
        $[x, y] = xyx^{-1}y^{-1}$
    }
    \definition[Коммутант]{$[G, G] = \angles{[x, y] | x, y \in G}$.}
    Из I семестра мы помним, что $[G, G] \normeq G$, $G/[G, G] = G^{\ab}$ --- абелева группа (абелианизация $G$), причём если $H \le G, G/H$ --- абелева, то $H \ge [G, G]$.

    \definition[Взаимный коммутант]{
        $[F, H] = \angles{[f, h] | f \in F, h \in H}$.
    }
    \proposal{$H \normeq G \iff [H, G] \le H$.}
    \numbers{
        \item \up \[[x, y]^{-1} = xyx^{-1}y^{-1} = yxy^{-1}x^{-1} = [y, x]\]
        \item \up \[[xy, z] = xyzy^{-1}\underbrace{}_{z^{-1}x^{-1}xz}x^{-1}z^{-1} = \ind{^x}{[y, z]}{} \cdot [x, z]\] соответствует дистрибутивности аддитивного коммутатора $[x, y] \bydef xy - yx$ по первому аргументу.
        \item \up \[[x, yz] = xy\underbrace{}_{x^{-1}y^{-1}yx}zx^{-1}z^{-1}y^{-1} = [x, y] \cdot \ind{^y}{[x, z]}{}\] соответствует дистрибутивности аддитивного коммутатора по второму аргументу.
        \item \definition[Тройной коммутатор]{
            $[x, y, z] = [[x, y], z] = xyx^{-1}y^{-1}zyxy^{-1}x^{-1}z^{-1}$.
        }
        \definition[Кратный коммутатор]{
            $[x_1, \dots, x_n] = [[x_1, \dots, x_{n - 1}], x_n]$.
        }
        \lemma[Холл --- Витт]{
            \[[x, y^{-1}, z^{-1}]^x \cdot [z, x^{-1}, y^{-1}]^z \cdot [y, z^{-1}, x^{-1}]^y = 1\]
            \provehere{
                <<Мы оставляем читателю в качестве упражнения расписать тройные коммутаторы>>
            }
        }
    }
    \definition{$[A, B, C] = [[A, B], C]$.}
    \lemma[О трёх подгруппах]{
        Пусть $A, B, C \le G; H \normeq G$. Если две из трёх
        \[[A, B, C]\quad [B, C, A] \quad [C, A, B]\]
        содержатся в $H$, то и третья --- тоже.
        \provehere{
            Тождество Холла --- Витта.
        }
    }
    \newlection{16 мая 2023 г.}


    \section{Прямое произведение двух подгрупп}
    Если $F, H$ --- произвольные группы, то определено внешнее прямое произведение --- группа, в которую они обе вкладываются.
    \definition[Внешнее прямое произведение]{
        $F, H \rightsquigarrow F \times H \bydef \defset{(f,h)}{f \in F, h \in H}$, где операции покомпонентны.
    }
    \[F \hookrightarrow F \times H \hookleftarrow H; \quad f \mapsto (f, 1) \quad (1, h) \mapsfrom h\]

    Пусть теперь $F, H \le G$.
    Когда $G \cong F \times H$? Нас даже интересует естественный изоморфизм, когда вложения $F, H \hookrightarrow F \times H$ тождественные.
    \theorem{
        $G$ является прямым произведением $F$ и $H$, если выполнены условия
        \numbers{
            \item $\angles{F, H} = G$.
            \item $F \cap H = \{1\}$.
            \item $F, H \normeq G$.
        }
        \provehere{
            Если $G$ --- прямое произведение $F, H$, то условия выполнены.
            Докажем в другую сторону.

            Из 1+3 вытекает $G = FH = HF$, то есть $\forall g \in G: \exists f, h, f', h': g = fh = h'f'$.

            Из 2+3 вытекает $[F, H] = \{1\}$. В самом деле,
            \[[f, h] = \underbrace{(fhf^{-1})}_{\in H}h^{-1} = f\underbrace{(hf^{-1}h)}_{\in F}\]

            Далее получаем, что все элементы $F, H$ коммутируют, поэтому $\forall g \in G: \exists !f \in F, h \in H: g = fh = hf$.
            Единственность легко показать от противного.

            Сопоставим всякому $g \in G: (f, h) \in F, H: fh = g$ (такая пара единственна). \[g_1 = f_1 h_1, g_2 = f_2 h_2 \then g_1 g_2 = (f_1 h_1) (f_2 h_2) = (f_1 f_2) (h_1 h_2)\qedhere\]
        }
    }   Теперь займёмся ослаблением условий теоремы.
    \definition[$G$ --- центральное произведение $F, H \le G$]{\down
    \numbers{
        \item $\angles{F, H} = G$.
        \item $[F, H] = \{1\}$.
        \item $F, H \normeq G$.
    }
    }
    Доказательство остаётся прежним, по-прежнему каждому элементу $g \in G$ можно (но уже необязательно единственным образом) сопоставить $(f, h) \in F \times H: fh = g$.
    Центральные элементы $z \in F \cap H$ можно перебрасывать: $g = (fz)(z^{-1}h)$ (они центральные, так как они коммутируют и с $F$, и с $H$).

    \definition[$G$ --- почти прямое произведение $F, H \le G$]{\down
    \numbers{
        \item $\angles{F, H} = G$.
        \item $\abs{F \cap H} < \infty$.
        \item $F, H \normeq G$.
    }
    }
    \definition[$G$ --- подпрямое произведение $F, H \le G$]{\down
    \numbers{
        \item $G \le F \times H$.
        \item Проекции $G$ на $F$ и $H$ сюръективны.
    }
    }

    \subsection{Прямое произведение нескольких подгрупп}
    Пусть $H_1, \dots, H_m \le G$.
    Когда $G \cong H_1 \times \dots \times H_m$ естественным образом, то есть естественные включения --- вложения?

    \theorem{
        $G$ является прямым произведением $H_1, \dots, H_m$, если выполнены условия
        \numbers{
            \item $\angles{H_1, \dots, H_m} = G$.
            \item $H_i \cap \angles{H_1, \dots, \widehat{H_i}, \dots, H_m} = \{1\} \iff H_i \cap \left(H_1\proddots \widehat{H_i}\proddots H_m\right) = \{1\}$.
            \item $H_1, \dots, H_m \normeq G$.
        }
        \provehere{
            Оставлено читателю в качестве упражнения. Легче всего по индукции.
        }
    }

    \subsection{Прямое произведение многих подгрупп}
    Что такое $\prod\limits_{i \in I}G_i$, где $G_i \le G, I$ --- произвольное множество индексов?

    Элементы произведения --- $\defset{(g_i)_{i \in I}}{g_i \in G_i}$, либо $\defset{(g_i)_{i \in I}}{g_i \in G_i\text{, почти все $g_i = 1$}}$.
    В алгебре <<почти все>> --- все кроме конечного числа.

    Обе конструкции --- частный случай \emph{ограниченного прямого произведения}:
    \[\prod\limits_{i \in I}\underset{H_i}{}G_i = \defset{(g_i)_{i \in I}}{g_i \in G_i\text{, почти все $g_i \in H_i$}}\]


    \section{Полупрямое произведение}
    Пусть $F, H \le G$.
    \definition[$G$ --- полупрямое произведение нормальной подгруппы $H$ и дополнительной подгруппы $F$]{\down
        \numbers{
            \item $\angles{F, H} = G$.
            \item $\abs{F \cap H} = \{1\}$.
            \item $H \normeq G$.
        }
        Обозначают $G = F \rightthreetimes H = H \leftthreetimes F$.
    }
    По-прежнему $G =FH = HF$, но они уже необязательно коммутируют: известно лишь, что $[F, H] \le H$.

    \[\forall g \in G: \exists! f,f' \in F, h,h' \in H: g = fh = h'f'\]
    Так как коммутант лежит в $H$, то на самом деле $f = f'$: $h'f' = (fhf^{-1})f$.

    Как эти элементы перемножать? \[g_1 = h_1 f_1, g_2 = h_2 f_2 \then g_1 g_2 = (h_1 f_1)(h_2\underbrace{}_{f_1^{-1}f_1} f_2) = (h_1 f_1 h_2 f_1^{-1})(f_1 f_2) = (h_1 \cdot\ind{^{f_1}}{{h_2}}{})(f_1 f_2)\]
    \note{При перемножении $f_1 h_1 \cdot f_2 h_2$ появляется сопряжение не элементом $f_1$, а элементом $f_1^{-1}$, что потом породит не гомоморфизмы, а антигомоморфизмы.}
    \ok
    Пусть нам даны
    \numbers{
        \item Группы $F$ и $H$.
        \item Гомоморфизм $\theta: F \map \Aut(H)$.
    }
    \definition[Полупрямое произведение, отвечающее <<действию автоморфизмами>> $\theta$]{
        $H \leftthreetimes_{\theta} F \bydef \defset{(h, f)}{h \in H, f \in F}$ с действием, определённым так:
        \[(h_1, f_1) \cdot (h_2, f_2) = (h_1 \theta(f_1)(h_2), f_1 f_2)\]
    }
    \theorem{
        $H \leftthreetimes_{\theta} F$ --- группа, изоморфная полупрямому произведению своих подгрупп $H^1 = \defset{(h, 1)}{h \in H}$ и $F^1 = \defset{(1, f)}{f \in F}$.
    }
    Пусть $H \normeq G$ --- нормальная подгруппа.
    $G$ является полупрямым произведением $H$ и какой-то дополняющей подгруппы, если факторгруппа $G/H$ вкладывается в $G$, и композиция этого вложения и факторпроекции $G/H \to G \to G/H$ тождественна.
    Иными словами, существует \emph{сечение} у факторпроекции $G \to G/H$.

    Более общим примером, примером \emph{расширения} (одной группы, изоморфной нормальной подгруппе, при помощи другой, изоморфной факторгруппе) является случай, когда ретракция не обязательно существует.
    Например, рассмотрим подгруппу десятков в группе остатков $\Z/100\Z$: есть вложение $\Z/10\Z \to \Z/100\Z$, где $\overline{a} \in \Z/10\Z$ соответствует $\overline{10a} \in \Z/100\Z$.
    Образ --- нормальная подгруппа (в абелевой группе все подгруппы нормальны), но $\Z/100\Z$ не разваливается в полупрямое произведение $\Z/10\Z$ и факторгруппы, так как нет сечения.
    Расширения изображают в виде \emph{короткой точной последовательности} следующего вида:
    \[1 \map \Z/10\Z \map \Z/100\Z \map \Z/10\Z \map 1\]
    Здесь левая стрелка соответствует вложению нормальной подгруппы $\Z/10\Z$ в группу $\Z/100\Z$ (и $1$ слева говорит, что это действительно вложение, то есть что гомоморфизм инъективен), правая --- факторизации по образу (и правая $1$ говорит, что это действительно факторпроекция, то есть гомоморфизм сюръективен).
    \note{Для нетривиального действия полупрямое произведение двух абелевых групп вполне может стать неабелевым.}

    \examples[Полупрямое произведение]{
        \item Рассмотрим следующие подгруппы в $GL(n, K)$:
        \[\underset{\text{Борелевские --- (верхне) треугольные матрицы}}{B(n, K) = \vect{* && * \\ &\ddots\\0&&*}} \qquad \underset{\text{диагональные матрицы}}{D(n, K) = \vect{*&&0\\&\ddots&\\0&&*}}\qquad\underset{\text{(верхние) унитреугольные матрицы}}{U(n, K) = \vect{1 && * \\ &\ddots&\\0 && 1}}\]
        \encircle{B = D \rightthreetimes U}
        \item $N(n, K)$ --- группа мономиальных матриц, то есть $N = \defset{x \in GL(n, K)}{\all{\forall i: \exists ! j: x_{i,j} \ne 0 \\ \forall j: \exists ! i: x_{i,j} \ne 0}}$.
%
        $W_n$ --- матрицы перестановки, то есть $W_n = \defset{x \in N(n, K)}{\forall i, j: x_{i,j} = 0 \lor x_{i,j} = 1}$. $W_n \cong S_n$.
        \encircle{N = W_n \rightthreetimes D}
        \item Группа аффинных матриц $Aff(n, K) = \defset{\vect{g & u \\ 0 & 1}}{g \in GL(n, K), u \in K^n}$.
        Группа отвечает аффинным движениям, то есть композиции вращения относительно начала координат (за это отвечает $GL(n, K)$) и параллельного переноса (за это отвечает $K^n$).
        \gather{\vect{g_1 & u_1 \\ 0 & 1} \cdot \vect{g_2 & u_2 \\ 0 & 1} = \vect{g_1 g_2 & g_1 u_2 + u_1 \\ 0 & 1}\\}\encircle{GL(n, K) \rightthreetimes K^n = Aff(n, K)}
    }


    \section{Группы порядка $pq$}
    Пусть $p < q$ --- различные простые числа, $G$ --- группа ($|G| = pq$).
    Как она выглядит?

    В ней совершенно точно есть силовские подгруппы $P, Q \le G, |P| = p, |Q| = q$.
    Число силовских $q$-подгрупп сравнимо с 1 $\pmod{q}$, но так как это число --- делитель $pq$ (число классов сопряжённости к $Q$), то оно равно 1.
    Значит, в $G$ ровно одна силовская $q$-подгруппа, она инвариантна относительно сопряжения, то есть $Q \normeq G \then G = P \rightthreetimes Q$.

    Как известно, группа простого порядка $p$ единственна с точностью до изоморфизма --- все порядки элементов делят размер группы, таким образом, есть элемент порядка $p$, то есть группа циклическая.

    $G$ определяется действием $P \curvearrowright Q$ автоморфизмами $\theta: P \map \Aut(Q)$.
    Автоморфизмы $C_q$ отправляют произвольную образующую в произвольную, они изоморфны $C_{q-1}$.

    Очевидно, есть тривиальный $\theta: P \map \id$.
    Он соответствует абелевой группе $C_p \times C_q$.

    Заметим, что нетривиальный гомоморфизм $\theta$ существует, если $p \divs q - 1$.

    Зафиксируем результат:
    \theorem{
        Неабелевые группы порядка $pq$, где $p < q, p,q \in \P$ существуют только если $p \divs q - 1$.
    }
    \examples{
        \item Все группы порядка $15$ абелевые.
        \item Есть неабелевая группа (группа Фробениуса) порядка $21$.
    }
    Вообще, верен более общий факт:
    \intfact[Теорема Диксона]{
        $\gcd(n, \phi(n)) = 1 \iff \exists ! |G| = n$ (и эта группа абелева).
    }
    \newlection{17 мая 2023 г.}


    \section{Крохотный кусок комбинаторной теории групп}

    \subsection{Свободные группы}
    Пусть $X$ --- множество.
    \definition[Свободная группа $F_X$ со свободным множеством образующих $X$]{
        Группа вместе с вложением $X \hookrightarrow F_X$, такая, что $\forall$ группы $G, \forall \phi: X \map G$:
        $\exists! \psi: F_X \map G$ --- гомоморфизм групп, делающий следующую диаграмму коммутативной.
        % https://q.uiver.app/?q=WzAsMyxbMCwwLCJYIl0sWzIsMCwiRl9YIl0sWzEsMSwiRyJdLFswLDIsIlxccGhpIl0sWzEsMiwiXFxwc2kiLDIseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XSxbMCwxLCJcXGV0YSIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV1d
        \[\begin{tikzcd}[ampersand replacement=\&]
              X \&\& {F_X} \\
              \& G
              \arrow["\phi", from=1-1, to=2-2]
              \arrow["\psi"', dashed, from=1-3, to=2-2]
              \arrow["\eta", hook, from=1-1, to=1-3]
        \end{tikzcd}\]
    }
    Обычно $X$ конечно, мы будем рассматривать конечнопорождённые свободные группы.
    В таком случае если $|X| = n$, то пишут $F_n$ вместо $F_X$.
    \note{
        Если бы в определении были абелевы группы, то это были бы в точности свободные модули над $\Z$.
    }
    \note{
        Если свободная группа существует, то она единственна, причём с точностью до единственного изоморфизма.

        В самом деле, если есть две свободные группы $F_X$ и $\tilde{F_X}$ со вложениями $\eta: X \hookrightarrow F_X, \tilde{\eta}: X \hookrightarrow \tilde{F_X}$, то существуют и единственны гомоморфизмы групп $\psi: F_X \map \tilde{F_X}$, $\tilde{\psi}: \tilde{F_X} \map F_X$, такие, что \[\forall x \in X: \psi(\eta(x)) = \tilde{\eta}(x) \qquad \tilde{\psi}(\tilde{\eta}(x)) = \eta(x)\]
        Таким образом, видно (например, из конструкции свободной группы, которая приведена ниже), что $\psi$ и $\tilde{\psi}$ взаимно обратные отображения, то есть $\psi: F_X \map \tilde{F_X}$ --- изоморфизм.
        Он единственный, так как единственный гомоморфизм групп $\psi: F_X \map \tilde{F_X}$.
    }
    \definition[Свободный моноид $W_X$ со свободным множеством образующих $X$]{
        Моноид вместе с вложением $X \hookrightarrow W_X$, такой, что $\forall$ моноида $S, \forall \phi: X \map S$:
        $\exists! \psi: W_X \map G$ --- гомоморфизм моноидов, делающий следующую диаграмму коммутативной.
        \[\begin{tikzcd}[ampersand replacement=\&]
              X \&\& {W_X} \\
              \& S
              \arrow["\phi", from=1-1, to=2-2]
              \arrow["\psi"', dashed, from=1-3, to=2-2]
              \arrow["\eta", hook, from=1-1, to=1-3]
        \end{tikzcd}\]
    }
    \lemma{
        Свободный моноид уж точно существует.
        \provehere{
            Моноид с множеством образующих $X$ --- это просто набор слов.
            Так, для $X = \{a, b\}$: $W_X \bydef \{\wedge, a, b, aa, ab, ba, bb, aba, \ldots\}$.

            Операцией в моноиде является конкатенация: $(x_1 \dots x_n) * (y_1 \dots y_m) = x_1 \dots x_n y_1 \dots y_m$.
            Эта операция ассоциативна, но некоммутативна.

            Таким образом, $(W_X, *, \wedge)$ --- свободный моноид (слова равны, если они физически равны;\ для отображения $\phi: X \map S$ гомоморфизмом $\psi: W_n \map X$ является тот, который отправляет слово $x_1 \dots x_n \in W_X$ в $\phi(x_1)\proddots\phi(x_n) \in S$).
        }
    }
    \theorem{
        Для любого множества образующих $X$ существует свободная группа.
        \provehere{
            Удвоим алфавит: выберем множество $X': |X'| = |X|$ вместе с биекцией $X \leftrightarrow X'; x \leftrightarrow x'$ и построим свободный моноид $W_{X \sqcup X'}$.
            Введём на $W_{X \sqcup X'}$ отношение эквивалентности $\sim$, являющееся транзитивным замыканием отношения предэквивалентности \[\forall u, v \in W_{X \sqcup X'}, x \in X: u xx' v \sim uv \sim u x'x v\]

            Определим $F_X \bydef (W_{X \sqcup X'})/\sim$ с наследованной от моноида операцией.
            Очевидно, она определена корректно: $w_1 \sim w_1'; w_2 \sim w_2' \then w_1 w_2 \sim w_1'w_2'$.
            Более того, она осталась ассоциативной, а класс эквивалентности пустого слова $[\wedge]$ --- нейтральный элемент.
            Операция взятия обратного в группе работает так: $(x_1 \dots x_n)^{-1} = x_n' \dots x_1'$.

            Определим $\psi: W_{X \sqcup X'} \map G$ аналогично: $\psi(x_1 \dots x_n) = \phi(x_1)\proddots \phi(x_n)$ (правда для этого придётся доопределить $\phi$ на $X'$: $\phi(x_i') \coloneqq \phi(x_i)^{-1}$).

            Так как отношение эквивалентности лежит в ядре (множество элементов, эквивалентных тривиальному слову лежит в $\Ker(\psi)$), то $\psi$ пропускается через фактор:
        % https://q.uiver.app/?q=WzAsNCxbMCwxLCJYIl0sWzEsMiwiRyJdLFsyLDAsIldfe1ggXFxzcWN1cCBYJ30iXSxbMSwxLCJGX1giXSxbMCwxLCJcXHBoaSIsMl0sWzIsMywiXFxzaW0iLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkb3R0ZWQifX19XSxbMywxLCIiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkb3R0ZWQifX19XSxbMCwyLCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFswLDNdLFsyLDEsIlxccHNpIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV1d
            \[\begin{tikzcd}[ampersand replacement=\&]
                  \&\& {W_{X \sqcup X'}} \\
                  X \& {F_X} \\
                  \& G
                  \arrow["\phi"', from=2-1, to=3-2]
                  \arrow["\sim"{description}, dotted, from=1-3, to=2-2]
                  \arrow[dotted, from=2-2, to=3-2]
                  \arrow[hook, from=2-1, to=1-3]
                  \arrow[from=2-1, to=2-2]
                  \arrow["\psi", dashed, from=1-3, to=3-2]
            \end{tikzcd}\]
            Пропущенный через фактор $\psi$ и есть искомый гомоморфизм групп --- он сохраняет произведение, единицу и обратные.
            Более того, из построения видно, что это --- единственный способ его построить, поэтому гомоморфизм групп действительно единственный.
        }
    }
    \definition[Редуцированное (приведённое) слово $w \in W_{X \sqcup X'}$]{
        Слово, в котором нет фрагментов вида $xx'$ или $x'x$.
    }
    \theorem{
        В каждом классе эквивалентности слов есть единственное редуцированное.
        \provehere{
            Пусть есть два редуцированных слова $w_1 \sim w_2$.
            Они эквивалентны, так как есть цепочка отношений предэквивалентностей $w_1 = u_1 \sim \dots \sim u_n = w_2$.
        % https://q.uiver.app/?q=WzAsNyxbMCwyLCJ3XzEiXSxbMSwxLCJcXGJ1bGxldCJdLFszLDEsIlxcYnVsbGV0Il0sWzQsMCwiXFxidWxsZXQgXFx0ZXh0eyDQv9C40Lp9Il0sWzUsMSwiXFxidWxsZXQiXSxbNywxLCJcXGJ1bGxldCJdLFs4LDIsIndfMiJdLFswLDFdLFsxLDIsIiIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRvdHRlZCJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzIsMywiXFx0ZXh0e9Cy0YDQuNGB0L7QstGL0LLQsNC90LjQtSB9IHh4JyIsMSx7ImxhYmVsX3Bvc2l0aW9uIjozMCwiY3VydmUiOi0yfV0sWzMsNCwiXFx0ZXh0e9Cy0YvRh9GR0YDQutC40LLQsNC90LjQtSB9eHgnIiwxLHsibGFiZWxfcG9zaXRpb24iOjcwLCJjdXJ2ZSI6LTJ9XSxbNCw1LCIiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkb3R0ZWQifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFs1LDZdXQ==
            \[\begin{tikzcd}[ampersand replacement=\&]
                  \&\&\&\& {\bullet \text{ пик}} \\
                  \& \bullet \&\& \bullet \&\& \bullet \&\& \bullet \\
                  {w_1} \&\&\&\&\&\&\&\& {w_2}
                  \arrow[from=3-1, to=2-2]
                  \arrow[dotted, no head, from=2-2, to=2-4]
                  \arrow["{\text{врисовывание } xx'}"{description, pos=0.3}, curve={height=-12pt}, from=2-4, to=1-5]
                  \arrow["{\text{вычёркивание }xx'}"{description, pos=0.7}, curve={height=-12pt}, from=1-5, to=2-6]
                  \arrow[dotted, no head, from=2-6, to=2-8]
                  \arrow[from=2-8, to=3-9]
            \end{tikzcd}\]
            Выберем среди всех таких цепочек цепочку с минимальной длиной максимального слова, а среди этих --- с минимальным количеством слов максимальной длины.

            Так как слова редуцированные, то в цепочке отношений предэквивалентности первый шаг был вверх --- в удлинение слова, а последний --- вниз.
            Значит, где-то был пик. Надо рассмотреть три варианта:
            \numbers{
                \item Врисовали и вычеркнули одну и ту же пару --- эти два шага можно взаимоуничтожить.
                \item Врисовали и вычеркнули соседнюю пару букв --- лишь один символ задействован в обоих операциях. Эти два шага тоже можно взаимоуничтожить.
                \item Врисовали и вычеркнули различную пару букв. Эти два шага можно поменять местами.
            }
            Во всех случаях получили новую цепочку, у которой либо длина максимального слова меньше, либо та же, но слов такой длины меньше.
            Противоречие --- мы выбрали уже минимальную.
            Значит, пика нет, слова просто равны: $w_1 = w_2$.

            Существование редуцированного слова очевидно, так как можно взять самое короткое в классе --- его не укоротить.
        }
    }
    Обозначим $\overline{w}$ --- приведённое слово в классе $[w]$.
    \corollary{
        В качестве $F_X$ можно выбрать не фактормоноид, а множество редуцированных слов.
        Тогда вместо конкатенации $*$ надо ввести операцию на группе $w_1, w_2 \mapsto [w_1 * w_2]$.

        Из единственности редуцированного слова можно проверить, что новая операция тоже ассоциативна: $\overline{\overline{u} * \overline{v}} = \overline{u * v}$
    }
    Основная свободная группа, которая нам встретится в топологии --- фундаментальная группа букета окружностей (или плоскости с выколотыми точками), котёнок с катушкой.

    Ещё свободную группу можно мыслить так:
% https://q.uiver.app/?q=WzAsMjMsWzMsMywiXFx3ZWRnZSJdLFs1LDMsIngiXSxbNSwyLCJ4eSJdLFs1LDQsInh5XnstMX0iXSxbMyw2LCJ5XnstMX15XnstMX0iXSxbNiwyXSxbNSwxXSxbMywxLCJ5Il0sWzMsNSwieV57LTF9Il0sWzEsMywieF57LTF9Il0sWzYsMywieHgiXSxbNCw1LCJ5XnstMX14Il0sWzIsNSwieV57LTF9eF57LTF9Il0sWzEsNCwieF57LTF9eV57LTF9Il0sWzEsMiwieF57LTF9eSJdLFswLDMsInheey0xfXheey0xfSJdLFsyLDEsInl4XnstMX0iXSxbNCwxLCJ5eCJdLFszLDAsInl5Il0sWzYsNF0sWzUsNV0sWzQsNF0sWzQsMl0sWzIsNSwiIiwyLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn19fV0sWzIsNiwiIiwyLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn19fV0sWzAsOF0sWzAsOV0sWzAsMV0sWzEsMl0sWzEsM10sWzEsMTBdLFs4LDExXSxbOCwxMl0sWzksMTNdLFs5LDE0XSxbOSwxNV0sWzAsN10sWzcsMTZdLFs3LDE3XSxbOCw0XSxbNywxOF0sWzMsMTksIiIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRvdHRlZCJ9fX1dLFszLDIwLCIiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkb3R0ZWQifX19XSxbMywyMSwiIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn19fV0sWzIsMjIsIiIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRvdHRlZCJ9fX1dXQ==
    \[\begin{tikzcd}[ampersand replacement=\&]
          \&\&\& yy \\
          \&\& {yx^{-1}} \& y \& yx \& {} \\
          \& {x^{-1}y} \&\&\& {} \& xy \& {} \\
          {x^{-1}x^{-1}} \& {x^{-1}} \&\& \wedge \&\& x \& xx \\
          \& {x^{-1}y^{-1}} \&\&\& {} \& {xy^{-1}} \& {} \\
          \&\& {y^{-1}x^{-1}} \& {y^{-1}} \& {y^{-1}x} \& {} \\
          \&\&\& {y^{-1}y^{-1}}
          \arrow[dotted, from=3-6, to=3-7]
          \arrow[dotted, from=3-6, to=2-6]
          \arrow[from=4-4, to=6-4]
          \arrow[from=4-4, to=4-2]
          \arrow[from=4-4, to=4-6]
          \arrow[from=4-6, to=3-6]
          \arrow[from=4-6, to=5-6]
          \arrow[from=4-6, to=4-7]
          \arrow[from=6-4, to=6-5]
          \arrow[from=6-4, to=6-3]
          \arrow[from=4-2, to=5-2]
          \arrow[from=4-2, to=3-2]
          \arrow[from=4-2, to=4-1]
          \arrow[from=4-4, to=2-4]
          \arrow[from=2-4, to=2-3]
          \arrow[from=2-4, to=2-5]
          \arrow[from=6-4, to=7-4]
          \arrow[from=2-4, to=1-4]
          \arrow[dotted, from=5-6, to=5-7]
          \arrow[dotted, from=5-6, to=6-6]
          \arrow[dotted, from=5-6, to=5-5]
          \arrow[dotted, from=3-6, to=3-5]
    \end{tikzcd}\]
    Эту картинку надо рисовать не на евклидовой плоскости, а на гиперболической, тогда все стрелки будут одинакового размера и всё поместится.

    Если же отождествить $xy$ и $yx$, так как на ровной картинке они попадают в одну точку, то это будет уже абелева группа.

    \subsection{Задание группы образующими соотношениями}
    Пусть $G = \angles{g_1, \dots, g_n}$, $X = \{x_1, \dots, x_m\}$.

    По определению свободной группы существует и единственный гомоморфизм $\psi: F_X \map G, x_i \mapsto g_i$.
    Значит, $G$ является факторгруппой свободной группы.
    \[1 \map R \map F_X \map G \map 1\]
    $R$ --- первая буква слова relations, соотношения, $g_i$ --- generators, образующие.

    Значит, $G \cong F_X/R$, как же описать $R$? Проблема в том, что кроме тривиальных случаев $R$ бесконечно велико.

    Хочется взять образующие для $R$, но оказывается, что в общем случае даже их бесконечно много.
    Однако $R$ --- ядро гомоморфизма, то есть нормальная подгруппа в $F_X$.
    Значит, можно взять её образующие, как образующие нормальной подгруппы.

    Если $\psi(w) = 1_G$, то $\psi(u w u^{-1}) = \psi(u)\psi(w)\psi(u)^{-1} = 1_G$, то есть соотношения выписываются с точностью до сопряжения.
    Любая такая система образующих --- система определяющих соотношений (defining relations).

    \definition[Группа с образующими $g_1, \dots, g_n$ и определяющими соотношениями $w_1, \dots, w_m$]{
        $G \cong \angles{g_1, \dots, g_n | w_1, \dots, w_m}$
    }
    Сама такая запись группы --- presentation, копредставление или задание образующими соотношениями.

    \examples{
        \item Свободная абелева группа $\Z^n \cong \angles{x_1, \dots, x_n | x_i x_j = x_j x_i} \cong \angles{x_1, \dots, x_n | [x_i, x_j]}$.
        Часто удобно писать соотношения в виде $w_1 = w_2$, это по определению то же самое, что и соотношение $w_1 w_2^{-1}$.
        \item $C_n = \angles{g|g^n} = \angles{g|g^n = 1}$ --- возможно, вторая запись нагляднее.
        \item $D_n = \angles{x, y}{x^2 = y^2 = (xy)^n = 1}$.
        \item $Q_8 = \angles{x, y | x^4 = y^4 = 1, x^2 = y^2, xy = yx^3}$. Здесь есть ровно восемь слов: $1, x, y, x^2 = y^2, xy = yx^3, \dots$
        \item $S_n = \langle s_1, \dots, s_{n-1}|(s_i^2 = 1) \land (\forall i, j: |i - j| > 2 \then [s_i, s_j] = 1) \land \underbrace{s_i s_{i + 1}s_i = s_{i + 1}s_i s_{i + 1}}_{(s_i s_{i+1})^3=1}\rangle$, где $s_i = ([i] [i + 1])$ --- фундаментальная транспозиция, они же кокстеровские образующие.
        Соотношение $xyx = yxy$ носит название braid relation, отношение в группе кос (косы имеются в виду те, которые девушки заплетают).
    % https://q.uiver.app/?q=WzAsMTIsWzEsMCwiXFxidWxsZXQiXSxbMCwxLCJcXGJ1bGxldCJdLFswLDAsIlxcYnVsbGV0Il0sWzEsMSwiXFxidWxsZXQiXSxbMCwyLCJcXGJ1bGxldCJdLFsxLDMsIlxcYnVsbGV0Il0sWzIsMiwiXFxidWxsZXQiXSxbMiwzLCJcXGJ1bGxldCJdLFsyLDAsIlxcYnVsbGV0Il0sWzIsMSwiXFxidWxsZXQiXSxbMSwyLCJcXGJ1bGxldCJdLFswLDMsIlxcYnVsbGV0Il0sWzAsMV0sWzIsMywiXFxjZG90IiwxXSxbMSw0XSxbNCw1LCJcXGNkb3QiLDFdLFszLDYsIlxcY2RvdCIsMV0sWzYsN10sWzgsOV0sWzksMTBdLFsxMCwxMV1d
    % https://q.uiver.app/?q=WzAsMTIsWzAsMCwiXFxidWxsZXQiXSxbMCwxLCJcXGJ1bGxldCJdLFsxLDIsIlxcYnVsbGV0Il0sWzIsMywiXFxidWxsZXQiXSxbMSwwLCJcXGJ1bGxldCJdLFsyLDEsIlxcYnVsbGV0Il0sWzIsMiwiXFxidWxsZXQiXSxbMSwzLCJcXGJ1bGxldCJdLFsyLDAsIlxcYnVsbGV0Il0sWzEsMSwiXFxidWxsZXQiXSxbMCwyLCJcXGJ1bGxldCJdLFswLDMsIlxcYnVsbGV0Il0sWzAsMV0sWzEsMiwiXFxjZG90IiwxXSxbMiwzLCJcXGNkb3QiLDFdLFs0LDUsIlxcY2RvdCIsMV0sWzUsNl0sWzYsN10sWzgsOV0sWzksMTBdLFsxMCwxMV1d
        \[\begin{tikzcd}[ampersand replacement=\&]
              \bullet \& \bullet \& \bullet \\
              \bullet \& \bullet \& \bullet \\
              \bullet \& \bullet \& \bullet \\
              \bullet \& \bullet \& \bullet
              \arrow["\cdot"{description}, from=1-1, to=2-2]
              \arrow[from=1-2, to=2-1]
              \arrow[from=2-1, to=3-1]
              \arrow["\cdot"{description}, from=3-1, to=4-2]
              \arrow["\cdot"{description}, from=2-2, to=3-3]
              \arrow[from=3-3, to=4-3]
              \arrow[from=1-3, to=2-3]
              \arrow[from=2-3, to=3-2]
              \arrow[from=3-2, to=4-1]
        \end{tikzcd}\qquad \begin{tikzcd}[ampersand replacement=\&]
                               \bullet \& \bullet \& \bullet \\
                               \bullet \& \bullet \& \bullet \\
                               \bullet \& \bullet \& \bullet \\
                               \bullet \& \bullet \& \bullet
                               \arrow[from=1-1, to=2-1]
                               \arrow["\cdot"{description}, from=2-1, to=3-2]
                               \arrow["\cdot"{description}, from=3-2, to=4-3]
                               \arrow["\cdot"{description}, from=1-2, to=2-3]
                               \arrow[from=2-3, to=3-3]
                               \arrow[from=3-3, to=4-2]
                               \arrow[from=1-3, to=2-2]
                               \arrow[from=2-2, to=3-1]
                               \arrow[from=3-1, to=4-1]
        \end{tikzcd}\]
        Эти косы гомотопически изоморфны.

        Если в копредставлении $S_n$ забыть про отношение $s_i^2 = 1$, то получим группу кос \[B_n = \langle s_1, \dots, s_{n-1}|(\forall i, j: |i - j| > 2 \then [s_i, s_j] = 1) \land s_i s_{i + 1}s_i = s_{i + 1}s_i s_{i + 1}\rangle\]
    }
    \fact{
        Группа с большим множеством соотношений --- факторгруппа группы с меньшим числом соотношений:
        \[\angles{X | R} \map \angles{X | R \cup S} \map 1\]
        \provehere{Теорема фон Дика.}
    }
    \corollary{
        $B_n \map S_n \map 1$: симметрическая группа --- факторгруппа группы кос.
    }
    \examples{
        \item $PSL(2, \Z) = \left[\arr{c c}{a & b \\ c & d}\right] = \pm \vect{a & b \\c  & d}$ --- фактор $SL(2, \Z)$ по центру.
        $x = \left[\arr{c c}{0 & 1 \\ -1 & 0}\right],\quad y = \left[\arr{c c}{1 & 1 \\ -1 & 0}\right]$.
        $PSL(2, \Z) = \angles{x, y|x^2 = y^3 = 1}$.
        Что здесь произошло? Определяющие соотношения бьются на соотношения по разным образующим, это называют свободным произведением:
        \[\angles{X \sqcup Y|R \sqcup S} = \angles{X | R} \star \angles{Y | S}\]
        где $R$ --- соотношения только на $X$, $S$ --- соотношения только на $Y$.

        Получается, $PSL(2, \Z) \cong C_2 \star C_3$ --- свободное произведение двух очень маленьких групп --- бесконечно.
        \item Для $SL(2, \Z)$ фактора по центру нет. $SL(2, \Z) = C_4 \star_{C_2} C_6$ --- уже не свободное произведение, а какое-то хитрое.
    }

\end{document}

